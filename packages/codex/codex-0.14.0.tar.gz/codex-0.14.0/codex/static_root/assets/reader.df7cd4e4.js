import{_ as X,S as Z,a as D,b as L,c as I,e as F,d as J,g as k,f as w,V as Q}from"./button.826034f7.js";import{O as ee,T as te,_ as P,a as S,b as $,U as se,W as oe,X as ae,Y as re,d as p,s as ne,Z as ie,$ as ce,a0 as le,a1 as ue,a2 as de,a3 as _e}from"./submit-footer.c04b032d.js";import{m as E,h as pe,T as ge,f as _,a2 as a,b as i,a3 as d,Z as he,u as A,r as c,q as me,n as r,g as f,d as O,R as fe,s as ve,a4 as be,_ as ke}from"./main.a2e8bc5d.js";import{_ as n,C as we,B as Pe}from"./index.d39bd993.js";import{S as h,p as Se,R as $e}from"./index.ae74d38c.js";import{V as l,b as Ce,c as ye}from"./VInput.07452e5b.js";import{B as G}from"./VItemGroup.dd1c9636.js";import{f as xe,c as g}from"./confirm-footer.6aa6f3b6.js";import{_ as Te}from"./VCheckbox.9e93441b.js";import{_ as N,a as W,P as V}from"./metadata-dialog.25a74cab.js";import{_ as q,a as K}from"./VWindowItem.68eabffe.js";import"./change-password-dialog.1449c286.js";import"./VSubheader.69248c75.js";import"./VSimpleTable.bad02e04.js";import"./datetime.5fb8de45.js";const Re=E(G,l),C=Re.extend({name:"v-radio-group",provide(){return{radioGroup:this}},props:{column:{type:Boolean,default:!0},height:{type:[Number,String],default:"auto"},name:String,row:Boolean,value:null},computed:{classes(){return{...l.options.computed.classes.call(this),"v-input--selection-controls v-input--radio-group":!0,"v-input--radio-group--column":this.column&&!this.row,"v-input--radio-group--row":this.row}}},methods:{genDefaultSlot(){return this.$createElement("div",{staticClass:"v-input--radio-group__input",attrs:{id:this.id,role:"radiogroup","aria-labelledby":this.computedId}},l.options.methods.genDefaultSlot.call(this))},genInputSlot(){const t=l.options.methods.genInputSlot.call(this);return delete t.data.on.click,t},genLabel(){const t=l.options.methods.genLabel.call(this);return t?(t.data.attrs.id=this.computedId,delete t.data.attrs.for,t.tag="legend",t):null},onClick:G.options.methods.onClick},render(t){const e=l.options.render.call(this,t);return this._b(e.data,"div",this.attrs$),e}});const Be=E(Pe,we,$e,xe("radioGroup"),ge),m=Be.extend().extend({name:"v-radio",inheritAttrs:!1,props:{disabled:Boolean,id:String,label:String,name:String,offIcon:{type:String,default:"$radioOff"},onIcon:{type:String,default:"$radioOn"},readonly:Boolean,value:{default:null}},data:()=>({isFocused:!1}),computed:{classes(){return{"v-radio--is-disabled":this.isDisabled,"v-radio--is-focused":this.isFocused,...this.themeClasses,...this.groupClasses}},computedColor(){if(!this.isDisabled)return h.options.computed.computedColor.call(this)},computedIcon(){return this.isActive?this.onIcon:this.offIcon},computedId(){return l.options.computed.computedId.call(this)},hasLabel:l.options.computed.hasLabel,hasState(){return(this.radioGroup||{}).hasState},isDisabled(){return this.disabled||!!this.radioGroup&&this.radioGroup.isDisabled},isReadonly(){return this.readonly||!!this.radioGroup&&this.radioGroup.isReadonly},computedName(){return this.name||!this.radioGroup?this.name:this.radioGroup.name||`radio-${this.radioGroup._uid}`},rippleState(){return h.options.computed.rippleState.call(this)},validationState(){return(this.radioGroup||{}).validationState||this.computedColor}},methods:{genInput(t){return h.options.methods.genInput.call(this,"radio",t)},genLabel(){return this.hasLabel?this.$createElement(Ce,{on:{click:Se},attrs:{for:this.computedId},props:{color:this.validationState,focused:this.hasState}},pe(this,"label")||this.label):null},genRadio(){const{title:t,...e}=this.attrs$;return this.$createElement("div",{staticClass:"v-input--selection-controls__input"},[this.$createElement(n,this.setTextColor(this.validationState,{props:{dense:this.radioGroup&&this.radioGroup.dense}}),this.computedIcon),this.genInput({name:this.computedName,value:this.value,...e}),this.genRipple(this.setTextColor(this.rippleState))])},onFocus(t){this.isFocused=!0,this.$emit("focus",t)},onBlur(t){this.isFocused=!1,this.$emit("blur",t)},onChange(){this.isDisabled||this.isReadonly||this.isActive||this.toggle()},onKeydown:()=>{}},render(t){const e={staticClass:"v-radio",class:this.classes,on:ye({click:this.onChange},this.listeners$),attrs:{title:this.attrs$.title}};return t("div",e,[this.genRadio(),this.genLabel()])}}),De={name:"DownloadPanel",data(){return{mdiDownload:ee,mdiFileImage:te}},computed:{..._(a,["activeTitle"]),...i(A,{timestamp:t=>t.timestamp,pageSrc:function(t){return d(this.$route.params,t.timestamp)},downloadURL:function(t){return he(this.$route.params.pk,t.timestamp)}}),fileName:function(){return this.activeTitle+".cbz"},pageName:function(){const t=this.$route.params.page;return`${this.activeTitle} - page ${t}.jpg`}},methods:{...c(me,["downloadIOSPWAFix"]),downloadPage(){this.downloadIOSPWAFix(this.pageSrc,this.pageName)},downloadBook(){this.downloadIOSPWAFix(this.downloadURL,this.fileName)}}};var Le=function(){var e=this,s=e._self._c;return s(X,[s(P,{attrs:{ripple:""},on:{click:e.downloadPage}},[s(S,[s($,[s(n,[e._v(e._s(e.mdiFileImage))]),e._v(" Download Page "+e._s(e.$route.params.page)+" ")],1)],1)],1),s(P,{attrs:{ripple:""},on:{click:e.downloadBook}},[s(S,[s($,[s(n,[e._v(e._s(e.mdiDownload))]),e._v(" Download Book ")],1)],1)],1)],1)},Ie=[],Fe=r(De,Le,Ie,!1,null,null,null,null);const M=Fe.exports;const Ee=["fitTo","twoPages"],Ae={name:"ReaderSettingsPanel",data(){return{isGlobalScope:!1}},computed:{...i(a,{fitToChoices(t){const e=[];for(const s of t.choices.fitTo)s.value&&e.push(s);return e},selectedSettings:function(t){return this.isGlobalScope||!t.activeBook?t.readerSettings:t.activeBook.settings},isClearSettingsButtonDisabled:function(t){if(this.isGlobalScope||!t.activeBook)return!0;for(const e of Ee){const s=t.activeBook.settings[e];if(!t.choices.nullValues.has(s))return!1}return!0}})},mounted(){document.addEventListener("keyup",this._keyListener)},unmounted:function(){document.removeEventListener("keyup",this._keyListener)},methods:{...c(a,["clearSettingsLocal","setSettingsGlobal","setSettingsLocal"]),settingsDialogChanged:function(t){this.isGlobalScope?this.setSettingsGlobal(this.$route.params,t):this.setSettingsLocal(this.$route.params,t)},_keyListener:function(t){t.stopPropagation();let e;switch(t.key){case"w":e={fitTo:"WIDTH"};break;case"h":e={fitTo:"HEIGHT"};break;case"s":e={fitTo:"SCREEN"};break;case"o":e={fitTo:"ORIG"};break;case"2":e={twoPages:!this.selectedSettings.twoPages};break}e&&this.setSettingsLocal(this.$route.params,e)}}};var Oe=function(){var e=this,s=e._self._c;return s("div",{attrs:{id:"readerSettings"}},[s("h3",[e._v("Reader Settings")]),s(C,{attrs:{label:"Scope"},model:{value:e.isGlobalScope,callback:function(o){e.isGlobalScope=o},expression:"isGlobalScope"}},[s(m,{attrs:{label:"Only this comic",value:!1}}),s(m,{attrs:{label:"Default for all comics",value:!0}})],1),s(C,{staticClass:"displayRadioGroup",attrs:{label:"Display",value:e.selectedSettings.fitTo},on:{change:function(o){return e.settingsDialogChanged({fitTo:o})}}},e._l(e.fitToChoices,function(o){return s(m,{key:o.value,attrs:{label:o.text,value:o.value}})}),1),s(Te,{staticClass:"displayTwoPages",attrs:{label:"Two pages","input-value":e.selectedSettings.twoPages,indeterminate:e.selectedSettings.twoPages===null||e.selectedSettings.twoPages===void 0,ripple:""},on:{change:function(o){return e.settingsDialogChanged({twoPages:o===!0})}}}),s(g,{class:{invisible:e.isGlobalScope},attrs:{id:"clearSettingsButton",disabled:e.isClearSettingsButtonDisabled,title:"Use the default settings for all comics for this comic"},on:{click:function(o){return e.clearSettingsLocal(e.$route.params)}}},[e._v(" Clear Comic Settings ")])],1)},Ge=[],Ne=r(Ae,Oe,Ge,!1,null,"8b6aba18",null,null);const U=Ne.exports;const We={data(){return{mdiMenuLeft:se,mdiMenuRight:oe,mdiKeyboardSpace:ae,mdiAppleKeyboardShift:re}},methods:{isMobile:function(){return typeof window.orientation<"u"||navigator.userAgent.includes("IEMobile")}}};var Ve=function(){var e=this,s=e._self._c;return e.isMobile()?e._e():s("div",{attrs:{id:"readerKeyboardShortcutsDialog"}},[s("h3",[e._v("Keyboard Shortcuts")]),s("table",{staticClass:"highlight-table",attrs:{id:"readerKeyboardShortcutsTable"}},[s("tbody",[s("tr",[s("td",[s(n,{staticClass:"keyIcon"},[e._v(" "+e._s(e.mdiMenuLeft)+" ")]),e._v(", j, "),s("div",[s(n,{staticClass:"keyIcon",attrs:{dense:""}},[e._v(" "+e._s(e.mdiAppleKeyboardShift)+" ")]),s(n,{staticClass:"keyIcon",attrs:{dense:""}},[e._v(" "+e._s(e.mdiKeyboardSpace)+" ")])],1)],1),s("td",[e._v("Previous page")])]),s("tr",[s("td",[s(n,{staticClass:"keyIcon"},[e._v(" "+e._s(e.mdiMenuRight)+" ")]),e._v(", k, "),s(n,{staticClass:"keyIcon",attrs:{dense:""}},[e._v(" "+e._s(e.mdiKeyboardSpace)+" ")])],1),s("td",[e._v("Next page")])]),e._m(0),e._m(1),e._m(2),e._m(3),e._m(4),e._m(5),e._m(6)])])])},qe=[function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("h")]),e("td",[t._v("Fit page to screen height")])])},function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("w")]),e("td",[t._v("Fit page to screen width")])])},function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("s")]),e("td",[t._v("Fit page to screen")])])},function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("o")]),e("td",[t._v("Show page at original size")])])},function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("2")]),e("td",[t._v("Toggle two page view")])])},function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("m")]),e("td",[t._v("Show comic's metadata")])])},function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v("esc")]),e("td",[t._v("Close book")])])}],Ke=r(We,Ve,qe,!1,null,"f37f94e1",null,null);const Me=Ke.exports,Ue={name:"ReaderSettingsPanel",components:{ReaderKeyboardShortcutsPanel:Me,ReaderSettingsPanel:U,SettingsCommonPanel:Z,DownloadPanel:M,SettingsFooter:D,VersionFooter:L},computed:{..._(f,["isCodexViewable"]),...O(a,["isSettingsDrawerOpen"])}};var je=function(){var e=this,s=e._self._c;return s(I,{staticClass:"settingsDrawer",attrs:{id:"readerSettingsDrawer",app:"",right:"",temporary:"",touchless:""},scopedSlots:e._u([{key:"append",fn:function(){return[s(L)]},proxy:!0}]),model:{value:e.isSettingsDrawerOpen,callback:function(o){e.isSettingsDrawerOpen=o},expression:"isSettingsDrawerOpen"}},[e.isCodexViewable?s("div",{staticClass:"settingsDrawerContainer"},[s("div",{attrs:{id:"topBlock"}},[s(U),s(p),s("ReaderKeyboardShortcutsPanel"),s(p),s(M),s(p),s("SettingsCommonPanel"),s(p)],1),s(D)],1):e._e()])},He=[],ze=r(Ue,je,He,!1,null,null,null,null);const j=ze.exports,Ye={name:"ReaderNavButton",props:{value:{type:Number,required:!0},twoPages:{type:Boolean,default:!1}},computed:{toRoute:function(){const t={...this.$route.params};return t.page=this.value,{name:this.$route.name,params:t}},disabled:function(){const t=[this.value];return this.twoPages&&this.value%2&&t.push(this.value-1),t.includes(+this.$route.params.page)}}};var Xe=function(){var e=this,s=e._self._c;return s(g,{staticClass:"readerNavButton",attrs:{disabled:e.disabled,to:e.toRoute,ripple:"",large:""}},[e._v(" "+e._s(e.value)+" ")])},Ze=[],Je=r(Ye,Xe,Ze,!1,null,null,null,null);const v=Je.exports;const Qe={name:"ReaderNavToolbar",components:{PaginationSlider:N,ReaderNavButton:v},computed:{..._(a,["activeSettings","activeBook"]),maxPage(){return this.activeBook?this.activeBook.maxPage:0},twoPages(){return this.activeSettings.twoPages},step(){return this.activeSettings.twoPages?2:1},trackColor(){return this.twoPages&&+this.$route.params.page>=this.maxPage-1?"#cc7b19":""}},methods:{...c(a,["routeToPage"])}};var et=function(){var e=this,s=e._self._c;return e.maxPage?s(F,{staticClass:"readerNavToolbar codexToolbar",attrs:{dense:"",transform:"center bottom"}},[s(v,{attrs:{value:0}}),s(N,{key:e.$route.params.pk,attrs:{value:+e.$route.params.page,min:0,max:e.maxPage,step:e.step,"track-color":e.trackColor},on:{change:function(o){return e.routeToPage(o)}}}),s(v,{attrs:{value:e.maxPage,"two-pages":e.twoPages}})],1):e._e()},tt=[],st=r(Qe,et,tt,!1,null,"6a16d5ae",null,null);const H=st.exports;const y="prev",x="next",ot={name:"ReaderTitleToolbar",components:{MetadataDialog:W,SettingsDrawerButton:J},data(){return{mdiClose:ne}},head(){const t=this.$route.params.page,e=`read ${this.title} page ${t}`;return{meta:[{hid:"description",name:"description",content:e}]}},computed:{..._(a,["activeTitle","activeBook"]),...i(a,{seriesPosition:function(t){return this.activeBook&&t.seriesCount>1?`${this.activeBook.seriesIndex}/${t.seriesCount}`:""}}),...i(A,{lastRoute:t=>t.page.routes.last}),...O(a,["isSettingsDrawerOpen"]),closeBookRoute:function(){const t={name:"browser",params:this.lastRoute};return t.params?t.hash=`#card-${this.$route.params.pk}`:t.params=window.CODEX.LAST_ROUTE||fe.browser.route,t}},mounted(){document.addEventListener("keyup",this._keyListener)},unmounted:function(){document.removeEventListener("keyup",this._keyListener)},methods:{...c(a,["routeToDirection"]),openMetadata:function(){this.$refs.metadataDialog.dialog=!0},_keyListener:function(t){switch(t.stopPropagation(),t.key){case" ":!t.shiftKey&&window.innerHeight+window.scrollY+1>=document.body.scrollHeight?this.routeToDirection(x):!!t.shiftKey&&window.scrollY===0&&this.routeToDirection(y);break;case"j":case"ArrowRight":this.routeToDirection(x);break;case"k":case"ArrowLeft":this.routeToDirection(y);break;case"Escape":this.$refs.closeBook.$el.click();break;case"m":this.openMetadata();break}}}};var at=function(){var e=this,s=e._self._c;return s(F,{staticClass:"codexToolbar",attrs:{id:"readerTopToolbar",dense:""}},[s(k,[s(g,{ref:"closeBook",attrs:{id:"closeBook",to:e.closeBookRoute,large:"",ripple:""}},[e.$vuetify.breakpoint.mobile?s(n,{attrs:{title:"Close Book"}},[e._v(" "+e._s(e.mdiClose)+" ")]):s("span",[e._v("close book")])],1)],1),s(w),s(Q,{attrs:{id:"toolbarTitle"}},[e._v(" "+e._s(e.activeTitle)+" ")]),s(w),e.seriesPosition?s("span",{attrs:{id:"seriesPosition",title:"Series Position"}},[e._v(e._s(e.seriesPosition))]):e._e(),s(k,[s(g,{attrs:{id:"tagButton"},on:{click:function(o){return o.stopPropagation(),e.openMetadata.apply(null,arguments)}}},[s(W,{ref:"metadataDialog",attrs:{group:"c",pk:Number(e.$route.params.pk)}})],1),s("SettingsDrawerButton",{attrs:{id:"settingsButton"},on:{click:function(o){o.stopPropagation(),e.isSettingsDrawerOpen=!0}}})],1)],1)},rt=[],nt=r(ot,at,rt,!1,null,"6b8f701b",null,null);const z=nt.exports;const T={rel:"prefetch",as:"image"},it={name:"ChangeBookDrawer",props:{direction:{type:String,required:!0}},data(){return{icon:this.direction==="next"?ie:ce,classes:{[this.direction]:!0}}},head(){const t=[];if(this.prefetchSrc1&&t.push({...T,href:this.prefetchSrc1}),this.prefetchSrc2&&t.push({...T,href:this.prefetchSrc2}),t.length>0)return{link:t}},computed:{...i(a,{isDrawerOpen(t){return t.bookChange===this.direction},params(t){return t.routes.books[this.direction]},prefetchSrc1(t){return!this.isDrawerOpen||!this.params?!1:d(this.params,t.timestamp)},prefetchSrc2(t){const e=t.books.get(this.params.pk),s=e?e.settings||{}:{},o=this.getSettings(t.readerSettings,s);if(!this.isDrawerOpen||!this.params||!o.twoPages)return!1;const u={pk:this.params.pk,page:this.params.page+1};return d(u,t.timestamp)}}),route(){return this.params?{params:this.params}:{}},label(){return`${this.direction==="prev"?"Previous":"Next"} Book`}},methods:{...c(a,["getSettings"])}};var ct=function(){var e=this,s=e._self._c;return s(I,{staticClass:"changeBookDrawer",class:e.classes,attrs:{absolute:"",left:e.direction==="prev",right:e.direction==="next",temporarary:"",value:e.isDrawerOpen,width:"33%"}},[s("router-link",{staticClass:"navLink",attrs:{to:e.route,"aria-label":e.label,title:e.label},nativeOn:{click:function(o){return o.stopImmediatePropagation()}}},[s(n,{staticClass:"bookChangeIcon"},[e._v(" "+e._s(e.icon)+" ")])],1)],1)},lt=[],ut=r(it,ct,lt,!1,null,"b6fbd91e",null,null);const b=ut.exports;const R={rel:"prefetch",as:"image"},dt={name:"PageChangeLink",props:{direction:{type:String,required:!0}},head(){const t=[];if(this.prefetchSrc1&&t.push({...R,href:this.prefetchSrc1}),this.prefetchSrc2&&t.push({...R,href:this.prefetchSrc2}),t.length>0)return{link:t}},computed:{...i(a,{params(t){return t.routes[this.direction]},prefetchSrc1(t){return this.params?d(this.params,t.timestamp):!1},prefetchSrc2(t){const e=t.books.get(this.params.pk);if(!e)return!1;const s=e.settings||{};if(!this.getSettings(t.readerSettings,s).twoPages)return!1;const u={...this.params,page:this.params.page+1};return u.page>e.maxPage?!1:d(u,t.timestamp)}}),route(){return this.params?{params:this.params}:{}},label(){return`${this.direction==="prev"?"Previous":"Next"} Page`}},methods:{...c(a,["getSettings"])}};var _t=function(){var e=this,s=e._self._c;return s("router-link",{staticClass:"pageChangeColumn",class:{leftArrow:e.direction==="prev",rightArrow:e.direction==="next"},attrs:{to:e.route,"aria-label":e.label},nativeOn:{click:function(o){return o.stopImmediatePropagation()}}})},pt=[],gt=r(dt,_t,pt,!1,null,"5c22a49c",null,null);const ht=gt.exports;const mt={name:"LoadingPage",components:{Placeholder:V},props:{twoPages:{type:Boolean,required:!0}}};var ft=function(){var e=this,s=e._self._c;return s("div",{staticClass:"pageLoading",class:{twoPages:e.twoPages}},[s("Placeholder",{staticClass:"pagePlaceholder"})],1)},vt=[],bt=r(mt,ft,vt,!1,null,"2bc79db9",null,null);const kt=bt.exports;const B="unauthorized",wt={name:"ErrorPage",props:{twoPages:{type:Boolean,required:!0},type:{type:String,required:!0}},computed:{text(){return this.type===B?"Protected page":"Failed to load page"},icon(){return this.type===B?le:ue}}};var Pt=function(){var e=this,s=e._self._c;return s("div",{staticClass:"pageError",class:{twoPages:e.twoPages}},[s("div",{staticClass:"pageErrorContainer"},[s("div",{staticClass:"pageErrorText"},[e._v(e._s(e.text))]),s(n,{staticClass:"pageErrorIcon"},[e._v(e._s(e.icon))])],1)])},St=[],$t=r(wt,Pt,St,!1,null,"8a560eed",null,null);const Ct=$t.exports;const yt={name:"ImgPage",props:{pk:{type:Number,required:!0},src:{type:String,required:!0},settings:{type:Object,required:!0},fitToClass:{type:Object,required:!0}},emits:["load","error"]};var xt=function(){var e=this,s=e._self._c;return s("img",e._g({class:e.fitToClass,attrs:{src:e.src}},e.$listeners))},Tt=[],Rt=r(yt,xt,Tt,!1,null,"1297a18f",null,null);const Bt=Rt.exports;const Dt=()=>ve(()=>import("./page-pdf.7ad12bf0.js"),["assets/page-pdf.7ad12bf0.js","assets/page-pdf.b52b5cd1.css","assets/main.a2e8bc5d.js","assets/main.7a5ad74f.css"]),Lt=333,It={name:"BookPage",components:{Placeholder:V,ErrorPage:Ct,LoadingPage:kt},props:{book:{type:Object,required:!0},page:{type:Number,required:!0},settings:{type:Object,required:!0},fitToClass:{type:Object,required:!0}},data(){return{showProgress:!1,loaded:!1,error:!1}},computed:{...i(a,{src(t){const e={pk:this.book.pk,page:this.page};return d(e,t.timestamp)}}),component(){return this.book.fileFormat==="pdf"?Dt:Bt}},mounted(){setTimeout(function(){this.loaded||(this.loading=!0)},Lt)},methods:{onLoad(){this.showProgress=!1,this.loaded=!0,this.error=!1},onError(){this.error="load",this.showProgress=!1},onUnauthorized(){this.error="unauthorized",this.showProgress=!1}}};var Ft=function(){var e=this,s=e._self._c;return s("div",{staticClass:"page"},[e.error?s("ErrorPage",{attrs:{"two-pages":e.settings.twoPages,type:e.error}}):e.showProgress&&!e.loaded?s("LoadingPage",{attrs:{"two-pages":e.settings.twoPages}}):s(e.component,{tag:"component",attrs:{pk:e.book.pk,src:e.src,settings:e.settings,"fit-to-class":e.fitToClass},on:{error:e.onError,load:e.onLoad,unauthorized:e.onUnauthorized}})],1)},Et=[],At=r(It,Ft,Et,!1,null,"93b4d4cb",null,null);const Ot=At.exports;const Gt={name:"PagesWindow",components:{BookPage:Ot,PageChangeLink:ht},props:{book:{type:Object,required:!0}},emits:["click"],data(){return{activePage:void 0}},computed:{...i(a,{bookRoutes:t=>t.routes.books,settings(t){const e=t.books.get(this.book.pk).settings;return t.getSettings(t.readerSettings,e)},prevBookPk:t=>{var e;return(e=t.routes.books)==null?void 0:e.prev.pk},twoPages:t=>t.activeSettings.twoPages}),fitToClass(){return this.getFitToClass(this.settings)},pages(){var s;const t=((s=this.book)==null?void 0:s.maxPage)+1,e=this.settings.twoPages?2:1;return be.range(0,t,e)},secondPage(){return this.settings.twoPages&&+this.activePage+1<=this.book.maxPage}},watch:{$route(t){+t.params.pk===this.book.pk&&this.setActivePageForRoute(+t.params.page)},twoPages(){this.setActivePageForRoute(+this.$route.params.page)}},created(){let t;this.book.pk===+this.$route.params.pk?t=+this.$route.params.page:this.book.pk===this.prevBookPk?t=this.book.maxPage:t=0,this.activePage=t},mounted(){this.$refs.pagesWindow.$el.children[0].addEventListener("click",this.click)},unmounted(){this.$refs.pagesWindow.$el.children[0].removeEventListener("click",this.click)},methods:{...c(a,["routeToPage","setBookChangeFlag","setRoutesAndBookmarkPage","setRoutes","getSettings","getFitToClass"]),setActivePageForRoute(t){if(t<0)return console.warn("Page out of bounds. Redirecting to 0."),this.routeToPage(0);if(t>this.book.maxPage)return console.warn(`Page out of bounds. Redirecting to ${this.book.maxPage}.`),this.routeToPage(this.book.maxPage);if(this.settings.twoPages&&t%2!==0)return console.debug(`Requested odd page ${t} in two pages mode. Flip back one`),this.routeToPage(t-1);this.activePage=t,this.setRoutesAndBookmarkPage(+this.$route.params.page),window.scrollTo(0,0)},setBookChange(t){this.bookRoutes[t]?this.setBookChangeFlag(t):this.$emit("click")},bookExists(t){return Boolean(this.bookRoutes[t])}}};var Nt=function(){var e=this,s=e._self._c;return s(q,{ref:"pagesWindow",attrs:{id:"pagesWindow","show-arrows":"",value:e.activePage},scopedSlots:e._u([{key:"prev",fn:function(){return[s("PageChangeLink",{attrs:{direction:"prev"}})]},proxy:!0},{key:"next",fn:function(){return[s("PageChangeLink",{attrs:{direction:"next"}})]},proxy:!0}])},[s("div",{staticClass:"bookChangeActivatorColumn",class:{upArrow:e.bookExists("prev")},attrs:{id:"bookChangeActivatorPrev"},on:{click:function(o){return o.stopPropagation(),e.setBookChange("prev")}}}),s("div",{staticClass:"bookChangeActivatorColumn",class:{downArrow:e.bookExists("next")},attrs:{id:"bookChangeActivatorNext"},on:{click:function(o){return o.stopPropagation(),e.setBookChange("next")}}}),e._l(e.pages,function(o){return s(K,{key:`c/${e.book.pk}/${o}`,staticClass:"windowItem",attrs:{disabled:"",eager:o>=e.activePage-1&&o<=e.activePage+2,value:o}},[s("BookPage",{attrs:{book:e.book,settings:e.settings,"fit-to-class":e.fitToClass,page:o}}),e.secondPage?s("BookPage",{attrs:{book:e.book,settings:e.settings,"fit-to-class":e.fitToClass,page:o+1}}):e._e()],1)})],2)},Wt=[],Vt=r(Gt,Nt,Wt,!1,null,"a7e862bc",null,null);const Y=Vt.exports;const qt={name:"BooksWindow",components:{ChangeBookDrawer:b},emits:["click"],computed:{...i(a,{books:t=>t.books,bookChange:t=>t.bookChange,activeBookPk:t=>t.pk,bookRoutes:t=>t.routes.books})},watch:{$route(t,e){(!e||!e.params||+t.params.pk!=+e.params.pk)&&this.loadBooks(t.params)}},mounted(){this.$refs.booksWindow.$el.children[0].addEventListener("click",this.click)},unmounted(){this.$refs.booksWindow.$el.children[0].removeEventListener("click",this.click)},created(){this.loadBooks(this.$route.params)},methods:{...c(a,["setBookChangeFlag","loadBooks"]),click(){this.setBookChangeFlag(),this.$emit("click")},eager(t){return this.bookChange&&this.bookRoutes[this.bookChange]&&this.bookRoutes[this.bookChange].pk===t}}};var Kt=function(){var e=this,s=e._self._c;return s(q,{ref:"booksWindow",attrs:{id:"booksWindow",value:e.activeBookPk,vertical:"",touchless:""}},[s(b,{attrs:{direction:"prev"}}),e._l(e.books,function([o,u]){return s(K,{key:`c/${o}`,staticClass:"windowItem",attrs:{disabled:"",eager:e.eager(o),value:o}},[s(Y,{attrs:{book:u},on:{click:e.click}})],1)}),s(b,{attrs:{direction:"next"}})],2)},Mt=[],Ut=r(qt,Kt,Mt,!1,null,"8cc88a4c",null,null);const jt=Ut.exports;const Ht={name:"MainReader",components:{BooksWindow:Y,ReaderNavToolbar:H,ReaderTitleToolbar:z,ReaderSettingsDrawer:j},data(){return{showToolbars:!1}},computed:{..._(f,["isCodexViewable"]),...i(f,{user:t=>t.user})},watch:{user:function(){this.loadReaderSettings()},isCodexViewable:function(){this.loadReaderSettings()}},created(){this.loadReaderSettings()},methods:{...c(a,["loadReaderSettings"]),toggleToolbars:function(){this.showToolbars=!this.showToolbars}}};var zt=function(){var e=this,s=e._self._c;return s("div",[s(ke,{attrs:{id:"readerWrapper"}},[e.isCodexViewable?s("div",{attrs:{id:"readerContainer"}},[s(jt,{on:{click:e.toggleToolbars}}),s(de,[s(z,{directives:[{name:"show",rawName:"v-show",value:e.showToolbars,expression:"showToolbars"}]})],1),s(_e,[s(H,{directives:[{name:"show",rawName:"v-show",value:e.showToolbars,expression:"showToolbars"}]})],1)],1):s("div",{attrs:{id:"announcement"}},[s("h1",[s("router-link",{attrs:{to:{name:"home"}}},[e._v(" Log in ")]),e._v(" to read comics ")],1)])]),s(j)],1)},Yt=[],Xt=r(Ht,zt,Yt,!1,null,"2736cf0c",null,null);const _s=Xt.exports;export{_s as default};
