{"version":3,"file":"urls.js","names":["Djblets","buildURL","options","url","baseURL","queryData","queryString","indexOf","substr","$","param","anchor","parseQueryString","allowMultiValue","j","query","length","queryParams","split","i","queryParam","key","value","decodeURIComponent","hasOwnProperty","_","isArray","push"],"sources":["../../../../../static/djblets/js/utils/urls.es6.js"],"sourcesContent":["/**\n * Build and return a URL out of different components.\n *\n * This will construct a URL based on a base URL (which may be an absolute\n * URL, a relative path, or an empty string), optional query string data (as\n * a string, a dictionary, or array), and an optional anchor name.\n *\n * Args:\n *     options (object):\n *         The options used to construct the URL.\n *\n * Option Args:\n *     anchor (unicode, optional):\n *         An anchor to append to the URL. This may include the leading ``#``,\n *         but it's optional.\n *\n *     baseURL (string, optional):\n *         The base URL to build onto, if any. If not provided, an empty\n *         string will be used.\n *\n *     queryData (*, optional):\n *         Data for the query string. This can be a string, an object, or\n *         an array of dictionaries containing ``name`` and ``value`` keys.\n *         See :js:func:`jQuery.param` for information on what's allowed here.\n *\n *         If using an object of keys and values, the sort order is not\n *         guaranteed. It will be up to the JavaScript engine. Provide a\n *         string or array to guarantee order.\n *\n *         If using a string, and the string begins with a ``?``, it will be\n *         stripped away.\n *\n * Returns:\n *     string:\n *     The resulting URL.\n */\nDjblets.buildURL = function(options={}) {\n    let url = options.baseURL || '';\n\n    /* Build the query string, if any. */\n    const queryData = options.queryData;\n\n    if (queryData) {\n        let queryString;\n\n        if (typeof queryData === 'string') {\n            queryString = queryData;\n\n            if (queryString.indexOf('?') === 0) {\n                queryString = queryString.substr(1);\n            }\n        } else {\n            queryString = $.param(queryData);\n        }\n\n        if (queryString) {\n            url += `?${queryString}`;\n        }\n    }\n\n    /* Append an anchor, if any. */\n    const anchor = options.anchor;\n\n    if (anchor) {\n        if (anchor.indexOf('#') === 0) {\n            url += anchor;\n        } else {\n            url += `#${anchor}`;\n        }\n    }\n\n    return url;\n};\n\n\n/**\n * Parse a query string for key/value pairs.\n *\n * This takes a query string in the provided URL and parses it for standard\n * key/value pairs, returning an object representing those keys and values.\n * It can handle keys without values and optionally store multiple values\n * listed for the same key.\n *\n * Args:\n *     url (string):\n *         The URL containing a query string to parse.\n *\n *     options (object, optional):\n *         Options for controlling the parsing.\n *\n * Option Args:\n *     allowMultiValue (boolean):\n *         Whether to store multiple values for the same key, if found in\n *         the query string. The value for such a key will be an array of all\n *         values. If ``false`` (the default), only last value for a key will\n *         be stored.\n *\n * Returns:\n *     object:\n *     The resulting keys and values representing the query string.\n *\n *     If there was a query string item that did not have a value (in other\n *     words, no ``=`` was present), then its value will be ``null``.\n *\n *     If ``options.allowMultiValue`` is ``true``, and a key was used more\n *     than once, then its value will be a list of all values in the query\n *     string for that key.\n */\nDjblets.parseQueryString = function(url, options={}) {\n    const allowMultiValue = options.allowMultiValue;\n\n    let j = url.indexOf('?');\n    let queryString;\n\n    if (j === -1) {\n        /* Assume the whole thing is a query string. */\n        queryString = url;\n    } else {\n        queryString = url.substr(j + 1);\n    }\n\n    const query = {};\n\n    if (queryString.length === 0) {\n        return query;\n    }\n\n    const queryParams = queryString.split('&');\n\n    for (let i = 0; i < queryParams.length; i++) {\n        const queryParam = queryParams[i];\n        let key;\n        let value;\n\n        j = queryParam.indexOf('=');\n\n        if (j === -1) {\n            key = decodeURIComponent(queryParam);\n            value = null;\n        } else {\n            key = decodeURIComponent(queryParam.substr(0, j));\n            value = decodeURIComponent(queryParam.substr(j + 1));\n        }\n\n        if (allowMultiValue && query.hasOwnProperty(key)) {\n            if (_.isArray(query[key])) {\n                query[key].push(value);\n            } else {\n                query[key] = [query[key], value];\n            }\n        } else {\n            query[key] = value;\n        }\n    }\n\n    return query;\n};\n"],"mappings":"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"}