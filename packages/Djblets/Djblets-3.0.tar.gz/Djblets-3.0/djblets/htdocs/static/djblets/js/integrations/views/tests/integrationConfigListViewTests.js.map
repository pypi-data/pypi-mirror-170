{"version":3,"file":"integrationConfigListViewTests.js","names":["suite","template","_","collection","view","beforeEach","$el","$","appendTo","$testsScratch","Djblets","IntegrationConfigListView","el","configs","integrationIDs","integrationsMap","int1","int2","int3","render","list","describe","$row1","$row2","$row3","$row4","$rows","listView","expect","length","toBe","eq","it","$icon1","find","$icon2","$icon3","$icon4","attr","$name1","$name2","$name3","$name4","text","$intName1","$intName2","$intName3","$intName4","trim","hasClass","config","at","spyOn","and","callThrough","fn","callFake","options","buttons","click","modalBox","toHaveBeenCalled","destroy"],"sources":["../../../../../../../static/djblets/js/integrations/views/tests/integrationConfigListViewTests.es6.js"],"sourcesContent":["suite('djblets/integrations/views/IntegrationConfigListView', function() {\n    const template = _.template(dedent`\n        <div class=\"djblets-c-integration-configs\">\n         <div class=\"djblets-l-config-forms-container\">\n          <table class=\"djblets-c-config-forms-list\"></table>\n         </div>\n        </div>\n    `);\n    let collection;\n    let view;\n\n    beforeEach(function() {\n        const $el = $(template()).appendTo($testsScratch);\n\n        view = new Djblets.IntegrationConfigListView({\n            el: $el,\n            configs: [\n                {\n                    'editURL' : 'configs/1/',\n                    'enabled': true,\n                    'id': 1,\n                    'integrationID': 'int1',\n                    'name': 'Config 1',\n                },\n                {\n                    'editURL' : 'configs/2/',\n                    'enabled': true,\n                    'id': 2,\n                    'integrationID': 'int2',\n                    'name': 'Config 2',\n                },\n                {\n                    'editURL' : 'configs/3/',\n                    'enabled': false,\n                    'id': 3,\n                    'integrationID': 'int3',\n                    'name': 'Config 3',\n                },\n                {\n                    'editURL' : 'configs/4/',\n                    'enabled': true,\n                    'id': 4,\n                    'integrationID': 'int1',\n                    'name': 'Config 4',\n                },\n            ],\n            integrationIDs: ['int1', 'int2', 'int3'],\n            integrationsMap: {\n                int1: {\n                    'addURL': 'int1/add/',\n                    'description': 'Int1 Description',\n                    'iconSrc': 'data:test,int1',\n                    'iconSrcSet': 'data:test,int1 1x, data:test,int1@2x 2x',\n                    'id': 'int1',\n                    'name': 'Int1',\n                },\n                int2: {\n                    'addURL': 'int2/add/',\n                    'description': 'Int2 Description',\n                    'iconSrc': 'data:test,int2',\n                    'iconSrcSet': 'data:test,int2 1x, data:test,int2@2x 2x',\n                    'id': 'int2',\n                    'name': 'Int2',\n                },\n                int3: {\n                    'addURL': 'int3/add/',\n                    'description': 'Int3 Description',\n                    'iconSrc': 'data:test,int3',\n                    'iconSrcSet': 'data:test,int3 1x, data:test,int3@2x 2x',\n                    'id': 'int3',\n                    'name': 'Int3',\n                },\n            },\n        });\n        view.render();\n\n        collection = view.list.collection;\n    });\n\n    describe('Configurations', function() {\n        let $row1;\n        let $row2;\n        let $row3;\n        let $row4;\n\n        beforeEach(function() {\n            const $rows = view.listView.$('tr');\n            expect($rows.length).toBe(4);\n\n            $row1 = $rows.eq(0);\n            $row2 = $rows.eq(1);\n            $row3 = $rows.eq(2);\n            $row4 = $rows.eq(3);\n        });\n\n        describe('Rendering', function() {\n            it('Icon', function() {\n                const $icon1 =\n                    $row1.find('.djblets-c-integration-config__name img');\n                const $icon2 =\n                    $row2.find('.djblets-c-integration-config__name img');\n                const $icon3 =\n                    $row3.find('.djblets-c-integration-config__name img');\n                const $icon4 =\n                    $row4.find('.djblets-c-integration-config__name img');\n\n                expect($icon1.attr('src')).toBe('data:test,int1');\n                expect($icon2.attr('src')).toBe('data:test,int2');\n                expect($icon3.attr('src')).toBe('data:test,int3');\n                expect($icon4.attr('src')).toBe('data:test,int1');\n\n                expect($icon1.attr('srcset'))\n                    .toBe('data:test,int1 1x, data:test,int1@2x 2x');\n                expect($icon2.attr('srcset'))\n                    .toBe('data:test,int2 1x, data:test,int2@2x 2x');\n                expect($icon3.attr('srcset'))\n                    .toBe('data:test,int3 1x, data:test,int3@2x 2x');\n                expect($icon4.attr('srcset'))\n                    .toBe('data:test,int1 1x, data:test,int1@2x 2x');\n            });\n\n            it('Name', function() {\n                const $name1 =\n                    $row1.find('.djblets-c-integration-config__name a');\n                const $name2 =\n                    $row2.find('.djblets-c-integration-config__name a');\n                const $name3 =\n                    $row3.find('.djblets-c-integration-config__name a');\n                const $name4 =\n                    $row4.find('.djblets-c-integration-config__name a');\n\n                expect($name1.text()).toBe('Config 1');\n                expect($name2.text()).toBe('Config 2');\n                expect($name3.text()).toBe('Config 3');\n                expect($name4.text()).toBe('Config 4');\n\n                expect($name1.attr('href')).toBe('configs/1/');\n                expect($name2.attr('href')).toBe('configs/2/');\n                expect($name3.attr('href')).toBe('configs/3/');\n                expect($name4.attr('href')).toBe('configs/4/');\n            });\n\n            it('Integration name', function() {\n                const $intName1 = $row1.find(\n                    '.djblets-c-integration-config__integration-name');\n                const $intName2 = $row2.find(\n                    '.djblets-c-integration-config__integration-name');\n                const $intName3 = $row3.find(\n                    '.djblets-c-integration-config__integration-name');\n                const $intName4 = $row4.find(\n                    '.djblets-c-integration-config__integration-name');\n\n                expect($intName1.text().trim()).toBe('Int1');\n                expect($intName2.text().trim()).toBe('Int2');\n                expect($intName3.text().trim()).toBe('Int3');\n                expect($intName4.text().trim()).toBe('Int1');\n            });\n\n            it('Status', function() {\n                expect($row1.hasClass('-is-enabled')).toBe(true);\n                expect($row2.hasClass('-is-enabled')).toBe(true);\n                expect($row3.hasClass('-is-enabled')).toBe(false);\n                expect($row4.hasClass('-is-enabled')).toBe(true);\n\n                expect($row1.hasClass('-is-disabled')).toBe(false);\n                expect($row2.hasClass('-is-disabled')).toBe(false);\n                expect($row3.hasClass('-is-disabled')).toBe(true);\n                expect($row4.hasClass('-is-disabled')).toBe(false);\n\n                expect(\n                    $row1.find('.djblets-c-config-forms-list__item-state')\n                    .text()\n                ).toBe('Enabled');\n\n                expect(\n                    $row2.find('.djblets-c-config-forms-list__item-state')\n                    .text()\n                ).toBe('Enabled');\n\n                expect(\n                    $row3.find('.djblets-c-config-forms-list__item-state')\n                    .text()\n                ).toBe('Disabled');\n\n                expect(\n                    $row4.find('.djblets-c-config-forms-list__item-state')\n                    .text()\n                ).toBe('Enabled');\n            });\n        });\n\n        describe('Actions', function() {\n            it('Delete', function() {\n                const config = collection.at(0);\n\n                spyOn(config, 'destroy').and.callThrough();\n                spyOn(config, 'sync');\n\n                spyOn($.fn, 'modalBox').and.callFake(\n                    options => options.buttons[1].click());\n\n                $row1.find('.config-forms-list-action-delete').click();\n\n                expect($.fn.modalBox).toHaveBeenCalled();\n                expect(config.destroy).toHaveBeenCalled();\n\n                expect(collection.length).toBe(3);\n                expect(view.listView.$('tr').length).toBe(3);\n            });\n        });\n    });\n});\n"],"mappings":"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"}