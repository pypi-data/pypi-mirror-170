{"version":3,"file":"listItemView.js","names":["Djblets","Config","ListItemView","Backbone","View","extend","tagName","className","iconBaseClassName","itemStateClasses","disabled","enabled","error","actionHandlers","template","_","initialize","listenTo","model","render","showSpinner","hideSpinner","remove","$spinnerParent","$spinner","$el","empty","append","defaults","attributes","getRenderContext","_$itemState","$","_onItemStateChanged","addActions","getActionsParent","fadeOut","prototype","call","attr","addClass","prependTo","hide","css","fadeIn","removeAttr","$parentEl","$actions","actions","forEach","action","$action","_buildActionEl","appendTo","children","label","click","defer","_showActionDropdown","actionPos","position","$menu","minWidth","outerWidth","e","stopPropagation","$items","actionLeft","left","getExtents","childAction","id","trigger","parent","winWidth","window","width","paneWidth","move","offset","innerWidth","top","outerHeight","document","one","actionHandlerName","isCheckbox","type","isRadio","$result","inputID","uniqueId","name","$label","text","propName","bindProperty","radioValue","enabledPropName","inverse","enabledPropInverse","actionHandler","debounce","bind","change","dispatchOnClick","url","ariaLabel","iconName","prepend","evt","preventDefault","_onActionButtonClicked","danger","primary","prop","oldItemState","previous","itemState","get","removeClass","itemStateTexts","promise","then","childrenHTML","html","finally"],"sources":["../../../../../../static/djblets/js/configForms/views/listItemView.es6.js"],"sourcesContent":["/**\n * Display a list item for a config page.\n *\n * The list item will show information on the item and any actions that can\n * be invoked.\n *\n * By default, this will show the text from the ListItem model, linking it\n * if the model has an editURL attribute. This can be customized by subclasses\n * by overriding `template`.\n */\nDjblets.Config.ListItemView = Backbone.View.extend({\n    tagName: 'li',\n    className: 'djblets-c-config-forms-list__item',\n    iconBaseClassName: 'djblets-icon',\n\n    /**\n     * A mapping of item states to CSS classes.\n     *\n     * Subclasses can extend this to provide custom CSS classes, or support\n     * custom item states.\n     */\n    itemStateClasses: {\n        disabled: '-is-disabled',\n        enabled: '-is-enabled',\n        error: '-has-error',\n    },\n\n    actionHandlers: {},\n\n    template: _.template(dedent`\n        <% if (editURL) { %>\n        <a href=\"<%- editURL %>\"><%- text %></a>\n        <% } else { %>\n        <%- text %>\n        <% } %>\n    `),\n\n    /**\n     * Initialize the view.\n     */\n    initialize() {\n        this.listenTo(this.model, 'actionsChanged', this.render);\n        this.listenTo(this.model, 'request', this.showSpinner);\n        this.listenTo(this.model, 'sync', this.hideSpinner);\n        this.listenTo(this.model, 'destroy', this.remove);\n\n        this.$spinnerParent = null;\n        this.$spinner = null;\n    },\n\n    /**\n     * Render the view.\n     *\n     * This will be called every time the list of actions change for\n     * the item.\n     *\n     * Returns:\n     *     Djblets.Config.ListItemView:\n     *     This view.\n     */\n    render() {\n        const model = this.model;\n\n        this.$el\n            .empty()\n            .append(this.template(_.defaults(\n                model.attributes,\n                this.getRenderContext()\n            )));\n\n        this._$itemState =\n            this.$('.djblets-c-config-forms-list__item-state');\n\n        this.listenTo(model, 'change:itemState', this._onItemStateChanged);\n        this._onItemStateChanged();\n\n        this.addActions(this.getActionsParent());\n\n        return this;\n    },\n\n    /**\n     * Return additional render context.\n     *\n     * By default this returns an empty object. Subclasses can use this to\n     * provide additional values to :js:attr:`template` when it is rendered.\n     *\n     * Returns:\n     *     object:\n     *     Additional rendering context for the template.\n     */\n    getRenderContext() {\n        return {};\n    },\n\n    /**\n     * Remove the item.\n     *\n     * This will fade out the item, and then remove it from view.\n     */\n    remove() {\n        this.$el.fadeOut('normal',\n                         () => Backbone.View.prototype.remove.call(this));\n    },\n\n    /**\n     * Return the container for the actions.\n     *\n     * This defaults to being this element, but it can be overridden to\n     * return a more specific element.\n     *\n     * Returns:\n     *     jQuery:\n     *     The container for the actions.\n     */\n    getActionsParent() {\n        return this.$el;\n    },\n\n    /**\n     * Display a spinner on the item.\n     *\n     * This can be used to show that the item is being loaded from the\n     * server.\n     */\n    showSpinner() {\n        if (this.$spinner) {\n            return;\n        }\n\n        this.$el.attr('aria-busy', 'true');\n        this.$spinner = $('<span>')\n            .addClass('djblets-o-spinner')\n            .attr('aria-hidden', 'true')\n            .prependTo(this.$spinnerParent)\n            .hide()\n            .css('visibility', 'visible')\n            .fadeIn();\n    },\n\n    /**\n     * Hide the currently visible spinner.\n     */\n    hideSpinner() {\n        if (!this.$spinner) {\n            return;\n        }\n\n        /*\n         * The slow fadeout does two things:\n         *\n         * 1) It prevents the spinner from disappearing too quickly\n         *    (in combination with the fadeIn above), in case the operation\n         *    is really fast, giving some feedback that something actually\n         *    happened.\n         *\n         * 2) By fading out, it doesn't look like it just simply stops.\n         *    Helps provide a sense of completion.\n         */\n        this.$spinner.fadeOut('slow', () => {\n            this.$spinner.remove();\n            this.$spinner = null;\n        });\n\n        this.$el.removeAttr('aria-busy');\n    },\n\n    /**\n     * Add all registered actions to the view.\n     *\n     * Args:\n     *     $parentEl (jQuery):\n     *         The parent element to add the actions to.\n     */\n    addActions($parentEl) {\n        const $actions = $('<span>')\n            .addClass('djblets-c-config-forms-list__item-actions');\n\n        this.model.actions.forEach(action => {\n            const $action = this._buildActionEl(action)\n                .appendTo($actions);\n\n            if (action.children) {\n                if (action.label) {\n                    $action.append(' &#9662;');\n                }\n\n                /*\n                 * Show the dropdown after we let this event propagate.\n                 */\n                $action.click(() => _.defer(\n                    () => this._showActionDropdown(action, $action)\n                ));\n            }\n        });\n\n        this.$spinnerParent = $actions;\n\n        $actions.prependTo($parentEl);\n    },\n\n    /**\n     * Show a dropdown for a menu action.\n     *\n     * Args:\n     *     action (object):\n     *         The action to show the dropdown for. See\n     *         :js:class:`Djblets.Config.ListItem`. for a list of attributes.\n     *\n     *     $action (jQuery):\n     *         The element that represents the action.\n     */\n    _showActionDropdown(action, $action) {\n        const actionPos = $action.position();\n        const $menu = $('<div/>')\n            .css({\n                minWidth: $action.outerWidth(),\n                position: 'absolute',\n            })\n            .addClass('djblets-c-config-forms-popup-menu')\n            .click(e => e.stopPropagation());\n        const $items = $('<ul/>')\n            .addClass('djblets-c-config-forms-popup-menu__items')\n            .appendTo($menu);\n        const actionLeft = actionPos.left + $action.getExtents('m', 'l');\n\n        action.children.forEach(\n            childAction => $('<li/>')\n                .addClass('djblets-c-config-forms-popup-menu__item ' +\n                          `config-forms-list-action-row-${childAction.id}`)\n                .append(this._buildActionEl(childAction))\n                .appendTo($items)\n        );\n\n        this.trigger('actionMenuPopUp', {\n            action: action,\n            $action: $action,\n            $menu: $menu,\n        });\n\n        $menu.appendTo($action.parent());\n\n        const winWidth = $(window).width();\n        const paneWidth = $menu.width();\n\n        $menu.move(($action.offset().left + paneWidth > winWidth\n                    ? actionLeft + $action.innerWidth() - paneWidth\n                    : actionLeft),\n                   actionPos.top + $action.outerHeight(),\n                   'absolute');\n\n        /* Any click outside this dropdown should close it. */\n        $(document).one('click', () => {\n            this.trigger('actionMenuPopDown', {\n                action: action,\n                $action: $action,\n                $menu: $menu,\n            });\n\n            $menu.remove();\n        });\n    },\n\n    /**\n     * Build the element for an action.\n     *\n     * If the action's type is ``'checkbox'``, a checkbox will be shown.\n     * Otherwise, the action will be shown as a button.\n     *\n     * Args:\n     *     action (object):\n     *         The action to show the dropdown for. See\n     *         :js:class:`Djblets.Config.ListItem` for a list of attributes.\n     */\n    _buildActionEl(action) {\n        const enabled = (action.enabled !== false);\n        const actionHandlerName = (enabled\n                                   ? this.actionHandlers[action.id]\n                                   : null);\n        const isCheckbox = (action.type === 'checkbox');\n        const isRadio = (action.type === 'radio');\n\n        let $action;\n        let $result;\n\n        if (isCheckbox || isRadio) {\n            const inputID = _.uniqueId('action_' + action.type);\n            $action = $('<input/>')\n                .attr({\n                    name: action.name,\n                    type: action.type,\n                    id: inputID\n                });\n            const $label = $('<label>')\n                .attr('for', inputID)\n                .text(action.label);\n\n            if (action.id) {\n                $label.addClass(`config-forms-list-action-label-${action.id}`);\n            }\n\n            $result = $('<span/>')\n                .append($action)\n                .append($label);\n\n            if (action.propName) {\n                if (isCheckbox) {\n                    $action.bindProperty('checked', this.model,\n                                         action.propName);\n                } else if (isRadio) {\n                    $action.bindProperty(\n                        'checked', this.model, action.propName, {\n                            radioValue: action.radioValue\n                        }\n                    );\n                }\n            }\n\n            if (action.enabledPropName) {\n                $action.bindProperty(\n                    'disabled', this.model, action.enabledPropName,\n                    {\n                        inverse: (action.enabledPropInverse !== true)\n                    });\n            }\n\n            if (actionHandlerName) {\n                const actionHandler = _.debounce(\n                    _.bind(this[actionHandlerName], this),\n                    50,\n                    true\n                );\n\n                $action.change(actionHandler);\n\n                if (isRadio && action.dispatchOnClick) {\n                    $action.click(actionHandler);\n                }\n            }\n        } else {\n            if (action.url) {\n                $action = $('<a class=\"btn\" role=\"button\">')\n                    .attr('href', action.url);\n            } else {\n                $action = $('<button type=\"button\">');\n            }\n\n            $result = $action;\n\n            if (action.label) {\n                $action.text(action.label);\n            }\n\n            if (action.ariaLabel) {\n                $action.attr('aria-label', action.ariaLabel);\n            }\n\n            if (action.iconName) {\n                $action.prepend($('<span>')\n                    .addClass(this.iconBaseClassName)\n                    .addClass(`${this.iconBaseClassName}-${action.iconName}`));\n            }\n\n            if (actionHandlerName) {\n                $action.click(evt => {\n                    evt.preventDefault();\n                    evt.stopPropagation();\n\n                    this._onActionButtonClicked(evt, actionHandlerName,\n                                                $action);\n                });\n            }\n        }\n\n        $action.addClass('djblets-c-config-forms-list__item-action');\n\n        if (action.id) {\n            $action.addClass(`config-forms-list-action-${action.id}`);\n        }\n\n        if (action.danger) {\n            $action.addClass('-is-danger');\n        }\n\n        if (action.primary) {\n            $action.addClass('-is-primary');\n        }\n\n        if (!enabled) {\n            $action.prop('disabled', true);\n        }\n\n        return $result;\n    },\n\n    /**\n     * Handle changes to the item state.\n     *\n     * This will update the CSS class used on the item and any relevant text\n     * contained within the item to reflect the current state.\n     */\n    _onItemStateChanged() {\n        const model = this.model;\n        const oldItemState = model.previous('itemState');\n        const itemState = model.get('itemState');\n\n        if (oldItemState) {\n            this.$el.removeClass(this.itemStateClasses[oldItemState]);\n        }\n\n        if (itemState) {\n            this.$el.addClass(this.itemStateClasses[itemState]);\n\n            /*\n             * Note that if we didn't find an element in the template for\n             * this before, this is basically a no-op.\n             */\n            this._$itemState.text(model.itemStateTexts[itemState]);\n        }\n    },\n\n    /**\n     * Handle clicks on a list item action button.\n     *\n     * This will invoke the click handler on the view. If that handler\n     * returns a Promise, this will disable the button, replace its contents\n     * with a spinner, and then wait for the promise to resolve before\n     * setting the button's contents and enabled states back to normal.\n     *\n     * Args:\n     *     evt (jQuery.Event):\n     *         The click event on the button.\n     *\n     *     actionHandlerName (string):\n     *         The name of the action handler function to call.\n     *\n     *     $action (jQuery):\n     *         The action button that was clicked.\n     */\n    _onActionButtonClicked(evt, actionHandlerName, $action) {\n        const promise = this[actionHandlerName].call(this, evt);\n\n        if (promise && typeof promise.then === 'function') {\n            $action.prop('disabled', true);\n\n            const childrenHTML = $action.html();\n            $action.empty();\n\n            const $spinner = $('<span class=\"djblets-o-spinner\">')\n                .appendTo($action);\n\n            /*\n             * This is a promise, so there's an async operation\n             * going on. Set up the spinner.\n             */\n            promise.finally(() => {\n                $spinner.remove();\n                $action.html(childrenHTML);\n                $action.prop('disabled', false);\n            });\n        }\n    },\n});\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAA,OAAO,CAACC,MAAR,CAAeC,YAAf,GAA8BC,QAAQ,CAACC,IAAT,CAAcC,MAAd,CAAqB;EAC/CC,OAAO,EAAE,IADsC;EAE/CC,SAAS,EAAE,mCAFoC;EAG/CC,iBAAiB,EAAE,cAH4B;;EAK/C;AACJ;AACA;AACA;AACA;AACA;EACIC,gBAAgB,EAAE;IACdC,QAAQ,EAAE,cADI;IAEdC,OAAO,EAAE,aAFK;IAGdC,KAAK,EAAE;EAHO,CAX6B;EAiB/CC,cAAc,EAAE,EAjB+B;EAmB/CC,QAAQ,EAAEC,CAAC,CAACD,QAAF,CAAkB;AAChC;AACA;AACA;AACA,QAJc,CAnBqC;;EA2B/C;AACJ;AACA;EACIE,UAAU,GAAG;IACT,KAAKC,QAAL,CAAc,KAAKC,KAAnB,EAA0B,gBAA1B,EAA4C,KAAKC,MAAjD;IACA,KAAKF,QAAL,CAAc,KAAKC,KAAnB,EAA0B,SAA1B,EAAqC,KAAKE,WAA1C;IACA,KAAKH,QAAL,CAAc,KAAKC,KAAnB,EAA0B,MAA1B,EAAkC,KAAKG,WAAvC;IACA,KAAKJ,QAAL,CAAc,KAAKC,KAAnB,EAA0B,SAA1B,EAAqC,KAAKI,MAA1C;IAEA,KAAKC,cAAL,GAAsB,IAAtB;IACA,KAAKC,QAAL,GAAgB,IAAhB;EACH,CAtC8C;;EAwC/C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIL,MAAM,GAAG;IACL,MAAMD,KAAK,GAAG,KAAKA,KAAnB;IAEA,KAAKO,GAAL,CACKC,KADL,GAEKC,MAFL,CAEY,KAAKb,QAAL,CAAcC,CAAC,CAACa,QAAF,CAClBV,KAAK,CAACW,UADY,EAElB,KAAKC,gBAAL,EAFkB,CAAd,CAFZ;IAOA,KAAKC,WAAL,GACI,KAAKC,CAAL,CAAO,0CAAP,CADJ;IAGA,KAAKf,QAAL,CAAcC,KAAd,EAAqB,kBAArB,EAAyC,KAAKe,mBAA9C;;IACA,KAAKA,mBAAL;;IAEA,KAAKC,UAAL,CAAgB,KAAKC,gBAAL,EAAhB;IAEA,OAAO,IAAP;EACH,CArE8C;;EAuE/C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIL,gBAAgB,GAAG;IACf,OAAO,EAAP;EACH,CAnF8C;;EAqF/C;AACJ;AACA;AACA;AACA;EACIR,MAAM,GAAG;IACL,KAAKG,GAAL,CAASW,OAAT,CAAiB,QAAjB,EACiB,MAAMjC,QAAQ,CAACC,IAAT,CAAciC,SAAd,CAAwBf,MAAxB,CAA+BgB,IAA/B,CAAoC,IAApC,CADvB;EAEH,CA7F8C;;EA+F/C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIH,gBAAgB,GAAG;IACf,OAAO,KAAKV,GAAZ;EACH,CA3G8C;;EA6G/C;AACJ;AACA;AACA;AACA;AACA;EACIL,WAAW,GAAG;IACV,IAAI,KAAKI,QAAT,EAAmB;MACf;IACH;;IAED,KAAKC,GAAL,CAASc,IAAT,CAAc,WAAd,EAA2B,MAA3B;IACA,KAAKf,QAAL,GAAgBQ,CAAC,CAAC,QAAD,CAAD,CACXQ,QADW,CACF,mBADE,EAEXD,IAFW,CAEN,aAFM,EAES,MAFT,EAGXE,SAHW,CAGD,KAAKlB,cAHJ,EAIXmB,IAJW,GAKXC,GALW,CAKP,YALO,EAKO,SALP,EAMXC,MANW,EAAhB;EAOH,CAhI8C;;EAkI/C;AACJ;AACA;EACIvB,WAAW,GAAG;IACV,IAAI,CAAC,KAAKG,QAAV,EAAoB;MAChB;IACH;IAED;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;IACQ,KAAKA,QAAL,CAAcY,OAAd,CAAsB,MAAtB,EAA8B,MAAM;MAChC,KAAKZ,QAAL,CAAcF,MAAd;MACA,KAAKE,QAAL,GAAgB,IAAhB;IACH,CAHD;IAKA,KAAKC,GAAL,CAASoB,UAAT,CAAoB,WAApB;EACH,CA3J8C;;EA6J/C;AACJ;AACA;AACA;AACA;AACA;AACA;EACIX,UAAU,CAACY,SAAD,EAAY;IAClB,MAAMC,QAAQ,GAAGf,CAAC,CAAC,QAAD,CAAD,CACZQ,QADY,CACH,2CADG,CAAjB;IAGA,KAAKtB,KAAL,CAAW8B,OAAX,CAAmBC,OAAnB,CAA2BC,MAAM,IAAI;MACjC,MAAMC,OAAO,GAAG,KAAKC,cAAL,CAAoBF,MAApB,EACXG,QADW,CACFN,QADE,CAAhB;;MAGA,IAAIG,MAAM,CAACI,QAAX,EAAqB;QACjB,IAAIJ,MAAM,CAACK,KAAX,EAAkB;UACdJ,OAAO,CAACxB,MAAR,CAAe,UAAf;QACH;QAED;AAChB;AACA;;;QACgBwB,OAAO,CAACK,KAAR,CAAc,MAAMzC,CAAC,CAAC0C,KAAF,CAChB,MAAM,KAAKC,mBAAL,CAAyBR,MAAzB,EAAiCC,OAAjC,CADU,CAApB;MAGH;IACJ,CAhBD;IAkBA,KAAK5B,cAAL,GAAsBwB,QAAtB;IAEAA,QAAQ,CAACN,SAAT,CAAmBK,SAAnB;EACH,CA7L8C;;EA+L/C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIY,mBAAmB,CAACR,MAAD,EAASC,OAAT,EAAkB;IACjC,MAAMQ,SAAS,GAAGR,OAAO,CAACS,QAAR,EAAlB;IACA,MAAMC,KAAK,GAAG7B,CAAC,CAAC,QAAD,CAAD,CACTW,GADS,CACL;MACDmB,QAAQ,EAAEX,OAAO,CAACY,UAAR,EADT;MAEDH,QAAQ,EAAE;IAFT,CADK,EAKTpB,QALS,CAKA,mCALA,EAMTgB,KANS,CAMHQ,CAAC,IAAIA,CAAC,CAACC,eAAF,EANF,CAAd;IAOA,MAAMC,MAAM,GAAGlC,CAAC,CAAC,OAAD,CAAD,CACVQ,QADU,CACD,0CADC,EAEVa,QAFU,CAEDQ,KAFC,CAAf;IAGA,MAAMM,UAAU,GAAGR,SAAS,CAACS,IAAV,GAAiBjB,OAAO,CAACkB,UAAR,CAAmB,GAAnB,EAAwB,GAAxB,CAApC;IAEAnB,MAAM,CAACI,QAAP,CAAgBL,OAAhB,CACIqB,WAAW,IAAItC,CAAC,CAAC,OAAD,CAAD,CACVQ,QADU,CACD,6CACC,gCAA+B8B,WAAW,CAACC,EAAG,EAF9C,EAGV5C,MAHU,CAGH,KAAKyB,cAAL,CAAoBkB,WAApB,CAHG,EAIVjB,QAJU,CAIDa,MAJC,CADnB;IAQA,KAAKM,OAAL,CAAa,iBAAb,EAAgC;MAC5BtB,MAAM,EAAEA,MADoB;MAE5BC,OAAO,EAAEA,OAFmB;MAG5BU,KAAK,EAAEA;IAHqB,CAAhC;IAMAA,KAAK,CAACR,QAAN,CAAeF,OAAO,CAACsB,MAAR,EAAf;IAEA,MAAMC,QAAQ,GAAG1C,CAAC,CAAC2C,MAAD,CAAD,CAAUC,KAAV,EAAjB;IACA,MAAMC,SAAS,GAAGhB,KAAK,CAACe,KAAN,EAAlB;IAEAf,KAAK,CAACiB,IAAN,CAAY3B,OAAO,CAAC4B,MAAR,GAAiBX,IAAjB,GAAwBS,SAAxB,GAAoCH,QAApC,GACEP,UAAU,GAAGhB,OAAO,CAAC6B,UAAR,EAAb,GAAoCH,SADtC,GAEEV,UAFd,EAGWR,SAAS,CAACsB,GAAV,GAAgB9B,OAAO,CAAC+B,WAAR,EAH3B,EAIW,UAJX;IAMA;;IACAlD,CAAC,CAACmD,QAAD,CAAD,CAAYC,GAAZ,CAAgB,OAAhB,EAAyB,MAAM;MAC3B,KAAKZ,OAAL,CAAa,mBAAb,EAAkC;QAC9BtB,MAAM,EAAEA,MADsB;QAE9BC,OAAO,EAAEA,OAFqB;QAG9BU,KAAK,EAAEA;MAHuB,CAAlC;MAMAA,KAAK,CAACvC,MAAN;IACH,CARD;EASH,CA3P8C;;EA6P/C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI8B,cAAc,CAACF,MAAD,EAAS;IACnB,MAAMvC,OAAO,GAAIuC,MAAM,CAACvC,OAAP,KAAmB,KAApC;IACA,MAAM0E,iBAAiB,GAAI1E,OAAO,GACL,KAAKE,cAAL,CAAoBqC,MAAM,CAACqB,EAA3B,CADK,GAEL,IAF7B;IAGA,MAAMe,UAAU,GAAIpC,MAAM,CAACqC,IAAP,KAAgB,UAApC;IACA,MAAMC,OAAO,GAAItC,MAAM,CAACqC,IAAP,KAAgB,OAAjC;IAEA,IAAIpC,OAAJ;IACA,IAAIsC,OAAJ;;IAEA,IAAIH,UAAU,IAAIE,OAAlB,EAA2B;MACvB,MAAME,OAAO,GAAG3E,CAAC,CAAC4E,QAAF,CAAW,YAAYzC,MAAM,CAACqC,IAA9B,CAAhB;;MACApC,OAAO,GAAGnB,CAAC,CAAC,UAAD,CAAD,CACLO,IADK,CACA;QACFqD,IAAI,EAAE1C,MAAM,CAAC0C,IADX;QAEFL,IAAI,EAAErC,MAAM,CAACqC,IAFX;QAGFhB,EAAE,EAAEmB;MAHF,CADA,CAAV;MAMA,MAAMG,MAAM,GAAG7D,CAAC,CAAC,SAAD,CAAD,CACVO,IADU,CACL,KADK,EACEmD,OADF,EAEVI,IAFU,CAEL5C,MAAM,CAACK,KAFF,CAAf;;MAIA,IAAIL,MAAM,CAACqB,EAAX,EAAe;QACXsB,MAAM,CAACrD,QAAP,CAAiB,kCAAiCU,MAAM,CAACqB,EAAG,EAA5D;MACH;;MAEDkB,OAAO,GAAGzD,CAAC,CAAC,SAAD,CAAD,CACLL,MADK,CACEwB,OADF,EAELxB,MAFK,CAEEkE,MAFF,CAAV;;MAIA,IAAI3C,MAAM,CAAC6C,QAAX,EAAqB;QACjB,IAAIT,UAAJ,EAAgB;UACZnC,OAAO,CAAC6C,YAAR,CAAqB,SAArB,EAAgC,KAAK9E,KAArC,EACqBgC,MAAM,CAAC6C,QAD5B;QAEH,CAHD,MAGO,IAAIP,OAAJ,EAAa;UAChBrC,OAAO,CAAC6C,YAAR,CACI,SADJ,EACe,KAAK9E,KADpB,EAC2BgC,MAAM,CAAC6C,QADlC,EAC4C;YACpCE,UAAU,EAAE/C,MAAM,CAAC+C;UADiB,CAD5C;QAKH;MACJ;;MAED,IAAI/C,MAAM,CAACgD,eAAX,EAA4B;QACxB/C,OAAO,CAAC6C,YAAR,CACI,UADJ,EACgB,KAAK9E,KADrB,EAC4BgC,MAAM,CAACgD,eADnC,EAEI;UACIC,OAAO,EAAGjD,MAAM,CAACkD,kBAAP,KAA8B;QAD5C,CAFJ;MAKH;;MAED,IAAIf,iBAAJ,EAAuB;QACnB,MAAMgB,aAAa,GAAGtF,CAAC,CAACuF,QAAF,CAClBvF,CAAC,CAACwF,IAAF,CAAO,KAAKlB,iBAAL,CAAP,EAAgC,IAAhC,CADkB,EAElB,EAFkB,EAGlB,IAHkB,CAAtB;;QAMAlC,OAAO,CAACqD,MAAR,CAAeH,aAAf;;QAEA,IAAIb,OAAO,IAAItC,MAAM,CAACuD,eAAtB,EAAuC;UACnCtD,OAAO,CAACK,KAAR,CAAc6C,aAAd;QACH;MACJ;IACJ,CAtDD,MAsDO;MACH,IAAInD,MAAM,CAACwD,GAAX,EAAgB;QACZvD,OAAO,GAAGnB,CAAC,CAAC,+BAAD,CAAD,CACLO,IADK,CACA,MADA,EACQW,MAAM,CAACwD,GADf,CAAV;MAEH,CAHD,MAGO;QACHvD,OAAO,GAAGnB,CAAC,CAAC,wBAAD,CAAX;MACH;;MAEDyD,OAAO,GAAGtC,OAAV;;MAEA,IAAID,MAAM,CAACK,KAAX,EAAkB;QACdJ,OAAO,CAAC2C,IAAR,CAAa5C,MAAM,CAACK,KAApB;MACH;;MAED,IAAIL,MAAM,CAACyD,SAAX,EAAsB;QAClBxD,OAAO,CAACZ,IAAR,CAAa,YAAb,EAA2BW,MAAM,CAACyD,SAAlC;MACH;;MAED,IAAIzD,MAAM,CAAC0D,QAAX,EAAqB;QACjBzD,OAAO,CAAC0D,OAAR,CAAgB7E,CAAC,CAAC,QAAD,CAAD,CACXQ,QADW,CACF,KAAKhC,iBADH,EAEXgC,QAFW,CAED,GAAE,KAAKhC,iBAAkB,IAAG0C,MAAM,CAAC0D,QAAS,EAF3C,CAAhB;MAGH;;MAED,IAAIvB,iBAAJ,EAAuB;QACnBlC,OAAO,CAACK,KAAR,CAAcsD,GAAG,IAAI;UACjBA,GAAG,CAACC,cAAJ;UACAD,GAAG,CAAC7C,eAAJ;;UAEA,KAAK+C,sBAAL,CAA4BF,GAA5B,EAAiCzB,iBAAjC,EAC4BlC,OAD5B;QAEH,CAND;MAOH;IACJ;;IAEDA,OAAO,CAACX,QAAR,CAAiB,0CAAjB;;IAEA,IAAIU,MAAM,CAACqB,EAAX,EAAe;MACXpB,OAAO,CAACX,QAAR,CAAkB,4BAA2BU,MAAM,CAACqB,EAAG,EAAvD;IACH;;IAED,IAAIrB,MAAM,CAAC+D,MAAX,EAAmB;MACf9D,OAAO,CAACX,QAAR,CAAiB,YAAjB;IACH;;IAED,IAAIU,MAAM,CAACgE,OAAX,EAAoB;MAChB/D,OAAO,CAACX,QAAR,CAAiB,aAAjB;IACH;;IAED,IAAI,CAAC7B,OAAL,EAAc;MACVwC,OAAO,CAACgE,IAAR,CAAa,UAAb,EAAyB,IAAzB;IACH;;IAED,OAAO1B,OAAP;EACH,CA/X8C;;EAiY/C;AACJ;AACA;AACA;AACA;AACA;EACIxD,mBAAmB,GAAG;IAClB,MAAMf,KAAK,GAAG,KAAKA,KAAnB;IACA,MAAMkG,YAAY,GAAGlG,KAAK,CAACmG,QAAN,CAAe,WAAf,CAArB;IACA,MAAMC,SAAS,GAAGpG,KAAK,CAACqG,GAAN,CAAU,WAAV,CAAlB;;IAEA,IAAIH,YAAJ,EAAkB;MACd,KAAK3F,GAAL,CAAS+F,WAAT,CAAqB,KAAK/G,gBAAL,CAAsB2G,YAAtB,CAArB;IACH;;IAED,IAAIE,SAAJ,EAAe;MACX,KAAK7F,GAAL,CAASe,QAAT,CAAkB,KAAK/B,gBAAL,CAAsB6G,SAAtB,CAAlB;MAEA;AACZ;AACA;AACA;;MACY,KAAKvF,WAAL,CAAiB+D,IAAjB,CAAsB5E,KAAK,CAACuG,cAAN,CAAqBH,SAArB,CAAtB;IACH;EACJ,CAzZ8C;;EA2Z/C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIN,sBAAsB,CAACF,GAAD,EAAMzB,iBAAN,EAAyBlC,OAAzB,EAAkC;IACpD,MAAMuE,OAAO,GAAG,KAAKrC,iBAAL,EAAwB/C,IAAxB,CAA6B,IAA7B,EAAmCwE,GAAnC,CAAhB;;IAEA,IAAIY,OAAO,IAAI,OAAOA,OAAO,CAACC,IAAf,KAAwB,UAAvC,EAAmD;MAC/CxE,OAAO,CAACgE,IAAR,CAAa,UAAb,EAAyB,IAAzB;MAEA,MAAMS,YAAY,GAAGzE,OAAO,CAAC0E,IAAR,EAArB;MACA1E,OAAO,CAACzB,KAAR;MAEA,MAAMF,QAAQ,GAAGQ,CAAC,CAAC,kCAAD,CAAD,CACZqB,QADY,CACHF,OADG,CAAjB;MAGA;AACZ;AACA;AACA;;MACYuE,OAAO,CAACI,OAAR,CAAgB,MAAM;QAClBtG,QAAQ,CAACF,MAAT;QACA6B,OAAO,CAAC0E,IAAR,CAAaD,YAAb;QACAzE,OAAO,CAACgE,IAAR,CAAa,UAAb,EAAyB,KAAzB;MACH,CAJD;IAKH;EACJ;;AAnc8C,CAArB,CAA9B"}