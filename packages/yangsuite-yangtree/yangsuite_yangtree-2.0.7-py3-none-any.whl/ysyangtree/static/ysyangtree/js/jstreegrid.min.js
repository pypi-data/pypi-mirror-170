(function(d){"function"===typeof define&&define.amd?define(["jquery","jstree"],d):d(jQuery)})(function(d){var qa=/^\s*$/g,ra=/[\\:&!^|()\[\]<>@*'+~#";,= \/${}%]/g,ia=!1,O=function(w,r){return"jstree_"+w+"_grid_"+(r||"").replace(ra,"\\$&")+"_col"},ja=function(w){return d.makeArray(w.map(function(){return this.id}))},z=function(w,r,G,a){void 0==a&&(a=d());if(null===r||void 0===r||0===r.length)return a;var b=d(),c=[].concat(G);if("string"===typeof r){var e=O(w,r);b=c.map(function(f){return"#"+e+f}).join(", ")}else b=
[],r.forEach(function(f,m){var g=O(w,f);b=b.concat(c.map(function(u){return"#"+g+u}))}),b=b.join(", ");return 1==c.length?a.find(b):d(b)},V=!1,J=null,aa=0,ba=0,ka=/<\/?[^>]+>/gi,la=function(w,r,G,a,b){var c;a.data=d.extend(!0,{},r.data);if(r&&r.children_d&&b){var e=0;for(c=r.children_d.length;e<c;e++)la(w,w.get_node(r.children_d[e]),G,G.get_node(a.children_d[e]),b)}},ma=function(w,r){var G=w.get_node(r),a=G.children;return!a||0>=a.length||!G.state.opened?r:ma(w,a[a.length-1])},sa=function(w,r,G){w=
w.hasClass("jstree-anchor")?w:w.children("[class~='jstree-anchor']");var a=G.settings.grid.columns[0];var b="";a.title&&("_DATA_"===a.title?b=G.get_text(r):r.attr(a.title)&&(b=r.attr(a.title)));(b=b.replace(ka,""))&&w.attr("title",b)},ca=function(w,r){return void 0!==w&&null!==w?"function"===typeof w?w(r):null!==r.data&&void 0!==r.data&&void 0!==r.data[w]?r.data[w]:"":""};d.jstree.defaults.grid={width:"auto"};d.jstree.plugins.grid=function(w,r){function G(){function a(){return Math.floor(65536*(1+
Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}this._initialize=function(){if(!this._initialized){var a=this.settings.grid||{},b=this.element,c=this._gridSettings={columns:a.columns||[],treeClass:"jstree-grid-col-0",context:a.contextmenu||!1,columnWidth:a.columnWidth,defaultConf:{"*display":"inline","*+display":"inline"},isThemeroller:!!this._data.themeroller,treeWidthDiff:0,resizable:a.resizable,draggable:a.draggable,stateful:a.stateful,indent:0,
sortOrder:"text",sortAsc:!0,caseInsensitive:a.caseInsensitive,fixedHeader:!1!==a.fixedHeader,width:a.width,height:a.height,gridcontextmenu:a.gridcontextmenu,treecol:0,gridcols:[]},e=c.columns,f=0,m=!1;!0===c.gridcontextmenu?c.gridcontextmenu=function(A,n,p,y,v,F,H){return{edit:{label:"Edit",action:function(K){K=F.get_node(p);A._edit(K,v,H)}}}}:!1===c.gridcontextmenu&&(c.gridcontextmenu=!1);var g=0;for(var u=a.columns.length;g<u;g++)a.columns[g].tree?(f=g,c.treecol=f):c.gridcols.push(g);this.uniq=
Math.ceil(1E3*Math.random());this.rootid=b.attr("id");/msie/.test(navigator.userAgent.toLowerCase())&&8>parseFloat(navigator.appVersion.split("MSIE")[1])&&(c.defaultConf.display="inline",c.defaultConf.zoom="1");ia||(ia=!0,g=".jstree-grid-cell {vertical-align: top; overflow:hidden;margin-left:0;position:relative;width: 100%;padding-left:7px;white-space: nowrap;},.jstree-grid-cell span {margin-right:0px;margin-right:0px;*display:inline;*+display:inline;white-space: nowrap;},.jstree-grid-separator {position:absolute; top:0; right:0; height:24px; margin-left: -2px; border-width: 0 2px 0 0; *display:inline; *+display:inline; margin-right:0px;width:0px;},.jstree-grid-header-cell {overflow: hidden; white-space: nowrap;padding: 1px 3px 2px 5px; cursor: default;},.jstree-grid-header-themeroller {border: 0; padding: 1px 3px;},.jstree-grid-header-regular {position:relative; background-color: #EBF3FD; z-index: 1;},.jstree-grid-hidden {display: none;},.jstree-grid-resizable-separator {cursor: col-resize; width: 2px;},.jstree-grid-separator-regular {border-color: #d0d0d0; border-style: solid;},.jstree-grid-cell-themeroller {border: none !important; background: transparent !important;},.jstree-grid-wrapper {table-layout: fixed; width: 100%; overflow: auto; position: relative;},.jstree-grid-midwrapper {display: table-row;},.jstree-grid-width-auto {width:auto;display:block;},.jstree-grid-column {display: table-cell; overflow: hidden;},.jstree-grid-ellipsis {text-overflow: ellipsis;},.jstree-grid-col-0 {width: 100%;}".split(","),
d('<style type="text/css">'+g.join("\n")+"</style>").appendTo("head"));this.gridWrapper=d("<div></div>").addClass("jstree-grid-wrapper").insertAfter(b);this.midWrapper=d("<div></div>").addClass("jstree-grid-midwrapper").appendTo(this.gridWrapper);a.width&&this.gridWrapper.width(a.width);a.height&&this.gridWrapper.height(a.height);g=0;for(u=e.length;g<u;g++)d("<div></div>").addClass("jstree-default jstree-grid-column jstree-grid-column-"+g+" jstree-grid-column-root-"+this.rootid).appendTo(this.midWrapper);
this.midWrapper.children("div:eq("+f+")").append(b);b.addClass("jstree-grid-cell");c.fixedHeader&&this.gridWrapper.scroll(function(){d(this).find(".jstree-grid-header").css("top",d(this).scrollTop())});var q=d.proxy(this.settings.sort,this);this.settings.sort=function(A,n){var p=this.colrefs;if("text"===c.sortOrder){var y=this.get_text(A).toLowerCase().localeCompare(this.get_text(n).toLowerCase());y=c.caseInsensitive?1===y:1===q(A,n)}else{var v=this.get_node(A),F=this.get_node(n);p=p[c.sortOrder].value;
v="function"===typeof p?p(v):v.data[p];F="function"===typeof p?p(F):F.data[p];typeof v&&"undefined"!==typeof F&&(y=c.caseInsensitive?v.toLowerCase()>F.toLowerCase():v>F)}c.sortAsc||(y=!y);return y?1:-1};if(c.draggable)if(d.ui&&d.ui.sortable){var B,L;d(this.midWrapper).sortable({axis:"x",handle:".jstree-grid-header",cancel:".jstree-grid-separator",start:function(A,n){B=n.item.index()},stop:function(A,n){L=n.item.index();c.columns.splice(L,0,c.columns.splice(B,1)[0])}})}else console.warn("[jstree-grid] draggable option requires jQuery UI");
this.searchColumn=function(A){var n={};if("object"==typeof A)for(var p in A)A.hasOwnProperty(p)&&0===p%1&&p<e.length&&0<=p&&(n[p]=A[p]);m=n;0!==Object.keys(n).length?this.search("someValue"):this.search("");m=!1};g=0;for(u=e.length;g<u;g++)a=e[g],"function"!==typeof a.search_callback&&(a.search_callback=function(A,n,p,y){return(new d.vakata.search(A,!0,{caseSensitive:t.case_sensitive,fuzzy:t.fuzzy})).search(n).isMatch});var t=this.settings.search,C=t.search_callback;C||(C=function(A,n){var p=new d.vakata.search(A,
!0,{caseSensitive:t.case_sensitive,fuzzy:t.fuzzy}),y=p.search(n.text).isMatch;if(!y){var v=0;for(var F=e.length;v<F&&!(f!==v&&(y=e[v],y=p.search(ca(y.value,n)).isMatch));v++);}return y});t.search_callback=function(A,n){var p=!1;if(m){for(var y in m)if(m.hasOwnProperty(y)){var v=m[y];if(""!=v&&(p=e[y],p=f==y?p.search_callback(v,n.text,n,p):p.search_callback(v,ca(p.value,n),n,p),!p))break}b.trigger("columnSearch_grid.jstree")}else p=C(A,n),b.trigger("omniSearch_grid.jstree");return p};this._initialized=
!0}};this.init=function(a,b){r.init.call(this,a,b);this._initialize()};this.bind=function(){r.bind.call(this);this._initialize();this.element.on("move_node.jstree create_node.jstree clean_node.jstree change_node.jstree",d.proxy(function(a,b){var c=this.get_node(b||"#",!0),e=G();this._detachColumns(e);this._prepare_grid(c);this._reattachColumns(e)},this)).on("delete_node.jstree",d.proxy(function(a,b){if(void 0!==b.node.id){var c=[b.node.id];b.node&&b.node.children_d&&(c=c.concat(b.node.children_d));
z(this.uniq,c,this._gridSettings.gridcols).remove()}},this)).on("show_node.jstree",d.proxy(function(a,b){this._hideOrShowTree(b.node,!1)},this)).on("hide_node.jstree",d.proxy(function(a,b){this._hideOrShowTree(b.node,!0)},this)).on("close_node.jstree",d.proxy(function(a,b){this._hide_grid(b.node)},this)).on("open_node.jstree",d.proxy(function(a,b){},this)).on("load_node.jstree",d.proxy(function(a,b){},this)).on("loaded.jstree",d.proxy(function(a){this._prepare_headers();this.element.trigger("loaded_grid.jstree")},
this)).on("ready.jstree",d.proxy(function(a,b){var c=this.element.find("[class~='jstree-anchor']:first").outerHeight(),e=this.element.attr("class")||"";d('<style type="text/css">div.jstree-grid-cell-root-'+this.rootid+" {line-height: "+c+"px; height: "+c+"px;}</style>").appendTo("head");c=e.split(/\s+/).map(function(f){return f.match(/^jstree(-|$)/)?"":f});this.gridWrapper.addClass(c.join(" "))},this)).on("move_node.jstree",d.proxy(function(a,b){b.new_instance.element.find("li > a").each(d.proxy(function(c,
e){},this))},this)).on("hover_node.jstree",d.proxy(function(a,b,c){a=b.node.id;null!==this._hover_node&&void 0!==this._hover_node&&z(this.uniq,this._hover_node,this._gridSettings.gridcols).removeClass("jstree-hovered");this._hover_node=a;z(this.uniq,a,this._gridSettings.gridcols).addClass("jstree-hovered")},this)).on("dehover_node.jstree",d.proxy(function(a,b,c){a=b.node.id;this._hover_node=null;z(this.uniq,a,this._gridSettings.gridcols).removeClass("jstree-hovered")},this)).on("select_node.jstree",
d.proxy(function(a,b,c){z(this.uniq,b.node.id,this._gridSettings.gridcols).addClass("jstree-clicked");this.get_node(b.node.id,!0).children("div.jstree-grid-cell").addClass("jstree-clicked")},this)).on("deselect_node.jstree",d.proxy(function(a,b,c){z(this.uniq,b.node.id,this._gridSettings.gridcols).removeClass("jstree-clicked")},this)).on("deselect_all.jstree",d.proxy(function(a,b,c){z(this.uniq,b.node||[],this._gridSettings.gridcols).removeClass("jstree-clicked")},this)).on("search.jstree",d.proxy(function(a,
b){var c=this.gridWrapper,e=this,f,m=(new Date).getTime(),g=ja(b.nodes.filter(".jstree-node"));this.holdingCells={};if(b.nodes.length){var u=G();c=c.find("div.jstree-grid-cell-regular");this._detachColumns(u);this._data.search.som&&(this._data.search.smc&&(f=b.nodes.add(b.nodes.find(".jstree-node"))),f=(f||b.nodes).add(b.nodes.parentsUntil(".jstree")),c.hide(),f.filter(".jstree-node").each(function(q,B){var L=B.id;if(L){e._prepare_grid(B);q=0;for(var t=e._gridSettings.gridcols.length;q<t;q++)q!==
e._gridSettings.treecol&&z(e.uniq,L,e._gridSettings.gridcols[q],d(e._domManipulation.columns[q])).show()}}));f=0;for(c=this._gridSettings.gridcols.length;f<c;f++)f!==this._gridSettings.treecol&&z(e.uniq,g,this._gridSettings.gridcols[f],d(this._domManipulation.columns[f])).addClass("jstree-search");this._reattachColumns(u);g=(new Date).getTime();this.element.trigger("search-complete.jstree-grid",[{time:g-m}])}return!0},this)).on("clear_search.jstree",d.proxy(function(a,b){var c=this.gridWrapper,e=
ja(b.nodes.filter(".jstree-node"));c.find("div.jstree-grid-cell").show();z(this.uniq,e,this._gridSettings.gridcols).removeClass("jstree-search");return!0},this)).on("copy_node.jstree",function(a,b){var c=b.new_instance,e=b.old_instance,f=c.get_node(b.node,!0);la(e,b.original,c,b.node,!0);c._detachColumns(f.id);c._prepare_grid(f);c._reattachColumns(f.id);return!0}).on("show_ellipsis.jstree",d.proxy(function(a,b){this.gridWrapper.find(".jstree-grid-cell").add(".jstree-grid-header",this.gridWrapper).addClass("jstree-grid-ellipsis");
return!0},this)).on("hide_ellipsis.jstree",d.proxy(function(a,b){this.gridWrapper.find(".jstree-grid-cell").add(".jstree-grid-header",this.gridWrapper).removeClass("jstree-grid-ellipsis");return!0},this)).on("enable_node.jstree",d.proxy(function(a,b){var c=b.node.id;if(this._domManipulation)for(var e=0,f=this._gridSettings.gridcols.length;e<f;e++)e!==this._gridSettings.treecol&&z(this.uniq,c,this._gridSettings.gridcols[e],d(this._domManipulation.columns[e])).removeClass("jstree-disabled");else z(this.uniq,
c,this._gridSettings.gridcols).removeClass("jstree-disabled"),this.get_node(b.node.id,!0).children("div.jstree-grid-cell").removeClass("jstree-disabled")},this)).on("disable_node.jstree",d.proxy(function(a,b){var c=b.node.id;if(this._domManipulation)for(var e=0,f=this._gridSettings.gridcols.length;e<f;e++)e!==this._gridSettings.treecol&&z(this.uniq,c,this._gridSettings.gridcols[e],d(this._domManipulation.columns[e])).addClass("jstree-disabled");else z(this.uniq,c,this._gridSettings.gridcols).addClass("jstree-disabled"),
this.get_node(b.node.id,!0).children("div.jstree-grid-cell").addClass("jstree-disabled")},this));if(this._gridSettings.isThemeroller)this.element.on("select_node.jstree",d.proxy(function(a,b){b.rslt.obj.children("[class~='jstree-anchor']").nextAll("div").addClass("ui-state-active")},this)).on("deselect_node.jstree deselect_all.jstree",d.proxy(function(a,b){b.rslt.obj.children("[class~='jstree-anchor']").nextAll("div").removeClass("ui-state-active")},this)).on("hover_node.jstree",d.proxy(function(a,
b){b.rslt.obj.children("[class~='jstree-anchor']").nextAll("div").addClass("ui-state-hover")},this)).on("dehover_node.jstree",d.proxy(function(a,b){b.rslt.obj.children("[class~='jstree-anchor']").nextAll("div").removeClass("ui-state-hover")},this));if(this._gridSettings.stateful)this.element.on("resize_column.jstree-grid",d.proxy(function(a,b,c){localStorage["jstree-root-"+this.rootid+"-column-"+b]=c},this))};this.teardown=function(){var a=this.gridWrapper,b=this.element,c=a.parent();b.detach();a.remove();
c.append(b);r.teardown.call(this)};this._clean_grid=function(a,b){var c=this.gridWrapper;a?z(this.uniq,b,this._gridSettings.gridcols).remove():c.find("div.jstree-grid-cell-regular").remove()};this._prepare_headers=function(){var a=this,b=this._gridSettings,c=b.columns||[],e=b.columnWidth,f=b.resizable||!1,m=b.isThemeroller,g=m?"themeroller":"regular",u=!1,q=this.rootid,B=b.defaultConf,L=0,t=0;this.parent=this.gridparent;this.colrefs={};var C=0;for(var A=c.length;C<A;C++){var n=c[C].headerClass||"";
var p=c[C].columnClass||"";var y=c[C].header||"";do var v=String(Math.floor(1E4*Math.random()));while(void 0!==this.colrefs[v]);var F=c[C].value?v:"text";this.colrefs[F]=c[C];y&&(u=!0);var H=b.stateful&&localStorage["jstree-root-"+q+"-column-"+C]?localStorage["jstree-root-"+q+"-column-"+C]:c[C].width||e;var K=c[C].minWidth||H,da=c[C].maxWidth||H;L=m?7:10;"auto"!==H&&"string"!==typeof H&&(H-=L);v=this.midWrapper.children("div.jstree-grid-column-"+C);n=d("<div></div>").css(B).addClass("jstree-grid-div-"+
this.uniq+"-"+C+" "+(m?"ui-widget-header ":"")+" jstree-grid-header jstree-grid-header-cell jstree-grid-header-"+g+" "+n+" "+p).html(y);n.addClass((m?"ui-widget-header ":"")+"jstree-grid-header jstree-grid-header-"+g);!0===this.settings.core.themes.ellipsis&&n.addClass("jstree-grid-ellipsis");n.prependTo(v);n.attr("data-jstreegrid-column",F);t+=n.outerWidth();d("<div class='jstree-grid-separator jstree-grid-separator-"+g+(m?" ui-widget-header":"")+(f?" jstree-grid-resizable-separator":"")+"'>&nbsp;</div>").appendTo(n);
v.width(H);v.css("min-width",K);v.css("max-width",da)}n.addClass((m?"ui-widget-header ":"")+"jstree-grid-header jstree-grid-header-last jstree-grid-header-"+g);void 0===c[c.length-1].width&&(t-=H,v.css({width:"auto"}),n.addClass("jstree-grid-width-auto").next(".jstree-grid-separator").remove());u?b.header=void 0:d("div.jstree-grid-header").hide();!this.bound&&f&&(this.bound=!0,d(document).mouseup(function(){if(V){var h=J.prevAll(".jstree-grid-column").length;var k=J.closest(".jstree-grid-wrapper").find(".jstree");
var D=d.jstree.reference(k);J.parent().children("div.jstree-grid-column");if(isNaN(h)||0>h)D._gridSettings.treeWidthDiff=k.find("ins:eq(0)").width()+k.find("[class~='jstree-anchor']:eq(0)").width()-D._gridSettings.columns[0].width;D=D._gridSettings.columns[h].width=parseFloat(J.css("width"));V=!1;J=null;k.trigger("resize_column.jstree-grid",[h,D])}}).mousemove(function(h){if(V){ba=h.pageX;h=ba-aa;var k;if(0!==h){var D=J.width();(k=parseFloat(J.css("width")))||(k=J.innerWidth());h=0>h?Math.max(h,-D):
h;k+=h;(0<h||0<D)&&10<k&&(J.width(k+"px"),J.css("min-width",k+"px"),J.css("max-width",k+"px"),aa=ba)}}}),this.gridWrapper.on("selectstart",".jstree-grid-resizable-separator",function(){return!1}).on("mousedown",".jstree-grid-resizable-separator",function(h){V=!0;aa=h.pageX;J=d(this).closest("div.jstree-grid-column");return!1}).on("dblclick",".jstree-grid-resizable-separator",function(h){h=d(this).closest("div.jstree-grid-column");var k=parseFloat(h.css("width")),D=0,W=h.prevAll(".jstree-grid-column").length,
E=h.width();h.find(".jstree-grid-cell").each(function(){var Q=d(this);Q.css("position","absolute");Q.css("width","auto");var X=Q.outerWidth();Q.css("position","relative");X>D&&(D=X)});var I=D-k;I=0>I?Math.max(I,-E):I;k=k+I+"px";h.width(k);h.css("min-width",k);h.css("max-width",k);d(this).closest(".jstree-grid-wrapper").find(".jstree").trigger("resize_column.jstree-grid",[W,k])}).on("click",".jstree-grid-separator",function(h){h.stopPropagation()}));this.gridWrapper.on("click",".jstree-grid-header-cell",
function(h){a.sort&&(h=d(this).attr("data-jstreegrid-column"),b.sortOrder===h&&!0===b.sortAsc?(b.sortAsc=!1,h="&darr;"):(b.sortOrder=h,b.sortAsc=!0,h="&uarr;"),d(this.closest(".jstree-grid-wrapper")).find(".jstree-grid-sort-icon").remove(),d("<span></span>").addClass("jstree-grid-sort-icon").appendTo(d(this)).html(h),h=a.get_node("#"),a.sort(h,!0),a.redraw_node(h,!0))})};this._domManipulation=null;this._detachColumns=function(a){if(null==this._domManipulation){var b=this._gridSettings.columns||[],
c=this.midWrapper;this._domManipulation={id:a,columns:{}};a=0;for(b=b.length;a<b;a++)this._domManipulation.columns[a]=c.children(".jstree-grid-column-"+a)[0],this._domManipulation.columns[a].parentNode.removeChild(this._domManipulation.columns[a])}return this._domManipulation};this._reattachColumns=function(a){if(null==this._domManipulation)return!1;if(this._domManipulation.id===a){a=this.midWrapper;for(var b=0,c=(this._gridSettings.columns||[]).length;b<c;b++)a[0].appendChild(this._domManipulation.columns[b]);
this._domManipulation=null}return!0};this.open_node=function(a,b,c){var e=d.isArray(a),f=null;if(!e&&(f=this.get_node(a),"#"===f.id))return;e=e?G():f.id;this._detachColumns(e);a=r.open_node.call(this,a,b,c);this._reattachColumns(e);return a};this.redraw_node=function(a,b,c,e){var f=d.isArray(a)?G():this.get_node(a).id;this._detachColumns(f);(a=r.redraw_node.call(this,a,b,c,e))&&this._prepare_grid(a);this._reattachColumns(f);return a};this.refresh=function(){this._clean_grid();return r.refresh.apply(this,
arguments)};this.set_id=function(a,b){var c=this.uniq;if(a)var e=a.id;var f=r.set_id.apply(this,arguments);if(f&&void 0!==e){var m=[e];a&&a.children_d&&(m=m.concat(a.children_d));z(c,m,this._gridSettings.gridcols).attr("data-jstreegrid",a.id).removeClass(O(c,e)).addClass(O(c,a.id)).each(function(g,u){d(u).attr("id",O(c,a.id)+(g+1))})}return f};this._hideOrShowTree=function(a,b){this._detachColumns(a.id);this._hideOrShowNode(a,b,this._gridSettings.columns||[],this._gridSettings.treecol);this._reattachColumns(a.id)};
this._hideOrShowNode=function(a,b,c,e){for(var f=0,m=c.length;f<m;f++)if(f!==e){var g=z(this.uniq,a.id,f,d(this._domManipulation.columns[f]));b?g.addClass("jstree-grid-hidden"):g.removeClass("jstree-grid-hidden")}if(a.state.opened&&a.children)for(f=0,m=a.children.length;f<m;f++)this._hideOrShowNode(this.get_node(a.children[f]),b,c,e)};this._hide_grid=function(a){if(!a)return!0;this._detachColumns(a.id);for(var b=a.children?a.children:[],c=this._gridSettings.columns||[],e=this._gridSettings.treecol,
f=0,m=b.length;f<m;f++){for(var g=this.get_node(b[f]),u=0,q=c.length;u<q;u++)u!==e&&z(this.uniq,g.id,u,d(this._domManipulation.columns[u])).remove();g.state.opened&&this._hide_grid(g)}this._reattachColumns(a.id)};this.holdingCells={};this.getHoldingCells=function(a,b,c){if(a.state.hidden||!a.state.opened)return d();var e=d();a=a.children||[];var f,m=this.uniq;for(f=0;f<a.length;f++){var g=O(m,a[f])+b;c[g]&&(e=e.add(c[g]).add(this.getHoldingCells(this.get_node(a[f]),b,c)))}return e};this._edit=function(a,
b,c){if(!a)return!1;a.data||(a.data={});if(c)c=d(c),"div"===c.prop("tagName").toLowerCase()&&(c=c.children("span:first"));else return!1;var e=this._data.core.rtl,f=this.element.width(),m=a.data[b.value],g=d("<div />",{css:{position:"absolute",top:"-200px",left:e?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),u=d("<input />",{value:m,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",
lineHeight:this._data.core.li_height+"px",width:"150px"},blur:d.proxy(function(){var q=u.val();""!==q&&q!==m&&(a.data[b.value]=q,this.element.trigger("update_cell.jstree-grid",{node:a,col:b.value,value:q,old:m}),q=G(),this._detachColumns(q),this._prepare_grid(this.get_node(a,!0)),this._reattachColumns(q));u.remove();c.show()},this),keydown:function(q){var B=q.which;27===B&&(this.value=m);27!==B&&13!==B&&37!==B&&38!==B&&39!==B&&40!==B&&32!==B||q.stopImmediatePropagation();if(27===B||13===B)q.preventDefault(),
this.blur()},click:function(q){q.stopImmediatePropagation()},mousedown:function(q){q.stopImmediatePropagation()},keyup:function(q){u.width(Math.min(g.text("pW"+this.value).width(),f))},keypress:function(q){if(13===q.which)return!1}});e={fontFamily:c.css("fontFamily")||"",fontSize:c.css("fontSize")||"",fontWeight:c.css("fontWeight")||"",fontStyle:c.css("fontStyle")||"",fontStretch:c.css("fontStretch")||"",fontVariant:c.css("fontVariant")||"",letterSpacing:c.css("letterSpacing")||"",wordSpacing:c.css("wordSpacing")||
""};c.hide();c.parent().append(u);u.css(e).width(Math.min(g.text("pW"+u[0].value).width(),f))[0].select()};this.grid_hide_column=function(a){this.midWrapper.find(".jstree-grid-column-"+a).hide()};this.grid_show_column=function(a){this.midWrapper.find(".jstree-grid-column-"+a).show()};this._prepare_grid=function(a){var b=this._gridSettings,c=b.treeClass,e=this,f=b.columns||[],m=b.isThemeroller,g=this.uniq,u=b.treecol,q=this.element,B=this.rootid,L=m?"themeroller":"regular",t=this.get_node(a),C=b.columnWidth,
A=b.defaultConf,n=function(P,N,ea,Y,na){return function(R){var oa=jQuery.Event("select_cell.jstree-grid");P.trigger(oa,[{value:ea,column:Y.header,node:N,grid:d(this),sourceName:Y.value}]);oa.isDefaultPrevented()||N.children(".jstree-anchor").trigger("click.jstree",R)}},p=function(P,N,ea,Y,na){return function(R){b.gridcontextmenu&&(R.preventDefault(),d.vakata.context.show(this,{x:R.pageX,y:R.pageY},b.gridcontextmenu(e,P,N,ea,Y,na,R.target)))}},y=function(P,N){return function(){N.hover_node(P)}},v=
function(P,N){return function(){N.dehover_node(P)}},F,H,K,da=this.midWrapper,h=t.id;var k=this.get_node(t.parent).children;var D=d.inArray(h,k);var W=this.holdingCells;var E=!1;a=d(a);var I=a.children("[class~='jstree-anchor']");var Q=I.hasClass("jstree-search");var X=I.hasClass("jstree-clicked");if(1===I.length){var fa=O(g,h);var pa="#"===t.parent?null:t.parent;I.addClass(c);sa(I,a,e);var l=I;c=0>=D?t.parent:ma(this,k[D-1]);var ta=D>=k.length-1?"NULL":k[D+1];var ua=t.children&&0<t.children.length?
t.children[0]:"NULL";k=0;for(var va=f.length;k<va;k++)if(u!==k){var x=f[k];E=null==this._domManipulation?da.children("div:eq("+k+")"):d(this._domManipulation.columns[k]);D=x.cellClass||"";I=x.wideCellClass||"";var M=x.columnClass||"";E.addClass(M);M=ca(x.value,t);"function"===typeof x.format&&(M=x.format(M));x.images?(l=x.images[M]||x.images["default"])&&(K="*"===l[0]?'<span class="'+l.substr(1)+'"></span>':'<img src="'+l+'">'):K=M;if(void 0===K||null===K||qa.test(K))K="&nbsp;";(F=x.valueClass&&null!==
t.data&&void 0!==t.data?t.data[x.valueClass]||"":"")&&x.valueClassPrefix&&""!==x.valueClassPrefix&&(F=x.valueClassPrefix+F);(H=x.wideValueClass&&null!==t.data&&void 0!==t.data?t.data[x.wideValueClass]||"":"")&&x.wideValueClassPrefix&&""!==x.wideValueClassPrefix&&(H=x.wideValueClassPrefix+H);var Z=x.title&&null!==t.data&&void 0!==t.data?t.data[x.title]||"":"";Z=Z.replace(ka,"");l=x.width||C;"auto"!==l&&(l-=7);l=z(g,h,k,E);if(!l||1>l.length)l=d("<div></div>"),d("<span></span>").appendTo(l),l.attr("id",
fa+k),l.addClass(fa),l.attr("data-jstreegrid",h),Q?l.addClass("jstree-search"):l.removeClass("jstree-search"),X?l.addClass("jstree-clicked"):l.removeClass("jstree-clicked"),!0===this.settings.core.themes.ellipsis&&k!==u&&l.addClass("jstree-grid-ellipsis");t.state.hidden?l.addClass("jstree-grid-hidden"):l.removeClass("jstree-grid-hidden");t.state.disabled?l.addClass("jstree-disabled"):l.removeClass("jstree-disabled");var S=z(g,c,k,E);var T=z(g,ta,k,E);var U=z(g,ua,k,E);var ha=z(g,pa,k,E);pa?(ha&&0<
ha.length?(S&&0<S.length?l.insertAfter(S):U&&0<U.length?l.insertBefore(U):T&&0<T.length?l.insertBefore(T):l.insertAfter(ha),E=!0):E=!1,W[fa+k]=l):(S&&0<S.length?l.insertAfter(S):U&&0<U.length?l.insertBefore(U):T&&0<T.length?l.insertBefore(T):l.appendTo(E),E=!0);E&&(E=this.getHoldingCells(t,k,W),l.after(E));E=l.children("span");E.addClass(D+" "+F).html(K);l=l.css(A).addClass("jstree-grid-cell jstree-grid-cell-regular jstree-grid-cell-root-"+B+" jstree-grid-cell-"+L+" "+I+" "+H+(m?" ui-state-default":
"")).addClass("jstree-grid-col-"+k).addClass("jstree-animated");l.click(n(q,a,M,x,this));l.on("contextmenu",p(q,a,M,x,this));l.hover(y(a,this),v(a,this));Z&&E.attr("title",Z);q.trigger("render_cell.jstree-grid",[{value:M,column:x.header,node:a,sourceName:x.value}])}l.addClass("jstree-grid-cell-last"+(m?" ui-state-default":""));void 0===f[f.length-1].width&&l.addClass("jstree-grid-width-auto").next(".jstree-grid-separator").remove()}this.element.css({"overflow-y":"auto !important"})};this.holdingCells=
{}}});