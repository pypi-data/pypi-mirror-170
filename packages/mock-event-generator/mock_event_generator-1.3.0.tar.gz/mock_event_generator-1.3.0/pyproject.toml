[build-system]
requires = [
    "setuptools>=61",
    "setuptools_scm[toml]>=6.2",
    "wheel",
]
build-backend = "setuptools.build_meta"

[project]
name = "mock_event_generator"
classifiers = [
    "Programming Language :: Python :: 3",
]
description = "Generates events by re-using existing ones."
requires-python = ">=3.9"
dependencies = [
    "apischema",
    "astropy",
    "certifi",
    "cryptography",
    "ligo-gracedb<2.8.0",  # Basic auth has been removed in 2.8.0
    "ligo-skymap",
    "lxml",
    "python-ligo-lw",
    "requests",
    "trio",
    "typer[all]",
]
dynamic = ["version"]

[project.optional-dependencies]
tests = [
    "lalsuite",
    "pytest",
    "pytest-cov",
    "pytest-gracedb >= 0.7.2",
    "pytest-mock",
    "pytest-socket",
    "pytest-trio",
    "pytest-freezegun",
    "responses",
    "setuptools_scm[toml]",
]

[project.scripts]
meg = "mock_event_generator.cli:meg"

[tool.coverage.report]
exclude_lines = [
    "pragma: no cover",
    "except ImportError:",
    "raise NotImplementedError",
    "if typing.TYPE_CHECKING:",
]
show_missing = true
skip_covered = true

[tool.isort]
known_first_party = ["ligo", "mock_event_generator", "pytest_gracedb"]

[[tool.mypy.overrides]]
module = [
    "astropy.*",
    "lal",
    "ligo.gracedb.*",
    "ligo.lw.*",
    "ligo.skymap.*",
]
ignore_missing_imports = true

[tool.pytest.ini_options]
addopts = "-ra -q --cov=mock_event_generator --disable-socket --allow-unix-socket"
filterwarnings = [
    'ignore:distutils Version classes are deprecated:DeprecationWarning',
    'ignore:No x509 credentials found:UserWarning',
    'ignore:Authentication credentials not found:UserWarning',
]
testpaths = [
    "tests",
]
trio_mode = true

[tool.setuptools.packages.find]
include = ["mock_event_generator*"]

[tool.setuptools_scm]
version_scheme = "post-release"
fallback_version = "0.0.0"
