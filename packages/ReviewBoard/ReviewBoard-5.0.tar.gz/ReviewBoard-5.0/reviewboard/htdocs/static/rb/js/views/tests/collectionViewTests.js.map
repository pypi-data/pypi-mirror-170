{"version":3,"file":"collectionViewTests.js","names":["suite","collection","view","TestModel","Backbone","Model","extend","defaults","_","data","TestCollection","Collection","model","TestModelView","View","className","render","$el","text","get","TestCollectionView","RB","CollectionView","itemViewType","beforeEach","describe","it","expect","children","length","toBe","add","$children","innerHTML","hasClass","$container","$","appendTo","$viewChildren","$containerChildren","eq","model1","model2","model3","remove","reset","self","spyOn","and","callThrough","comparator","sort","_addCollectionViews","toHaveBeenCalled","not"],"sources":["../../../../../../static/rb/js/views/tests/collectionViewTests.es6.js"],"sourcesContent":["suite('rb/views/CollectionView', function() {\n    let collection;\n    let view;\n\n    const TestModel = Backbone.Model.extend({\n        defaults: _.defaults({\n            data: '',\n        }),\n    });\n\n    const TestCollection = Backbone.Collection.extend({\n        model: TestModel,\n    });\n\n    const TestModelView = Backbone.View.extend({\n        className: 'test-class',\n        render() {\n            this.$el.text(this.model.get('data'));\n            return this;\n        },\n    });\n\n    const TestCollectionView = RB.CollectionView.extend({\n        itemViewType: TestModelView,\n    });\n\n    beforeEach(function() {\n        collection = new TestCollection();\n        view = new TestCollectionView({\n            collection: collection,\n        });\n    });\n\n    describe('Rendering', function() {\n        it('When empty', function() {\n            view.render();\n            expect(view.$el.children().length).toBe(0);\n        });\n\n        it('With items', function() {\n            collection.add([\n                { data: 'Item 1' },\n                { data: 'Item 2' },\n            ]);\n\n            view.render();\n            const $children = view.$el.children();\n            expect($children.length).toBe(2);\n            expect($children[0].innerHTML).toBe('Item 1');\n            expect($children[1].innerHTML).toBe('Item 2');\n        });\n\n        it('Item model type', function() {\n            collection.add([\n                { data: 'Item 1' },\n            ]);\n\n            view.render();\n            expect(view.$el.children().hasClass('test-class')).toBe(true);\n        });\n\n        it('With custom element container', function() {\n            const $container = $('<div class=\"rb-test-main-container\"/>')\n                .appendTo(view.$el);\n\n            view.$container = $container;\n\n            collection.add([\n                { data: 'Item 1' },\n                { data: 'Item 2' },\n            ]);\n\n            view.render();\n\n            const $viewChildren = view.$el.children();\n            expect($viewChildren.length).toBe(1);\n            expect($viewChildren[0].className).toBe('rb-test-main-container');\n\n            const $containerChildren = $viewChildren.eq(0).children();\n            expect($containerChildren.length).toBe(2);\n            expect($containerChildren[0].innerHTML).toBe('Item 1');\n            expect($containerChildren[1].innerHTML).toBe('Item 2');\n        });\n    });\n\n    describe('Live updating', function() {\n        it('Adding items after rendering', function() {\n            collection.add([\n                { data: 'Item 1' },\n            ]);\n\n            view.render();\n\n            expect(view.$el.children().length).toBe(1);\n\n            collection.add([\n                { data: 'Item 2' },\n                { data: 'Item 3' },\n            ]);\n\n            const $children = view.$el.children();\n            expect($children.length).toBe(3);\n            expect($children[2].innerHTML).toBe('Item 3');\n        });\n\n        it('Removing items after rendering', function() {\n            const model1 = new TestModel({ data: 'Item 1' });\n            const model2 = new TestModel({ data: 'Item 2' });\n            const model3 = new TestModel({ data: 'Item 3' });\n            collection.add([model1, model2, model3]);\n\n            view.render();\n\n            expect(view.$el.children().length).toBe(3);\n\n            collection.remove([model1, model3]);\n\n            const $children = view.$el.children();\n            expect($children.length).toBe(1);\n            expect($children[0].innerHTML).toBe('Item 2');\n        });\n\n        it('When reset', function() {\n            collection.add([\n                { data: 'Item 1' },\n                { data: 'Item 2' },\n            ]);\n\n            view.render();\n\n            let $children = view.$el.children();\n            expect($children.length).toBe(2);\n            expect($children[0].innerHTML).toBe('Item 1');\n            expect($children[1].innerHTML).toBe('Item 2');\n\n            collection.reset([\n                { data: 'Item 3' },\n                { data: 'Item 4' },\n                { data: 'Item 5' },\n            ]);\n\n            $children = view.$el.children();\n            expect($children.length).toBe(3);\n            expect($children[0].innerHTML).toBe('Item 3');\n            expect($children[1].innerHTML).toBe('Item 4');\n            expect($children[2].innerHTML).toBe('Item 5');\n        });\n\n        describe('Sorting', function() {\n            it('With order changed', function() {\n                collection.add([\n                    { data: 'Item 2' },\n                    { data: 'Item 3' },\n                    { data: 'Item 1' },\n                ]);\n\n                view.render();\n\n                let $children = view.$el.children();\n                expect($children.length).toBe(3);\n                expect($children[0].innerHTML).toBe('Item 2');\n                expect($children[1].innerHTML).toBe('Item 3');\n                expect($children[2].innerHTML).toBe('Item 1');\n\n                self.spyOn(view, '_addCollectionViews').and.callThrough();\n\n                collection.comparator = 'data';\n                collection.sort();\n\n                $children = view.$el.children();\n                expect($children[0].innerHTML).toBe('Item 1');\n                expect($children[1].innerHTML).toBe('Item 2');\n                expect($children[2].innerHTML).toBe('Item 3');\n\n                expect(view._addCollectionViews).toHaveBeenCalled();\n            });\n\n            it('With order unchanged', function() {\n                collection.add([\n                    { data: 'Item 1' },\n                    { data: 'Item 2' },\n                    { data: 'Item 3' },\n                ]);\n\n                view.render();\n\n                let $children = view.$el.children();\n                expect($children.length).toBe(3);\n                expect($children[0].innerHTML).toBe('Item 1');\n                expect($children[1].innerHTML).toBe('Item 2');\n                expect($children[2].innerHTML).toBe('Item 3');\n\n                collection.comparator = 'data';\n                collection.sort();\n\n                self.spyOn(view, '_addCollectionViews').and.callThrough();\n\n                $children = view.$el.children();\n                expect($children[0].innerHTML).toBe('Item 1');\n                expect($children[1].innerHTML).toBe('Item 2');\n                expect($children[2].innerHTML).toBe('Item 3');\n\n                expect(view._addCollectionViews).not.toHaveBeenCalled();\n            });\n        });\n    });\n});\n"],"mappings":"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"}