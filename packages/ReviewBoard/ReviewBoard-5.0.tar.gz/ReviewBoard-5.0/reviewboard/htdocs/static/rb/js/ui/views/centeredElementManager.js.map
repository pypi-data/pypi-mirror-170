{"version":3,"file":"centeredElementManager.js","names":["RB","CenteredElementManager","Backbone","View","extend","initialize","options","_elements","elements","Map","_$window","$","window","_updatePositionThrottled","_","throttle","updatePosition","on","remove","prototype","call","off","setElements","size","windowTop","scrollTop","windowHeight","height","windowBottom","forEach","containers","el","$el","$topContainer","$top","$bottomContainer","$bottom","containerTop","offset","top","containerBottom","css","position","left","Math","round","outerHeight","max","bottom","min","elTop"],"sources":["../../../../../../static/rb/js/ui/views/centeredElementManager.es6.js"],"sourcesContent":["/**\n * A view which ensures that the specified elements are vertically centered.\n */\nRB.CenteredElementManager = Backbone.View.extend({\n    /**\n     * Initialize the view.\n     *\n     * Args:\n     *     options (object):\n     *         Options passed to this view.\n     *\n     * Option Args:\n     *     elements (Array, optional):\n     *         An initial array of elements to center.\n     */\n    initialize(options={}) {\n        this._elements = options.elements || new Map();\n        this._$window = $(window);\n\n        this._updatePositionThrottled = _.throttle(() => this.updatePosition(),\n                                                   10);\n\n        this._$window.on('resize', this._updatePositionThrottled);\n        this._$window.on('scroll', this._updatePositionThrottled);\n    },\n\n    /**\n     * Remove the CenteredElementManager.\n     *\n     * This will result in the event handlers being removed.\n     */\n    remove() {\n        Backbone.View.prototype.remove.call(this);\n\n        this._$window.off('resize', this._updatePositionThrottled);\n        this._$window.off('scroll', this._updatePositionThrottled);\n    },\n\n    /**\n     * Set the elements and their containers.\n     *\n     * Args:\n     *     elements (Map<Element, Element or jQuery>):\n     *         The elements to center within their respective containers.\n     */\n    setElements(elements) {\n        this._elements = elements;\n    },\n\n    /**\n     * Update the position of the elements.\n     *\n     * This should only be done when the set of elements changed, as the view\n     * will handle updating on window resizing and scrolling.\n     */\n    updatePosition() {\n        if (this._elements.size === 0) {\n            return;\n        }\n\n        const windowTop = this._$window.scrollTop();\n        const windowHeight = this._$window.height();\n        const windowBottom = windowTop + windowHeight;\n\n        this._elements.forEach((containers, el) => {\n            const $el = $(el);\n            const $topContainer = containers.$top;\n            const $bottomContainer = containers.$bottom || $topContainer;\n            const containerTop = $topContainer.offset().top;\n            const containerBottom = $bottomContainer.offset().top +\n                                    $bottomContainer.height();\n\n            /*\n             * We don't have to vertically center the element when its\n             * container is not on screen.\n             */\n            if (containerTop < windowBottom && containerBottom > windowTop) {\n                /*\n                 * When a container takes up the entire viewport, we can switch\n                 * the CSS to use position: fixed. This way, we do not have to\n                 * re-compute its position.\n                 */\n                if (windowTop >= containerTop &&\n                    windowBottom <= containerBottom) {\n                    if ($el.css('position') !== 'fixed') {\n                        $el.css({\n                            position: 'fixed',\n                            left: $el.offset().left,\n                            top: Math.round(\n                                (windowHeight - $el.outerHeight()) / 2),\n                        });\n                    }\n                } else {\n                    const top = Math.max(windowTop, containerTop);\n                    const bottom = Math.min(windowBottom, containerBottom);\n                    const elTop = top - containerTop + Math.round(\n                        (bottom - top - $el.outerHeight()) / 2);\n\n                    $el.css({\n                        position: 'absolute',\n                        left: '',\n                        top: elTop,\n                    });\n                }\n            }\n        });\n    },\n});\n"],"mappings":"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"}