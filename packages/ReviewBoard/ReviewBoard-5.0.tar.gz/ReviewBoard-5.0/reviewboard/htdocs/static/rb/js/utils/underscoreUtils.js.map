{"version":3,"file":"underscoreUtils.js","names":["_","bindCallbacks","callbacks","context","methodNames","wrappedCallbacks","key","value","Object","entries","includes","isFunction","bind","defaults","deferred","func","defer","throttleLayout","layoutFunc","options","handlingLayout","args","arguments","cb","apply","requestAnimationFrame","window","_super","obj","getPrototypeOf"],"sources":["../../../../../static/rb/js/utils/underscoreUtils.es6.js"],"sourcesContent":["/**\n * Bind callbacks to a context.\n *\n * Backbone.js's various ajax-related functions don't take a context\n * with their callbacks. This allows us to wrap these callbacks to ensure\n * we always have a desired context.\n *\n * Args:\n *     callbacks (object):\n *         An object which potentially includes callback functions.\n *\n *     context (any type):\n *         The context to bind to the callbacks.\n *\n *     methodNames (Array of string):\n *         An array of method names within ``callbacks`` to bind.\n *\n * Returns:\n *     object:\n *     A copy of the ``callbacks`` object, with the given ``methodNames`` bound\n *     to ``context``.\n */\n_.bindCallbacks = function(callbacks, context,\n                           methodNames=['success', 'error', 'complete']) {\n    if (!context) {\n        return callbacks;\n    }\n\n    const wrappedCallbacks = {};\n\n    for (let [key, value] of Object.entries(callbacks)) {\n        if (methodNames.includes(key) && _.isFunction(value)) {\n            wrappedCallbacks[key] = _.bind(value, context);\n        }\n    }\n\n    return _.defaults(wrappedCallbacks, callbacks);\n};\n\n\n/**\n * Return a function that will be called when the call stack has unwound.\n *\n * This will return a function that calls the provided function using\n * :js:func:`_.defer`.\n *\n * Args:\n *     func (function):\n *         The function to call.\n *\n * Returns:\n *     function:\n *     The wrapper function.\n */\n_.deferred = function(func) {\n    return () => {\n        _.defer(func);\n    };\n};\n\n\n/**\n * Return a function suitable for efficiently handling page layout.\n *\n * The returned function will use :js:func:`window.requestAnimationFrame` to\n * schedule the layout call. Once this function called, any subsequent calls\n * will be ignored until the first call has finished the layout work.\n *\n * Optionally, this can also defer layout work until the call stack has unwound.\n *\n * This is intended to be used as a resize event handler.\n *\n * Args:\n *     layoutFunc (function):\n *         The function to call to perform layout.\n *\n *     options (object):\n *         Options for the layout callback.\n *\n * Option Args:\n *     defer (boolean):\n *         If ``true``, the layout function will be called when the call stack\n *         has unwound after the next scheduled layout call.\n */\n_.throttleLayout = function(layoutFunc, options={}) {\n    let handlingLayout = false;\n\n    /*\n     * We don't want to use a fat arrow function here, since we need the\n     * caller's context to be preserved.\n     */\n    return function() {\n        if (handlingLayout) {\n            return;\n        }\n\n        const context = this;\n        const args = arguments;\n\n        handlingLayout = true;\n\n        let cb = () => {\n            layoutFunc.apply(context, args);\n            handlingLayout = false;\n        };\n\n        if (options.defer) {\n            cb = _.deferred(cb);\n        }\n\n        requestAnimationFrame(cb);\n    };\n};\n\n\n/*\n * Return the parent prototype for an object.\n *\n * Args:\n *     obj (object):\n *         An object.\n *\n * Returns:\n *     object:\n *     The object which is the parent prototype for the given ``obj``. This is\n *     roughly equivalent to what you'd get from ES6's ``super``.\n */\nwindow._super = function(obj) {\n    return Object.getPrototypeOf(Object.getPrototypeOf(obj));\n};\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAA,CAAC,CAACC,aAAF,GAAkB,UAASC,SAAT,EAAoBC,OAApB,EACuD;EAAA,IAA9CC,WAA8C,uEAAlC,CAAC,SAAD,EAAY,OAAZ,EAAqB,UAArB,CAAkC;;EACrE,IAAI,CAACD,OAAL,EAAc;IACV,OAAOD,SAAP;EACH;;EAED,MAAMG,gBAAgB,GAAG,EAAzB;;EAEA,KAAK,IAAI,CAACC,GAAD,EAAMC,KAAN,CAAT,IAAyBC,MAAM,CAACC,OAAP,CAAeP,SAAf,CAAzB,EAAoD;IAChD,IAAIE,WAAW,CAACM,QAAZ,CAAqBJ,GAArB,KAA6BN,CAAC,CAACW,UAAF,CAAaJ,KAAb,CAAjC,EAAsD;MAClDF,gBAAgB,CAACC,GAAD,CAAhB,GAAwBN,CAAC,CAACY,IAAF,CAAOL,KAAP,EAAcJ,OAAd,CAAxB;IACH;EACJ;;EAED,OAAOH,CAAC,CAACa,QAAF,CAAWR,gBAAX,EAA6BH,SAA7B,CAAP;AACH,CAfD;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAF,CAAC,CAACc,QAAF,GAAa,UAASC,IAAT,EAAe;EACxB,OAAO,MAAM;IACTf,CAAC,CAACgB,KAAF,CAAQD,IAAR;EACH,CAFD;AAGH,CAJD;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAf,CAAC,CAACiB,cAAF,GAAmB,UAASC,UAAT,EAAiC;EAAA,IAAZC,OAAY,uEAAJ,EAAI;EAChD,IAAIC,cAAc,GAAG,KAArB;EAEA;AACJ;AACA;AACA;;EACI,OAAO,YAAW;IACd,IAAIA,cAAJ,EAAoB;MAChB;IACH;;IAED,MAAMjB,OAAO,GAAG,IAAhB;IACA,MAAMkB,IAAI,GAAGC,SAAb;IAEAF,cAAc,GAAG,IAAjB;;IAEA,IAAIG,EAAE,GAAG,MAAM;MACXL,UAAU,CAACM,KAAX,CAAiBrB,OAAjB,EAA0BkB,IAA1B;MACAD,cAAc,GAAG,KAAjB;IACH,CAHD;;IAKA,IAAID,OAAO,CAACH,KAAZ,EAAmB;MACfO,EAAE,GAAGvB,CAAC,CAACc,QAAF,CAAWS,EAAX,CAAL;IACH;;IAEDE,qBAAqB,CAACF,EAAD,CAArB;EACH,CApBD;AAqBH,CA5BD;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAG,MAAM,CAACC,MAAP,GAAgB,UAASC,GAAT,EAAc;EAC1B,OAAOpB,MAAM,CAACqB,cAAP,CAAsBrB,MAAM,CAACqB,cAAP,CAAsBD,GAAtB,CAAtB,CAAP;AACH,CAFD"}