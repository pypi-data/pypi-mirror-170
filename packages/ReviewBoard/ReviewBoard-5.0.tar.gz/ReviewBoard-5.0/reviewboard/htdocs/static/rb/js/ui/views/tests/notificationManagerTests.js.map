{"version":3,"file":"notificationManagerTests.js","names":["suite","instance","RB","NotificationManager","origNotification","Notification","title","options","close","requestPermission","permission","beforeEach","UserSession","set","setup","expect","toBe","afterEach","describe","it","notify","body","notification","_notification","not","_canNotify","spyOn","and","returnValue","shouldNotify"],"sources":["../../../../../../../static/rb/js/ui/views/tests/notificationManagerTests.es6.js"],"sourcesContent":["suite('rb/ui/managers/NotificationManagerModel', function() {\n    const instance = RB.NotificationManager.instance;\n    let origNotification;\n\n    const Notification = function(title, options) {\n        this.title = title;\n        this.options = options;\n        this.close = function() {};\n    };\n    Notification.requestPermission = function() {\n        Notification.permission = 'granted';\n    };\n\n    beforeEach(function() {\n        origNotification = RB.NotificationManager.Notification;\n        RB.NotificationManager.Notification = Notification;\n\n        RB.UserSession.instance.set('enableDesktopNotifications', true);\n\n        instance.setup();\n\n        expect(Notification.permission).toBe('granted');\n    });\n\n    afterEach(function() {\n        RB.NotificationManager.Notification = origNotification;\n    });\n\n    describe('Notification Manager', function() {\n        it('Calls external API', function() {\n            instance.notify({\n                title: 'Test',\n                body: 'This is a test',\n            });\n\n            const notification = instance._notification;\n            expect(notification).not.toBe(null);\n            expect(notification.title).toBe('Test');\n            expect(notification.options.body).toBe('This is a test');\n        });\n\n        it('Should notify', function() {\n            instance._canNotify = true;\n            spyOn(instance, '_haveNotificationPermissions')\n                .and.returnValue(true);\n\n            expect(instance.shouldNotify()).toBe(true);\n        });\n\n\n        it('Should not notify due to user permissions', function() {\n            instance._canNotify = false;\n            spyOn(instance, '_haveNotificationPermissions')\n                .and.returnValue(true);\n\n            expect(instance.shouldNotify()).toBe(false);\n        });\n\n         it('Should not notify due to browser permissions', function() {\n            instance._canNotify = true;\n            spyOn(instance, '_haveNotificationPermissions')\n                .and.returnValue(false);\n\n            expect(instance.shouldNotify()).toBe(false);\n        });\n    });\n});\n"],"mappings":";;AAAAA,KAAK,CAAC,yCAAD,EAA4C,YAAW;EACxD,MAAMC,QAAQ,GAAGC,EAAE,CAACC,mBAAH,CAAuBF,QAAxC;EACA,IAAIG,gBAAJ;;EAEA,MAAMC,YAAY,GAAG,UAASC,KAAT,EAAgBC,OAAhB,EAAyB;IAC1C,KAAKD,KAAL,GAAaA,KAAb;IACA,KAAKC,OAAL,GAAeA,OAAf;;IACA,KAAKC,KAAL,GAAa,YAAW,CAAE,CAA1B;EACH,CAJD;;EAKAH,YAAY,CAACI,iBAAb,GAAiC,YAAW;IACxCJ,YAAY,CAACK,UAAb,GAA0B,SAA1B;EACH,CAFD;;EAIAC,UAAU,CAAC,YAAW;IAClBP,gBAAgB,GAAGF,EAAE,CAACC,mBAAH,CAAuBE,YAA1C;IACAH,EAAE,CAACC,mBAAH,CAAuBE,YAAvB,GAAsCA,YAAtC;IAEAH,EAAE,CAACU,WAAH,CAAeX,QAAf,CAAwBY,GAAxB,CAA4B,4BAA5B,EAA0D,IAA1D;IAEAZ,QAAQ,CAACa,KAAT;IAEAC,MAAM,CAACV,YAAY,CAACK,UAAd,CAAN,CAAgCM,IAAhC,CAAqC,SAArC;EACH,CATS,CAAV;EAWAC,SAAS,CAAC,YAAW;IACjBf,EAAE,CAACC,mBAAH,CAAuBE,YAAvB,GAAsCD,gBAAtC;EACH,CAFQ,CAAT;EAIAc,QAAQ,CAAC,sBAAD,EAAyB,YAAW;IACxCC,EAAE,CAAC,oBAAD,EAAuB,YAAW;MAChClB,QAAQ,CAACmB,MAAT,CAAgB;QACZd,KAAK,EAAE,MADK;QAEZe,IAAI,EAAE;MAFM,CAAhB;MAKA,MAAMC,YAAY,GAAGrB,QAAQ,CAACsB,aAA9B;MACAR,MAAM,CAACO,YAAD,CAAN,CAAqBE,GAArB,CAAyBR,IAAzB,CAA8B,IAA9B;MACAD,MAAM,CAACO,YAAY,CAAChB,KAAd,CAAN,CAA2BU,IAA3B,CAAgC,MAAhC;MACAD,MAAM,CAACO,YAAY,CAACf,OAAb,CAAqBc,IAAtB,CAAN,CAAkCL,IAAlC,CAAuC,gBAAvC;IACH,CAVC,CAAF;IAYAG,EAAE,CAAC,eAAD,EAAkB,YAAW;MAC3BlB,QAAQ,CAACwB,UAAT,GAAsB,IAAtB;MACAC,KAAK,CAACzB,QAAD,EAAW,8BAAX,CAAL,CACK0B,GADL,CACSC,WADT,CACqB,IADrB;MAGAb,MAAM,CAACd,QAAQ,CAAC4B,YAAT,EAAD,CAAN,CAAgCb,IAAhC,CAAqC,IAArC;IACH,CANC,CAAF;IASAG,EAAE,CAAC,2CAAD,EAA8C,YAAW;MACvDlB,QAAQ,CAACwB,UAAT,GAAsB,KAAtB;MACAC,KAAK,CAACzB,QAAD,EAAW,8BAAX,CAAL,CACK0B,GADL,CACSC,WADT,CACqB,IADrB;MAGAb,MAAM,CAACd,QAAQ,CAAC4B,YAAT,EAAD,CAAN,CAAgCb,IAAhC,CAAqC,KAArC;IACH,CANC,CAAF;IAQCG,EAAE,CAAC,8CAAD,EAAiD,YAAW;MAC3DlB,QAAQ,CAACwB,UAAT,GAAsB,IAAtB;MACAC,KAAK,CAACzB,QAAD,EAAW,8BAAX,CAAL,CACK0B,GADL,CACSC,WADT,CACqB,KADrB;MAGAb,MAAM,CAACd,QAAQ,CAAC4B,YAAT,EAAD,CAAN,CAAgCb,IAAhC,CAAqC,KAArC;IACH,CANE,CAAF;EAOJ,CArCO,CAAR;AAsCH,CAlEI,CAAL"}