{"version":3,"file":"repositorySelectionView.js","names":["RB","RepositorySelectionView","CollectionView","extend","tagName","className","itemViewType","RepositoryView","template","_","events","initialize","prototype","apply","arguments","_selected","_searchActive","_onSearchChanged","throttle","bind","listenTo","collection","_onRepositorySelected","render","$el","html","repositoriesLabel","filterLabel","$container","$","_$searchBox","unselect","views","forEach","view","model","removeClass","trigger","item","addClass","searchTerm","val","toLowerCase","console","log","search"],"sources":["../../../../../../static/rb/js/newReviewRequest/views/repositorySelectionView.es6.js"],"sourcesContent":["/**\n * A view for selecting a repository from a collection.\n */\nRB.RepositorySelectionView = RB.CollectionView.extend({\n    tagName: 'ul',\n    className: 'rb-c-sidebar__items repository-selector',\n    itemViewType: RB.RepositoryView,\n\n    template: _.template(dedent`\n        <li class=\"rb-c-sidebar__section -no-icons\">\n         <header class=\"rb-c-sidebar__section-header\">\n          <%- repositoriesLabel %>\n         </header>\n         <ul class=\"rb-c-sidebar__items\">\n          <li class=\"rb-c-sidebar__item\">\n           <div class=\"rb-c-sidebar__item-label\">\n            <div class=\"rb-c-search-field\">\n             <span class=\"fa fa-search\"></span>\n             <input class=\"rb-c-search-field__input\"\n                    placeholder=\"<%- filterLabel %>\" />\n            </div>\n           </div>\n          </li>\n         </ul>\n         <ul class=\"rb-c-sidebar__items\n                    rb-c-new-review-request__repository-items\">\n        </li>\n    `),\n\n    events: {\n        'input .rb-c-search-field__input': '_onSearchChanged',\n    },\n\n    /**\n     * Initialize the view.\n     */\n    initialize() {\n        RB.CollectionView.prototype.initialize.apply(this, arguments);\n\n        this._selected = null;\n        this._searchActive = false;\n        this._onSearchChanged = _.throttle(this._onSearchChanged.bind(this), 100);\n\n        this.listenTo(this.collection, 'selected', this._onRepositorySelected);\n    },\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     RB.RepositorySelectionView:\n     *     This object, for chaining.\n     */\n    render() {\n        this.$el.html(this.template({\n            repositoriesLabel: gettext('Repositories'),\n            filterLabel: gettext('Filter'),\n        }));\n\n        this.$container = this.$('.rb-c-new-review-request__repository-items');\n\n        this._$searchBox = this.$('.rb-c-search-field__input');\n\n        RB.CollectionView.prototype.render.apply(this, arguments);\n\n        return this;\n    },\n\n    /**\n     * Unselect a repository.\n     */\n    unselect() {\n        this.views.forEach(view => {\n            if (view.model === this._selected) {\n                view.$el.removeClass('active');\n            }\n        });\n\n        this._selected = null;\n\n        this.trigger('selected', null);\n    },\n\n    /**\n     * Callback for when an individual repository is selected.\n     *\n     * Ensures that the selected repository has the 'selected' class applied\n     * (and no others do), and triggers the 'selected' event on the view.\n     *\n     * Args:\n     *     item (RB.Repository):\n     *         The selected repository;\n     */\n    _onRepositorySelected(item) {\n        this._selected = item;\n\n        this.views.forEach(view => {\n            if (view.model === item) {\n                view.$el.addClass('-is-active');\n            } else {\n                view.$el.removeClass('-is-active');\n            }\n        });\n\n        this.trigger('selected', item);\n    },\n\n    /**\n     * Callback for when the text in the search input changes.\n     *\n     * Filters the visible items.\n     */\n    _onSearchChanged() {\n        const searchTerm = this._$searchBox.val().toLowerCase();\n        console.log('search', searchTerm);\n        this.collection.search(searchTerm);\n    },\n});\n"],"mappings":";;AAAA;AACA;AACA;AACAA,EAAE,CAACC,uBAAH,GAA6BD,EAAE,CAACE,cAAH,CAAkBC,MAAlB,CAAyB;EAClDC,OAAO,EAAE,IADyC;EAElDC,SAAS,EAAE,yCAFuC;EAGlDC,YAAY,EAAEN,EAAE,CAACO,cAHiC;EAKlDC,QAAQ,EAAEC,CAAC,CAACD,QAAF,CAAkB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAjBc,CALwC;EA0BlDE,MAAM,EAAE;IACJ,mCAAmC;EAD/B,CA1B0C;;EA8BlD;AACJ;AACA;EACIC,UAAU,GAAG;IACTX,EAAE,CAACE,cAAH,CAAkBU,SAAlB,CAA4BD,UAA5B,CAAuCE,KAAvC,CAA6C,IAA7C,EAAmDC,SAAnD;IAEA,KAAKC,SAAL,GAAiB,IAAjB;IACA,KAAKC,aAAL,GAAqB,KAArB;IACA,KAAKC,gBAAL,GAAwBR,CAAC,CAACS,QAAF,CAAW,KAAKD,gBAAL,CAAsBE,IAAtB,CAA2B,IAA3B,CAAX,EAA6C,GAA7C,CAAxB;IAEA,KAAKC,QAAL,CAAc,KAAKC,UAAnB,EAA+B,UAA/B,EAA2C,KAAKC,qBAAhD;EACH,CAzCiD;;EA2ClD;AACJ;AACA;AACA;AACA;AACA;AACA;EACIC,MAAM,GAAG;IACL,KAAKC,GAAL,CAASC,IAAT,CAAc,KAAKjB,QAAL,CAAc;MACxBkB,iBAAiB,yBADO;MAExBC,WAAW;IAFa,CAAd,CAAd;IAKA,KAAKC,UAAL,GAAkB,KAAKC,CAAL,CAAO,4CAAP,CAAlB;IAEA,KAAKC,WAAL,GAAmB,KAAKD,CAAL,CAAO,2BAAP,CAAnB;IAEA7B,EAAE,CAACE,cAAH,CAAkBU,SAAlB,CAA4BW,MAA5B,CAAmCV,KAAnC,CAAyC,IAAzC,EAA+CC,SAA/C;IAEA,OAAO,IAAP;EACH,CA/DiD;;EAiElD;AACJ;AACA;EACIiB,QAAQ,GAAG;IACP,KAAKC,KAAL,CAAWC,OAAX,CAAmBC,IAAI,IAAI;MACvB,IAAIA,IAAI,CAACC,KAAL,KAAe,KAAKpB,SAAxB,EAAmC;QAC/BmB,IAAI,CAACV,GAAL,CAASY,WAAT,CAAqB,QAArB;MACH;IACJ,CAJD;IAMA,KAAKrB,SAAL,GAAiB,IAAjB;IAEA,KAAKsB,OAAL,CAAa,UAAb,EAAyB,IAAzB;EACH,CA9EiD;;EAgFlD;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIf,qBAAqB,CAACgB,IAAD,EAAO;IACxB,KAAKvB,SAAL,GAAiBuB,IAAjB;IAEA,KAAKN,KAAL,CAAWC,OAAX,CAAmBC,IAAI,IAAI;MACvB,IAAIA,IAAI,CAACC,KAAL,KAAeG,IAAnB,EAAyB;QACrBJ,IAAI,CAACV,GAAL,CAASe,QAAT,CAAkB,YAAlB;MACH,CAFD,MAEO;QACHL,IAAI,CAACV,GAAL,CAASY,WAAT,CAAqB,YAArB;MACH;IACJ,CAND;IAQA,KAAKC,OAAL,CAAa,UAAb,EAAyBC,IAAzB;EACH,CAtGiD;;EAwGlD;AACJ;AACA;AACA;AACA;EACIrB,gBAAgB,GAAG;IACf,MAAMuB,UAAU,GAAG,KAAKV,WAAL,CAAiBW,GAAjB,GAAuBC,WAAvB,EAAnB;;IACAC,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBJ,UAAtB;IACA,KAAKnB,UAAL,CAAgBwB,MAAhB,CAAuBL,UAAvB;EACH;;AAjHiD,CAAzB,CAA7B"}