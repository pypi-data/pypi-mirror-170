{"version":3,"file":"inlineFormViewTests.js","names":["suite","template","_","$el","model","view","beforeEach","$","index","RB","Admin","InlineForm","prefix","InlineFormView","el","render","describe","$delete","spyOn","window","and","returnValue","find","it","set","click","expect","confirm","not","toHaveBeenCalled","destroy","$labels","$inputs","$titleIndex","length","toBe","id","text","htmlFor","inputEl","name"],"sources":["../../../../../../../static/rb/js/admin/views/tests/inlineFormViewTests.es6.js"],"sourcesContent":["suite('rb/admin/views/InlineFormView', function() {\n    const template = _.template(dedent`\n        <div class=\"rb-c-admin-form-inline\">\n         <h3 class=\"rb-c-admin-form-inline__title\">\n          <span class=\"rb-c-admin-form-inline__title-prefix\"></span>\n          <span class=\"rb-c-admin-form-inline__title-object\"></span>\n          <span class=\"rb-c-admin-form-inline__title-index\"></span>\n          <span class=\"rb-c-admin-form-inline__actions\">\n           <span class=\"rb-c-admin-form-inline__delete-action\"></span>\n          </span>\n         </h3>\n         <fieldset>\n          <div>\n           <label for=\"id_myprefix-<%- index %>-foo\"></label>\n           <input id=\"id_myprefix-<%- index %>-foo\"\n                  name=\"myprefix-<%- index %>-foo\">\n          </div>\n          <div>\n           <label for=\"id_myprefix-<%- index %>-bar\"></label>\n           <input id=\"id_myprefix-<%- index %>-bar\"\n                  name=\"myprefix-<%- index %>-bar\">\n          </div>\n         </fieldset>\n        </div>\n    `);\n\n    let $el;\n    let model;\n    let view;\n\n    beforeEach(function() {\n        $el = $(template({\n            index: '__prefix__',\n        }));\n\n        model = new RB.Admin.InlineForm({\n            prefix: 'myprefix',\n        });\n\n        view = new RB.Admin.InlineFormView({\n            el: $el,\n            model: model,\n        });\n        view.render();\n    });\n\n    describe('Events', function() {\n        describe('Delete clicked', function() {\n            let $delete;\n\n            beforeEach(function() {\n                spyOn(window, 'confirm').and.returnValue(true);\n                spyOn(model, 'destroy');\n\n                $delete = $el.find('.rb-c-admin-form-inline__delete-action');\n            });\n\n            it('With isInitial=true', function() {\n                model.set('isInitial', true);\n\n                $delete.click();\n\n                expect(window.confirm).not.toHaveBeenCalled();\n                expect(model.destroy).not.toHaveBeenCalled();\n            });\n\n            it('With isInitial=false', function() {\n                model.set('isInitial', false);\n\n                $delete.click();\n\n                expect(window.confirm).toHaveBeenCalled();\n                expect(model.destroy).toHaveBeenCalled();\n            });\n        });\n\n        describe('Index changed', function() {\n            let $labels;\n            let $inputs;\n            let $titleIndex;\n\n            beforeEach(function() {\n                $labels = $el.find('label');\n                $inputs = $el.find('input');\n                $titleIndex = $el.find('.rb-c-admin-form-inline__title-index');\n\n                expect($labels.length).toBe(2);\n                expect($inputs.length).toBe(2);\n                expect($titleIndex.length).toBe(1);\n            });\n\n            it('From __prefix__ to index', function() {\n                model.set('index', 0);\n\n                expect($el[0].id).toBe('myprefix-0');\n                expect($titleIndex.text()).toBe('#1');\n\n                expect($labels[0].htmlFor).toBe('id_myprefix-0-foo');\n                expect($labels[1].htmlFor).toBe('id_myprefix-0-bar');\n\n                let inputEl = $inputs[0];\n                expect(inputEl.id).toBe('id_myprefix-0-foo');\n                expect(inputEl.name).toBe('myprefix-0-foo');\n\n                inputEl = $inputs[1];\n                expect(inputEl.id).toBe('id_myprefix-0-bar');\n                expect(inputEl.name).toBe('myprefix-0-bar');\n            });\n\n            it('From index to index', function() {\n                model.set('index', 0);\n                model.set('index', 1);\n\n                expect($el[0].id).toBe('myprefix-1');\n                expect($titleIndex.text()).toBe('#2');\n\n                expect($labels[0].htmlFor).toBe('id_myprefix-1-foo');\n                expect($labels[1].htmlFor).toBe('id_myprefix-1-bar');\n\n                let inputEl = $inputs[0];\n                expect(inputEl.id).toBe('id_myprefix-1-foo');\n                expect(inputEl.name).toBe('myprefix-1-foo');\n\n                inputEl = $inputs[1];\n                expect(inputEl.id).toBe('id_myprefix-1-bar');\n                expect(inputEl.name).toBe('myprefix-1-bar');\n            });\n        });\n    });\n});\n"],"mappings":"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"}