{"version":3,"file":"userSessionModelTests.js","names":["suite","describe","it","RB","UserSession","instance","session","create","username","expect","toBe","console","assert","toHaveBeenCalled","calls","argsFor","toBeTruthy","toThrow","toBeFalsy","beforeEach","spyOn","$","and","returnValue","cookie","toHaveBeenCalledWith","get","attributes","diffsShowExtraWhitespace","set","path","SITE_ROOT"],"sources":["../../../../../../static/rb/js/models/tests/userSessionModelTests.es6.js"],"sourcesContent":["suite('rb/models/UserSession', function() {\n    describe('create', function() {\n        it('Instance is set', function() {\n            RB.UserSession.instance = null;\n            const session = RB.UserSession.create({\n                username: 'testuser'\n            });\n\n            expect(session).toBe(RB.UserSession.instance);\n        });\n\n        it('Second attempt fails', function() {\n            RB.UserSession.instance = null;\n            RB.UserSession.create({\n                username: 'testuser'\n            });\n\n            expect(console.assert).toHaveBeenCalled();\n            expect(console.assert.calls.argsFor(0)[0]).toBeTruthy();\n\n            expect(() => RB.UserSession.create({ username: 'foo' })).toThrow();\n\n            expect(console.assert).toHaveBeenCalled();\n            expect(console.assert.calls.argsFor(1)[0]).toBeFalsy();\n        });\n    });\n\n    describe('Attributes', function() {\n        let session;\n\n        beforeEach(function() {\n            session = RB.UserSession.instance;\n        });\n\n        describe('diffsShowExtraWhitespace', function() {\n            describe('Loads from cookie', function() {\n                it('When \"true\"', function() {\n                    spyOn($, 'cookie').and.returnValue('true');\n\n                    RB.UserSession.instance = null;\n                    session = RB.UserSession.create({\n                        username: 'testuser'\n                    });\n\n                    expect($.cookie).toHaveBeenCalledWith('show_ew');\n                    expect(session.get('diffsShowExtraWhitespace')).toBe(true);\n                });\n\n                it('When \"false\"', function() {\n                    spyOn($, 'cookie').and.returnValue('false');\n\n                    RB.UserSession.instance = null;\n                    session = RB.UserSession.create({\n                        username: 'testuser'\n                    });\n\n                    expect($.cookie).toHaveBeenCalledWith('show_ew');\n                    expect(session.get('diffsShowExtraWhitespace')).toBe(false);\n                });\n            });\n\n            describe('Sets cookie', function() {\n                beforeEach(function() {\n                    spyOn($, 'cookie');\n                });\n\n                it('When true', function() {\n                    session.attributes.diffsShowExtraWhitespace = false;\n                    session.set('diffsShowExtraWhitespace', true);\n\n                    expect($.cookie).toHaveBeenCalledWith('show_ew', 'true', {\n                        path: SITE_ROOT\n                    });\n                });\n\n                it('When false', function() {\n                    session.attributes.diffsShowExtraWhitespace = true;\n                    session.set('diffsShowExtraWhitespace', false);\n\n                    expect($.cookie).toHaveBeenCalledWith('show_ew', 'false', {\n                        path: SITE_ROOT\n                    });\n                });\n            });\n        });\n    });\n});\n"],"mappings":"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"}