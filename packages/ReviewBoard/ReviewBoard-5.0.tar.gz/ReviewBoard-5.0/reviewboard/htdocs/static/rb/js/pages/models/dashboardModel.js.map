{"version":3,"file":"dashboardModel.js","names":["RB","Dashboard","DatagridPage","extend","rowObjectType","ReviewRequest","closeReviewRequests","options","reviewRequests","selection","clone","successes","failures","closeNext","length","reset","trigger","onDone","reviewRequest","shift","close","type","closeType","success","push","error","complete","bind","call","updateVisibility","visibilityFunc","hideNext","then","catch"],"sources":["../../../../../../static/rb/js/pages/models/dashboardModel.es6.js"],"sourcesContent":["/**\n * Models the dashboard and its operations.\n *\n * This will keep track of any selected review requests, and can\n * perform operations on them.\n */\nRB.Dashboard = RB.DatagridPage.extend({\n    rowObjectType: RB.ReviewRequest,\n\n    /**\n     * Close all selected review requests.\n     *\n     * This will keep track of all the successes and failures and report\n     * them back to the caller once completed.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the operation.\n     *\n     * Option Args:\n     *     closeType (string):\n     *         The close type to use (submitted or discarded).\n     *\n     *     onDone (function):\n     *         A function to call when the operation is complete.\n     */\n    closeReviewRequests(options) {\n        const reviewRequests = this.selection.clone();\n        const successes = [];\n        const failures = [];\n\n        function closeNext() {\n            if (reviewRequests.length === 0) {\n                this.selection.reset();\n                this.trigger('refresh');\n                options.onDone(successes, failures);\n                return;\n            }\n\n            const reviewRequest = reviewRequests.shift();\n\n            reviewRequest.close({\n                type: options.closeType,\n                success: () => successes.push(reviewRequest),\n                error: () => failures.push(reviewRequest),\n                complete: closeNext.bind(this),\n            });\n        }\n\n        closeNext.call(this);\n    },\n\n    /**\n     * Update the visibility of the selected review requests.\n     *\n     * This expects to be passed in a properly bound function (either\n     * addImmediately or removeImmediately) on either archivedReviewRequests or\n     * mutedReviewRequests. This will keep track of all the successes and\n     * failures, reporting them back to the caller.\n     *\n     * Args:\n     *     visibilityFunc (function):\n     *         The function to call for each review request.\n     */\n    updateVisibility(visibilityFunc) {\n        const reviewRequests = this.selection.clone();\n        const successes = [];\n        const failures = [];\n\n        function hideNext() {\n            if (reviewRequests.length === 0) {\n                this.selection.reset();\n                this.trigger('refresh');\n                return;\n            }\n\n            const reviewRequest = reviewRequests.shift();\n\n            visibilityFunc(reviewRequest)\n                .then(() => {\n                    successes.push(reviewRequest);\n                    hideNext.call(this);\n                })\n                .catch(() => {\n                    failures.push(reviewRequest);\n                    hideNext.call(this);\n                });\n        }\n\n        hideNext.call(this);\n    },\n});\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACAA,EAAE,CAACC,SAAH,GAAeD,EAAE,CAACE,YAAH,CAAgBC,MAAhB,CAAuB;EAClCC,aAAa,EAAEJ,EAAE,CAACK,aADgB;;EAGlC;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIC,mBAAmB,CAACC,OAAD,EAAU;IACzB,MAAMC,cAAc,GAAG,KAAKC,SAAL,CAAeC,KAAf,EAAvB;IACA,MAAMC,SAAS,GAAG,EAAlB;IACA,MAAMC,QAAQ,GAAG,EAAjB;;IAEA,SAASC,SAAT,GAAqB;MACjB,IAAIL,cAAc,CAACM,MAAf,KAA0B,CAA9B,EAAiC;QAC7B,KAAKL,SAAL,CAAeM,KAAf;QACA,KAAKC,OAAL,CAAa,SAAb;QACAT,OAAO,CAACU,MAAR,CAAeN,SAAf,EAA0BC,QAA1B;QACA;MACH;;MAED,MAAMM,aAAa,GAAGV,cAAc,CAACW,KAAf,EAAtB;MAEAD,aAAa,CAACE,KAAd,CAAoB;QAChBC,IAAI,EAAEd,OAAO,CAACe,SADE;QAEhBC,OAAO,EAAE,MAAMZ,SAAS,CAACa,IAAV,CAAeN,aAAf,CAFC;QAGhBO,KAAK,EAAE,MAAMb,QAAQ,CAACY,IAAT,CAAcN,aAAd,CAHG;QAIhBQ,QAAQ,EAAEb,SAAS,CAACc,IAAV,CAAe,IAAf;MAJM,CAApB;IAMH;;IAEDd,SAAS,CAACe,IAAV,CAAe,IAAf;EACH,CA5CiC;;EA8ClC;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIC,gBAAgB,CAACC,cAAD,EAAiB;IAC7B,MAAMtB,cAAc,GAAG,KAAKC,SAAL,CAAeC,KAAf,EAAvB;IACA,MAAMC,SAAS,GAAG,EAAlB;IACA,MAAMC,QAAQ,GAAG,EAAjB;;IAEA,SAASmB,QAAT,GAAoB;MAChB,IAAIvB,cAAc,CAACM,MAAf,KAA0B,CAA9B,EAAiC;QAC7B,KAAKL,SAAL,CAAeM,KAAf;QACA,KAAKC,OAAL,CAAa,SAAb;QACA;MACH;;MAED,MAAME,aAAa,GAAGV,cAAc,CAACW,KAAf,EAAtB;MAEAW,cAAc,CAACZ,aAAD,CAAd,CACKc,IADL,CACU,MAAM;QACRrB,SAAS,CAACa,IAAV,CAAeN,aAAf;QACAa,QAAQ,CAACH,IAAT,CAAc,IAAd;MACH,CAJL,EAKKK,KALL,CAKW,MAAM;QACTrB,QAAQ,CAACY,IAAT,CAAcN,aAAd;QACAa,QAAQ,CAACH,IAAT,CAAc,IAAd;MACH,CARL;IASH;;IAEDG,QAAQ,CAACH,IAAT,CAAc,IAAd;EACH;;AApFiC,CAAvB,CAAf"}