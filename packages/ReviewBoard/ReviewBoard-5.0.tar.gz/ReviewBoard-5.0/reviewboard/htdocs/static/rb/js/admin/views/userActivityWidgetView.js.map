{"version":3,"file":"userActivityWidgetView.js","names":["RB","Admin","UserActivityWidgetView","WidgetView","extend","template","_","renderWidget","$content","html","totalUsers","model","get","userTotalLabel","_$chart","$","_plotData","updateSize","now","sevenDays","thirtyDays","sixtyDays","ninetyDays","plot","data","label","interpolate","series","pie","show","radius","background","opacity","formatter","Math","round","percent","trigger"],"sources":["../../../../../../static/rb/js/admin/views/userActivityWidgetView.es6.js"],"sourcesContent":["/**\n * Displays stats on how often users have logged in or used Review Board.\n *\n * This is displayed as a pie graph, with a legend alongside it breaking\n * down the activity into 1-6 day, 7-29 day, 30-59 day, 60-89 day, and 90+\n * day ranges.\n */\nRB.Admin.UserActivityWidgetView = RB.Admin.WidgetView.extend({\n    template: _.template(dedent`\n        <div class=\"rb-c-admin-user-activity-widget__chart\"></div>\n        <div class=\"rb-c-admin-user-activity-widget__user-total\">\n         <%- userTotalLabel %>: <strong><%- totalUsers %></strong>\n        </div>\n    `),\n\n    /**\n     * Render the widget.\n     *\n     * This will build the basic structure of the widget's content and\n     * then plot the chart.\n     */\n    renderWidget() {\n        this.$content.html(this.template({\n            totalUsers: this.model.get('total'),\n            userTotalLabel: gettext('Total Users'),\n        }));\n\n        this._$chart = this.$('.rb-c-admin-user-activity-widget__chart');\n\n        this._plotData();\n    },\n\n    /**\n     * Handle updates to the size of the widget.\n     *\n     * This will re-render the chart for the new size.\n     */\n    updateSize() {\n        this._plotData();\n    },\n\n    /**\n     * Plot user activity into a chart.\n     */\n    _plotData() {\n        const model = this.model;\n        const now = model.get('now');\n        const sevenDays = model.get('sevenDays');\n        const thirtyDays = model.get('thirtyDays');\n        const sixtyDays = model.get('sixtyDays');\n        const ninetyDays = model.get('ninetyDays');\n\n        $.plot(\n            this._$chart,\n            [\n                {\n                    data: now,\n                    label: interpolate(gettext('Active (%s)'),\n                                       [now]),\n                },\n                {\n                    data: sevenDays,\n                    label: interpolate(gettext('7 days ago (%s)'),\n                                       [sevenDays]),\n                },\n                {\n                    data: thirtyDays,\n                    label: interpolate(gettext('30 days ago (%s)'),\n                                       [thirtyDays]),\n                },\n                {\n                    data: sixtyDays,\n                    label: interpolate(gettext('60 days ago (%s)'),\n                                       [sixtyDays]),\n                },\n                {\n                    data: ninetyDays,\n                    label: interpolate(gettext('90 days ago (%s)'),\n                                       [ninetyDays]),\n                },\n            ],\n            {\n                series: {\n                    pie: {\n                        show: true,\n                        label: {\n                            show: true,\n                            radius: 1,\n                            background: {\n                                opacity: 0.8,\n                            },\n                            formatter: (label, series) =>\n                                `<div>${Math.round(series.percent)}%</div>`,\n                        },\n                    },\n                },\n            }\n        );\n\n        this.trigger('sizeChanged');\n    },\n});\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACAA,EAAE,CAACC,KAAH,CAASC,sBAAT,GAAkCF,EAAE,CAACC,KAAH,CAASE,UAAT,CAAoBC,MAApB,CAA2B;EACzDC,QAAQ,EAAEC,CAAC,CAACD,QAAF,CAAkB;AAChC;AACA;AACA,OAHc,CAD+C;;EAQzD;AACJ;AACA;AACA;AACA;AACA;EACIE,YAAY,GAAG;IACX,KAAKC,QAAL,CAAcC,IAAd,CAAmB,KAAKJ,QAAL,CAAc;MAC7BK,UAAU,EAAE,KAAKC,KAAL,CAAWC,GAAX,CAAe,OAAf,CADiB;MAE7BC,cAAc;IAFe,CAAd,CAAnB;IAKA,KAAKC,OAAL,GAAe,KAAKC,CAAL,CAAO,yCAAP,CAAf;;IAEA,KAAKC,SAAL;EACH,CAvBwD;;EAyBzD;AACJ;AACA;AACA;AACA;EACIC,UAAU,GAAG;IACT,KAAKD,SAAL;EACH,CAhCwD;;EAkCzD;AACJ;AACA;EACIA,SAAS,GAAG;IACR,MAAML,KAAK,GAAG,KAAKA,KAAnB;IACA,MAAMO,GAAG,GAAGP,KAAK,CAACC,GAAN,CAAU,KAAV,CAAZ;IACA,MAAMO,SAAS,GAAGR,KAAK,CAACC,GAAN,CAAU,WAAV,CAAlB;IACA,MAAMQ,UAAU,GAAGT,KAAK,CAACC,GAAN,CAAU,YAAV,CAAnB;IACA,MAAMS,SAAS,GAAGV,KAAK,CAACC,GAAN,CAAU,WAAV,CAAlB;IACA,MAAMU,UAAU,GAAGX,KAAK,CAACC,GAAN,CAAU,YAAV,CAAnB;IAEAG,CAAC,CAACQ,IAAF,CACI,KAAKT,OADT,EAEI,CACI;MACIU,IAAI,EAAEN,GADV;MAEIO,KAAK,EAAEC,WAAW,yBACC,CAACR,GAAD,CADD;IAFtB,CADJ,EAMI;MACIM,IAAI,EAAEL,SADV;MAEIM,KAAK,EAAEC,WAAW,6BACC,CAACP,SAAD,CADD;IAFtB,CANJ,EAWI;MACIK,IAAI,EAAEJ,UADV;MAEIK,KAAK,EAAEC,WAAW,8BACC,CAACN,UAAD,CADD;IAFtB,CAXJ,EAgBI;MACII,IAAI,EAAEH,SADV;MAEII,KAAK,EAAEC,WAAW,8BACC,CAACL,SAAD,CADD;IAFtB,CAhBJ,EAqBI;MACIG,IAAI,EAAEF,UADV;MAEIG,KAAK,EAAEC,WAAW,8BACC,CAACJ,UAAD,CADD;IAFtB,CArBJ,CAFJ,EA6BI;MACIK,MAAM,EAAE;QACJC,GAAG,EAAE;UACDC,IAAI,EAAE,IADL;UAEDJ,KAAK,EAAE;YACHI,IAAI,EAAE,IADH;YAEHC,MAAM,EAAE,CAFL;YAGHC,UAAU,EAAE;cACRC,OAAO,EAAE;YADD,CAHT;YAMHC,SAAS,EAAE,CAACR,KAAD,EAAQE,MAAR,KACN,QAAOO,IAAI,CAACC,KAAL,CAAWR,MAAM,CAACS,OAAlB,CAA2B;UAPpC;QAFN;MADD;IADZ,CA7BJ;IA+CA,KAAKC,OAAL,CAAa,aAAb;EACH;;AA7FwD,CAA3B,CAAlC"}