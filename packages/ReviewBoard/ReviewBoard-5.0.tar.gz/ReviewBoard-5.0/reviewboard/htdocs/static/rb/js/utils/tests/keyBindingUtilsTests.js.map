{"version":3,"file":"keyBindingUtilsTests.js","names":["suite","describe","sendKeyPress","$el","keyCode","handled","evt","jQuery","Event","which","charCodeAt","trigger","expect","isDefaultPrevented","toBe","isPropagationStopped","it","MyView","Backbone","View","extend","keyBindings","_","prototype","RB","KeyBindingsMixin","spyOn","_view","delegateKeyBindings","toHaveBeenCalled","view","undelegateEvents","undelegateKeyBindings","myFunc1","myFunc2","render","appendTo","$testsScratch","not","abc","def"],"sources":["../../../../../../static/rb/js/utils/tests/keyBindingUtilsTests.es6.js"],"sourcesContent":["suite('rb/utils/keyBindingUtils', function() {\n    describe('KeyBindingsMixin', function() {\n        function sendKeyPress($el, keyCode, handled) {\n            const evt = jQuery.Event('keypress');\n            evt.which = keyCode.charCodeAt(0);\n            $el.trigger(evt);\n\n            expect(evt.isDefaultPrevented()).toBe(handled);\n            expect(evt.isPropagationStopped()).toBe(handled);\n        }\n\n        it('Registered on create', function() {\n            const MyView = Backbone.View.extend({\n                keyBindings: {},\n            });\n            _.extend(MyView.prototype, RB.KeyBindingsMixin);\n\n            spyOn(MyView.prototype, 'delegateKeyBindings');\n\n            this._view = new MyView();\n            expect(MyView.prototype.delegateKeyBindings).toHaveBeenCalled();\n        });\n\n        it('Unregistered on undelegateEvents', function() {\n            const MyView = Backbone.View.extend({\n                keyBindings: {},\n            });\n            _.extend(MyView.prototype, RB.KeyBindingsMixin);\n\n            const view = new MyView();\n            spyOn(MyView.prototype, 'undelegateKeyBindings');\n\n            view.undelegateEvents();\n            expect(MyView.prototype.undelegateKeyBindings).toHaveBeenCalled();\n        });\n\n        it('Keys to function name', function() {\n            const MyView = Backbone.View.extend({\n                keyBindings: {\n                    'abc': 'myFunc1',\n                    'def': 'myFunc2',\n                },\n\n                myFunc1: function() {},\n                myFunc2: function() {},\n            });\n            _.extend(MyView.prototype, RB.KeyBindingsMixin);\n\n            const view = new MyView();\n            view.render().$el.appendTo($testsScratch);\n\n            spyOn(view, 'myFunc1');\n            spyOn(view, 'myFunc2');\n\n            sendKeyPress(view.$el, 'e', true);\n\n            expect(view.myFunc1).not.toHaveBeenCalled();\n            expect(view.myFunc2).toHaveBeenCalled();\n        });\n\n        it('Keys to function', function() {\n            const MyView = Backbone.View.extend({\n                keyBindings: {\n                    'abc': function() {},\n                    'def': function() {},\n                }\n            });\n            _.extend(MyView.prototype, RB.KeyBindingsMixin);\n\n            const view = new MyView();\n            view.render().$el.appendTo($testsScratch);\n\n            spyOn(view.keyBindings, 'abc');\n            spyOn(view.keyBindings, 'def');\n\n            sendKeyPress(view.$el, 'b', true);\n\n            expect(view.keyBindings.abc).toHaveBeenCalled();\n            expect(view.keyBindings.def).not.toHaveBeenCalled();\n        });\n\n        it('Unmatched keys', function() {\n            const MyView = Backbone.View.extend({\n                keyBindings: {\n                    'abc': function() {},\n                    'def': function() {},\n                }\n            });\n            _.extend(MyView.prototype, RB.KeyBindingsMixin);\n\n            const view = new MyView();\n            view.render().$el.appendTo($testsScratch);\n\n            spyOn(view.keyBindings, 'abc');\n            spyOn(view.keyBindings, 'def');\n\n            sendKeyPress(view.$el, '!', false);\n\n            expect(view.keyBindings.abc).not.toHaveBeenCalled();\n            expect(view.keyBindings.def).not.toHaveBeenCalled();\n        });\n    });\n});\n"],"mappings":"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"}