{"version":3,"file":"paginationView.js","names":["RB","PaginationView","Backbone","View","extend","template","_","events","initialize","listenTo","model","render","$el","empty","html","defaults","splitText","interpolate","get","previousPageText","nextPageText","currentPageText","extraURLOptions","_buildExtraQueryString","pageText","attributes","queryString","window","location","search","parts","startsWith","substr","split","newParts","i","length","part","push","join","_onPageClicked","ev","page","$","currentTarget","data","undefined","trigger","stopPropagation","preventDefault"],"sources":["../../../../../../static/rb/js/diffviewer/views/paginationView.es6.js"],"sourcesContent":["/**\n * A view for selecting pages.\n */\nRB.PaginationView = Backbone.View.extend({\n    template: _.template(dedent`\n        <% if (isPaginated) { %>\n         <%- splitText %>\n         <% if (hasPrevious) { %>\n          <span class=\"paginate-link\" data-page=\"<%- previousPage %>\"><a href=\"?page=<%- previousPage %><%= extraURLOptions %>\" title=\"<%- previousPageText %>\">&lt;</a></span>\n         <% } %>\n         <% _.each(pageNumbers, function(page) { %>\n          <% if (page === currentPage) { %>\n           <span class=\"paginate-current\" title=\"<%- currentPageText %>\"><%- page %></span>\n          <% } else { %>\n           <span class=\"paginate-link\" data-page=\"<%- page %>\"><a href=\"?page=<%- page %><%= extraURLOptions %>\"\n               title=\"<% print(interpolate(pageText, [page])); %>\"\n               ><%- page %></a></span>\n          <% } %>\n         <% }); %>\n         <% if (hasNext) { %>\n          <span class=\"paginate-link\" data-page=\"<%- nextPage %>\"><a href=\"?page=<%- nextPage %><%= extraURLOptions %>\" title=\"<%- nextPageText %>\">&gt;</a></span>\n         <% } %>\n        <% } %>\n    `),\n\n    events: {\n        'click .paginate-link': '_onPageClicked',\n    },\n\n    /**\n     * Initialize the view.\n     */\n    initialize() {\n        this.listenTo(this.model, 'change', this.render);\n    },\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     RB.PaginationView:\n     *     This object, for chaining.\n     */\n    render() {\n        this.$el\n            .empty()\n            .html(this.template(_.defaults({\n                splitText: interpolate(\n                    gettext('This diff has been split across %s pages:'),\n                    [this.model.get('pages')]),\n                previousPageText: gettext('Previous Page'),\n                nextPageText: gettext('Next Page'),\n                currentPageText: gettext('Current Page'),\n                extraURLOptions: this._buildExtraQueryString(),\n                pageText: gettext('Page %s'),\n            }, this.model.attributes)));\n\n        return this;\n    },\n\n    /**\n     * Build the extra query string to tack onto any pagination links.\n     *\n     * This will take the current query string on the page, strip out the\n     * ``page=`` part, and return the resulting query string for use in\n     * any links.\n     *\n     * Returns:\n     *     string:\n     *     The new query string to tack onto an existing URL. This will come\n     *     with a leading ``&`` if there's content in the string.\n     */\n    _buildExtraQueryString() {\n        /*\n         * Ideally we'd use Djblets.parseQueryString() for most of this, but\n         * that doesn't maintain order (and it's perhaps not worth doing so).\n         * We need to keep the order so that we generate query strings that\n         * can be effectively cached by the browser in a reliable way.\n         */\n        let queryString = window.location.search || '';\n        let parts = [];\n\n        if (queryString.startsWith('?')) {\n            queryString = queryString.substr(1);\n        }\n\n        if (queryString) {\n            parts = queryString.split('&');\n            const newParts = [];\n\n            for (let i = 0; i < parts.length; i++) {\n                const part = parts[i];\n\n                if (!part.startsWith('page=')) {\n                    newParts.push(part);\n                }\n            }\n\n            if (newParts.length > 0) {\n                return '&' + newParts.join('&');\n            }\n        }\n\n        return '';\n    },\n\n    /**\n     * Callback for when a page number is clicked.\n     *\n     * Args:\n     *     ev (Event):\n     *         The click event.\n     */\n    _onPageClicked(ev) {\n        const page = $(ev.currentTarget).data('page');\n\n        if (page !== undefined) {\n            this.trigger('pageSelected', page);\n\n            ev.stopPropagation();\n            ev.preventDefault();\n        }\n    },\n});\n"],"mappings":";;AAAA;AACA;AACA;AACAA,EAAE,CAACC,cAAH,GAAoBC,QAAQ,CAACC,IAAT,CAAcC,MAAd,CAAqB;EACrCC,QAAQ,EAAEC,CAAC,CAACD,QAAF,CAAkB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAjBc,CAD2B;EAsBrCE,MAAM,EAAE;IACJ,wBAAwB;EADpB,CAtB6B;;EA0BrC;AACJ;AACA;EACIC,UAAU,GAAG;IACT,KAAKC,QAAL,CAAc,KAAKC,KAAnB,EAA0B,QAA1B,EAAoC,KAAKC,MAAzC;EACH,CA/BoC;;EAiCrC;AACJ;AACA;AACA;AACA;AACA;AACA;EACIA,MAAM,GAAG;IACL,KAAKC,GAAL,CACKC,KADL,GAEKC,IAFL,CAEU,KAAKT,QAAL,CAAcC,CAAC,CAACS,QAAF,CAAW;MAC3BC,SAAS,EAAEC,WAAW,uDAElB,CAAC,KAAKP,KAAL,CAAWQ,GAAX,CAAe,OAAf,CAAD,CAFkB,CADK;MAI3BC,gBAAgB,0BAJW;MAK3BC,YAAY,sBALe;MAM3BC,eAAe,yBANY;MAO3BC,eAAe,EAAE,KAAKC,sBAAL,EAPU;MAQ3BC,QAAQ;IARmB,CAAX,EASjB,KAAKd,KAAL,CAAWe,UATM,CAAd,CAFV;IAaA,OAAO,IAAP;EACH,CAvDoC;;EAyDrC;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIF,sBAAsB,GAAG;IACrB;AACR;AACA;AACA;AACA;AACA;IACQ,IAAIG,WAAW,GAAGC,MAAM,CAACC,QAAP,CAAgBC,MAAhB,IAA0B,EAA5C;IACA,IAAIC,KAAK,GAAG,EAAZ;;IAEA,IAAIJ,WAAW,CAACK,UAAZ,CAAuB,GAAvB,CAAJ,EAAiC;MAC7BL,WAAW,GAAGA,WAAW,CAACM,MAAZ,CAAmB,CAAnB,CAAd;IACH;;IAED,IAAIN,WAAJ,EAAiB;MACbI,KAAK,GAAGJ,WAAW,CAACO,KAAZ,CAAkB,GAAlB,CAAR;MACA,MAAMC,QAAQ,GAAG,EAAjB;;MAEA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,KAAK,CAACM,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;QACnC,MAAME,IAAI,GAAGP,KAAK,CAACK,CAAD,CAAlB;;QAEA,IAAI,CAACE,IAAI,CAACN,UAAL,CAAgB,OAAhB,CAAL,EAA+B;UAC3BG,QAAQ,CAACI,IAAT,CAAcD,IAAd;QACH;MACJ;;MAED,IAAIH,QAAQ,CAACE,MAAT,GAAkB,CAAtB,EAAyB;QACrB,OAAO,MAAMF,QAAQ,CAACK,IAAT,CAAc,GAAd,CAAb;MACH;IACJ;;IAED,OAAO,EAAP;EACH,CArGoC;;EAuGrC;AACJ;AACA;AACA;AACA;AACA;AACA;EACIC,cAAc,CAACC,EAAD,EAAK;IACf,MAAMC,IAAI,GAAGC,CAAC,CAACF,EAAE,CAACG,aAAJ,CAAD,CAAoBC,IAApB,CAAyB,MAAzB,CAAb;;IAEA,IAAIH,IAAI,KAAKI,SAAb,EAAwB;MACpB,KAAKC,OAAL,CAAa,cAAb,EAA6BL,IAA7B;MAEAD,EAAE,CAACO,eAAH;MACAP,EAAE,CAACQ,cAAH;IACH;EACJ;;AAvHoC,CAArB,CAApB"}