{"version":3,"file":"draftReviewRequestModelTests.js","names":["suite","draft","beforeEach","reviewRequest","RB","ReviewRequest","id","links","href","spyOn","and","resolveTo","it","expect","url","toBe","describe","callThrough","$","callFake","request","data","public","success","stat","set","targetGroups","name","summary","description","publish","apiCall","toHaveBeenCalled","ajax","done","console","warn","error","fail","parse","branch","bugs_closed","changedescription","changedescription_text_type","description_text_type","target_groups","target_people","testing_done","testing_done_text_type","submitter","not","undefined","bugsClosed","changeDescription","changeDescriptionRichText","descriptionRichText","targetPeople","testingDone","testingDoneRichText"],"sources":["../../../../../../../static/rb/js/resources/models/tests/draftReviewRequestModelTests.es6.js"],"sourcesContent":["suite('rb/resources/models/DraftReviewRequest', function() {\n    let draft;\n\n    beforeEach(function() {\n        const reviewRequest = new RB.ReviewRequest({\n            id: 1,\n            links: {\n                draft: {\n                    href: '/api/review-requests/123/draft/',\n                },\n            },\n        });\n\n        draft = reviewRequest.draft;\n\n        spyOn(reviewRequest, 'ready').and.resolveTo();\n        spyOn(reviewRequest, 'ensureCreated').and.resolveTo();\n        spyOn(draft, 'ready').and.resolveTo();\n    });\n\n    it('url', function() {\n        expect(draft.url()).toBe('/api/review-requests/123/draft/');\n    });\n\n    describe('publish', function() {\n        it('With promises', async function() {\n            spyOn(RB, 'apiCall').and.callThrough();\n            spyOn($, 'ajax').and.callFake(request => {\n                expect(request.data.public).toBe(1);\n\n                request.success({\n                    stat: 'ok',\n                    draft: {\n                        id: 1,\n                        links: {},\n                    },\n                });\n            });\n\n            /* Set some fields in order to pass validation. */\n            draft.set({\n                targetGroups: [{\n                    name: 'mygroup',\n                    url: '/groups/mygroup',\n                }],\n                summary: 'My summary',\n                description: 'My description',\n            });\n\n            await draft.publish();\n\n            expect(RB.apiCall).toHaveBeenCalled();\n            expect($.ajax).toHaveBeenCalled();\n        });\n\n        it('With callbacks', function(done) {\n            spyOn(RB, 'apiCall').and.callThrough();\n            spyOn($, 'ajax').and.callFake(request => {\n                expect(request.data.public).toBe(1);\n\n                request.success({\n                    stat: 'ok',\n                    draft: {\n                        id: 1,\n                        links: {},\n                    },\n                });\n            });\n            spyOn(console, 'warn');\n\n            /* Set some fields in order to pass validation. */\n            draft.set({\n                targetGroups: [{\n                    name: 'mygroup',\n                    url: '/groups/mygroup',\n                }],\n                summary: 'My summary',\n                description: 'My description',\n            });\n\n            draft.publish({\n                success: () => {\n                    expect(RB.apiCall).toHaveBeenCalled();\n                    expect($.ajax).toHaveBeenCalled();\n                    expect(console.warn).toHaveBeenCalled();\n\n                    done();\n                },\n                error: () => done.fail(),\n            });\n        });\n    });\n\n    it('parse', function() {\n        const data = draft.parse({\n            stat: 'ok',\n            draft: {\n                id: 1,\n                branch: 'branch',\n                bugs_closed: 'bugsClosed',\n                changedescription: 'changeDescription',\n                changedescription_text_type: 'markdown',\n                description: 'description',\n                'public': 'public',\n                description_text_type: 'markdown',\n                summary: 'summary',\n                target_groups: 'targetGroups',\n                target_people: 'targetPeople',\n                testing_done: 'testingDone',\n                testing_done_text_type: 'plain',\n                links: {\n                    submitter: 'submitter',\n                },\n            },\n        });\n\n        expect(data).not.toBe(undefined);\n        expect(data.id).toBe(1);\n        expect(data.branch).toBe('branch');\n        expect(data.bugsClosed).toBe('bugsClosed');\n        expect(data.changeDescription).toBe('changeDescription');\n        expect(data.changeDescriptionRichText).toBe(true);\n        expect(data.description).toBe('description');\n        expect(data.descriptionRichText).toBe(true);\n        expect(data.public).toBe('public');\n        expect(data.summary).toBe('summary');\n        expect(data.submitter).toBe('submitter');\n        expect(data.targetGroups).toBe('targetGroups');\n        expect(data.targetPeople).toBe('targetPeople');\n        expect(data.testingDone).toBe('testingDone');\n        expect(data.testingDoneRichText).toBe(false);\n    });\n});\n"],"mappings":"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"}