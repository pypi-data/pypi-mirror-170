{"version":3,"file":"draftReviewBannerViewTests.js","names":["suite","template","model","view","beforeEach","RB","DraftReview","DraftReviewBannerView","el","$","appendTo","$testsScratch","render","afterEach","remove","describe","$buttons","it","expect","prop","toBe","trigger","spyOn","ReviewDialogView","click","create","toHaveBeenCalled","calls","argsFor","review","publish","and","callThrough","_onPublishClicked","toHaveBeenCalledWith","publishAndArchive","fn","callFake","options","buttons","forEach","$btn","add","modalBox","cmd","filter","destroy","$el","hasClass","show","addClass","hide"],"sources":["../../../../../../static/rb/js/views/tests/draftReviewBannerViewTests.es6.js"],"sourcesContent":["suite('rb/views/DraftReviewBannerView', function() {\n    const template = dedent`\n        <div id=\"review-banner\" hidden class=\"hidden\">\n         <div class=\"banner\">\n          <h1>You have a pending review.</h1>\n          <input id=\"review-banner-edit\" type=\"button\"\n                 value=\"Edit Review\" />\n          <input id=\"review-banner-publish-container\" type=\"button\"\n                 value=\"Publish\" />\n          <input id=\"review-banner-discard\" type=\"button\"\n                 value=\"Discard\" />\n         </div>\n        </div>'\n    `;\n    let model;\n    let view;\n\n    beforeEach(function() {\n        model = new RB.DraftReview();\n        view = new RB.DraftReviewBannerView({\n            el: $(template).appendTo($testsScratch),\n            model: model,\n        });\n\n        view.render();\n    });\n\n    afterEach(function() {\n        view.remove();\n    });\n\n    describe('Button states', function() {\n        let $buttons;\n\n        beforeEach(function() {\n            $buttons = view.$('input');\n        });\n\n        describe('Enabled', function() {\n            it('Default', function() {\n                expect($buttons.prop('disabled')).toBe(false);\n            });\n\n            it('When saved', function() {\n                $buttons.prop('disabled', true);\n                model.trigger('saved');\n                expect($buttons.prop('disabled')).toBe(false);\n            });\n\n            it('When destroyed', function() {\n                $buttons.prop('disabled', true);\n                model.trigger('destroyed');\n                expect($buttons.prop('disabled')).toBe(false);\n            });\n        });\n\n        describe('Disabled', function() {\n            it('When saving', function() {\n                model.trigger('saving');\n                expect($buttons.prop('disabled')).toBe(true);\n            });\n\n            it('When destroying', function() {\n                model.trigger('destroying');\n                expect($buttons.prop('disabled')).toBe(true);\n            });\n        });\n    });\n\n    describe('Button events', function() {\n        it('Edit Review', function() {\n            spyOn(RB.ReviewDialogView, 'create');\n\n            view.$('#review-banner-edit').click();\n\n            expect(RB.ReviewDialogView.create).toHaveBeenCalled();\n            expect(RB.ReviewDialogView.create.calls.argsFor(0)[0].review)\n                .toBe(model);\n        });\n\n        it('Publish', function() {\n            spyOn(model, 'publish');\n\n            view.$('#review-banner-publish').click();\n\n            expect(model.publish).toHaveBeenCalled();\n        });\n\n        it('Publish to Submitter Only', function() {\n            spyOn(model, 'publish');\n\n            /*\n             * The alternative buttons from the split button are added to the\n             * <body>.\n             */\n            $('#review-banner-publish-submitter-only').click();\n\n            expect(model.publish).toHaveBeenCalled();\n        });\n\n        it('Publish and Archive', function() {\n            spyOn(model, 'publish');\n            spyOn(view, '_onPublishClicked').and.callThrough();\n\n            /*\n             * The alternative buttons from the split button are added to the\n             * <body>.\n             */\n            $('#review-banner-publish-and-archive').click();\n\n            expect(model.publish).toHaveBeenCalled();\n            expect(view._onPublishClicked).toHaveBeenCalledWith({\n                publishAndArchive: true\n            });\n        });\n\n        it('Discard', function() {\n            let $buttons = $();\n\n            spyOn(model, 'destroy');\n            spyOn($.fn, 'modalBox').and.callFake(options => {\n                options.buttons.forEach($btn => {\n                    $buttons = $buttons.add($btn);\n                });\n\n                /* Simulate the modalBox API for what we need. */\n                return {\n                    modalBox: cmd => {\n                        expect(cmd).toBe('buttons');\n                        return $buttons;\n                    }\n                };\n            });\n\n            view.$('#review-banner-discard').click();\n            expect($.fn.modalBox).toHaveBeenCalled();\n\n            $buttons.filter('input[value=\"Discard\"]').click();\n            expect(model.destroy).toHaveBeenCalled();\n        });\n    });\n\n    describe('Methods', function() {\n        it('show', function() {\n            expect(view.$el.hasClass('hidden')).toBe(true);\n            expect(view.$el.prop('hidden')).toBe(true);\n\n            view.show();\n            expect(view.$el.hasClass('hidden')).toBe(false);\n            expect(view.$el.prop('hidden')).toBe(false);\n        });\n\n        it('hide', function() {\n            view.$el\n                .addClass('hidden')\n                .prop('hidden', true);\n\n            view.hide();\n            expect(view.$el.hasClass('hidden')).toBe(true);\n            expect(view.$el.prop('hidden')).toBe(true);\n        });\n    });\n});\n"],"mappings":";;AAAAA,KAAK,CAAC,gCAAD,EAAmC,YAAW;EAC/C,MAAMC,QAAQ,GAAU;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAVI;EAaA,IAAIC,KAAJ;EACA,IAAIC,IAAJ;EAEAC,UAAU,CAAC,YAAW;IAClBF,KAAK,GAAG,IAAIG,EAAE,CAACC,WAAP,EAAR;IACAH,IAAI,GAAG,IAAIE,EAAE,CAACE,qBAAP,CAA6B;MAChCC,EAAE,EAAEC,CAAC,CAACR,QAAD,CAAD,CAAYS,QAAZ,CAAqBC,aAArB,CAD4B;MAEhCT,KAAK,EAAEA;IAFyB,CAA7B,CAAP;IAKAC,IAAI,CAACS,MAAL;EACH,CARS,CAAV;EAUAC,SAAS,CAAC,YAAW;IACjBV,IAAI,CAACW,MAAL;EACH,CAFQ,CAAT;EAIAC,QAAQ,CAAC,eAAD,EAAkB,YAAW;IACjC,IAAIC,QAAJ;IAEAZ,UAAU,CAAC,YAAW;MAClBY,QAAQ,GAAGb,IAAI,CAACM,CAAL,CAAO,OAAP,CAAX;IACH,CAFS,CAAV;IAIAM,QAAQ,CAAC,SAAD,EAAY,YAAW;MAC3BE,EAAE,CAAC,SAAD,EAAY,YAAW;QACrBC,MAAM,CAACF,QAAQ,CAACG,IAAT,CAAc,UAAd,CAAD,CAAN,CAAkCC,IAAlC,CAAuC,KAAvC;MACH,CAFC,CAAF;MAIAH,EAAE,CAAC,YAAD,EAAe,YAAW;QACxBD,QAAQ,CAACG,IAAT,CAAc,UAAd,EAA0B,IAA1B;QACAjB,KAAK,CAACmB,OAAN,CAAc,OAAd;QACAH,MAAM,CAACF,QAAQ,CAACG,IAAT,CAAc,UAAd,CAAD,CAAN,CAAkCC,IAAlC,CAAuC,KAAvC;MACH,CAJC,CAAF;MAMAH,EAAE,CAAC,gBAAD,EAAmB,YAAW;QAC5BD,QAAQ,CAACG,IAAT,CAAc,UAAd,EAA0B,IAA1B;QACAjB,KAAK,CAACmB,OAAN,CAAc,WAAd;QACAH,MAAM,CAACF,QAAQ,CAACG,IAAT,CAAc,UAAd,CAAD,CAAN,CAAkCC,IAAlC,CAAuC,KAAvC;MACH,CAJC,CAAF;IAKH,CAhBO,CAAR;IAkBAL,QAAQ,CAAC,UAAD,EAAa,YAAW;MAC5BE,EAAE,CAAC,aAAD,EAAgB,YAAW;QACzBf,KAAK,CAACmB,OAAN,CAAc,QAAd;QACAH,MAAM,CAACF,QAAQ,CAACG,IAAT,CAAc,UAAd,CAAD,CAAN,CAAkCC,IAAlC,CAAuC,IAAvC;MACH,CAHC,CAAF;MAKAH,EAAE,CAAC,iBAAD,EAAoB,YAAW;QAC7Bf,KAAK,CAACmB,OAAN,CAAc,YAAd;QACAH,MAAM,CAACF,QAAQ,CAACG,IAAT,CAAc,UAAd,CAAD,CAAN,CAAkCC,IAAlC,CAAuC,IAAvC;MACH,CAHC,CAAF;IAIH,CAVO,CAAR;EAWH,CApCO,CAAR;EAsCAL,QAAQ,CAAC,eAAD,EAAkB,YAAW;IACjCE,EAAE,CAAC,aAAD,EAAgB,YAAW;MACzBK,KAAK,CAACjB,EAAE,CAACkB,gBAAJ,EAAsB,QAAtB,CAAL;MAEApB,IAAI,CAACM,CAAL,CAAO,qBAAP,EAA8Be,KAA9B;MAEAN,MAAM,CAACb,EAAE,CAACkB,gBAAH,CAAoBE,MAArB,CAAN,CAAmCC,gBAAnC;MACAR,MAAM,CAACb,EAAE,CAACkB,gBAAH,CAAoBE,MAApB,CAA2BE,KAA3B,CAAiCC,OAAjC,CAAyC,CAAzC,EAA4C,CAA5C,EAA+CC,MAAhD,CAAN,CACKT,IADL,CACUlB,KADV;IAEH,CARC,CAAF;IAUAe,EAAE,CAAC,SAAD,EAAY,YAAW;MACrBK,KAAK,CAACpB,KAAD,EAAQ,SAAR,CAAL;MAEAC,IAAI,CAACM,CAAL,CAAO,wBAAP,EAAiCe,KAAjC;MAEAN,MAAM,CAAChB,KAAK,CAAC4B,OAAP,CAAN,CAAsBJ,gBAAtB;IACH,CANC,CAAF;IAQAT,EAAE,CAAC,2BAAD,EAA8B,YAAW;MACvCK,KAAK,CAACpB,KAAD,EAAQ,SAAR,CAAL;MAEA;AACZ;AACA;AACA;;MACYO,CAAC,CAAC,uCAAD,CAAD,CAA2Ce,KAA3C;MAEAN,MAAM,CAAChB,KAAK,CAAC4B,OAAP,CAAN,CAAsBJ,gBAAtB;IACH,CAVC,CAAF;IAYAT,EAAE,CAAC,qBAAD,EAAwB,YAAW;MACjCK,KAAK,CAACpB,KAAD,EAAQ,SAAR,CAAL;MACAoB,KAAK,CAACnB,IAAD,EAAO,mBAAP,CAAL,CAAiC4B,GAAjC,CAAqCC,WAArC;MAEA;AACZ;AACA;AACA;;MACYvB,CAAC,CAAC,oCAAD,CAAD,CAAwCe,KAAxC;MAEAN,MAAM,CAAChB,KAAK,CAAC4B,OAAP,CAAN,CAAsBJ,gBAAtB;MACAR,MAAM,CAACf,IAAI,CAAC8B,iBAAN,CAAN,CAA+BC,oBAA/B,CAAoD;QAChDC,iBAAiB,EAAE;MAD6B,CAApD;IAGH,CAdC,CAAF;IAgBAlB,EAAE,CAAC,SAAD,EAAY,YAAW;MACrB,IAAID,QAAQ,GAAGP,CAAC,EAAhB;MAEAa,KAAK,CAACpB,KAAD,EAAQ,SAAR,CAAL;MACAoB,KAAK,CAACb,CAAC,CAAC2B,EAAH,EAAO,UAAP,CAAL,CAAwBL,GAAxB,CAA4BM,QAA5B,CAAqCC,OAAO,IAAI;QAC5CA,OAAO,CAACC,OAAR,CAAgBC,OAAhB,CAAwBC,IAAI,IAAI;UAC5BzB,QAAQ,GAAGA,QAAQ,CAAC0B,GAAT,CAAaD,IAAb,CAAX;QACH,CAFD;QAIA;;QACA,OAAO;UACHE,QAAQ,EAAEC,GAAG,IAAI;YACb1B,MAAM,CAAC0B,GAAD,CAAN,CAAYxB,IAAZ,CAAiB,SAAjB;YACA,OAAOJ,QAAP;UACH;QAJE,CAAP;MAMH,CAZD;MAcAb,IAAI,CAACM,CAAL,CAAO,wBAAP,EAAiCe,KAAjC;MACAN,MAAM,CAACT,CAAC,CAAC2B,EAAF,CAAKO,QAAN,CAAN,CAAsBjB,gBAAtB;MAEAV,QAAQ,CAAC6B,MAAT,CAAgB,wBAAhB,EAA0CrB,KAA1C;MACAN,MAAM,CAAChB,KAAK,CAAC4C,OAAP,CAAN,CAAsBpB,gBAAtB;IACH,CAvBC,CAAF;EAwBH,CAvEO,CAAR;EAyEAX,QAAQ,CAAC,SAAD,EAAY,YAAW;IAC3BE,EAAE,CAAC,MAAD,EAAS,YAAW;MAClBC,MAAM,CAACf,IAAI,CAAC4C,GAAL,CAASC,QAAT,CAAkB,QAAlB,CAAD,CAAN,CAAoC5B,IAApC,CAAyC,IAAzC;MACAF,MAAM,CAACf,IAAI,CAAC4C,GAAL,CAAS5B,IAAT,CAAc,QAAd,CAAD,CAAN,CAAgCC,IAAhC,CAAqC,IAArC;MAEAjB,IAAI,CAAC8C,IAAL;MACA/B,MAAM,CAACf,IAAI,CAAC4C,GAAL,CAASC,QAAT,CAAkB,QAAlB,CAAD,CAAN,CAAoC5B,IAApC,CAAyC,KAAzC;MACAF,MAAM,CAACf,IAAI,CAAC4C,GAAL,CAAS5B,IAAT,CAAc,QAAd,CAAD,CAAN,CAAgCC,IAAhC,CAAqC,KAArC;IACH,CAPC,CAAF;IASAH,EAAE,CAAC,MAAD,EAAS,YAAW;MAClBd,IAAI,CAAC4C,GAAL,CACKG,QADL,CACc,QADd,EAEK/B,IAFL,CAEU,QAFV,EAEoB,IAFpB;MAIAhB,IAAI,CAACgD,IAAL;MACAjC,MAAM,CAACf,IAAI,CAAC4C,GAAL,CAASC,QAAT,CAAkB,QAAlB,CAAD,CAAN,CAAoC5B,IAApC,CAAyC,IAAzC;MACAF,MAAM,CAACf,IAAI,CAAC4C,GAAL,CAAS5B,IAAT,CAAc,QAAd,CAAD,CAAN,CAAgCC,IAAhC,CAAqC,IAArC;IACH,CARC,CAAF;EASH,CAnBO,CAAR;AAoBH,CAlKI,CAAL"}