{"version":3,"file":"screenshotThumbnailViewTests.js","names":["suite","model","view","beforeEach","RB","Screenshot","url","id","attributes","set","template","ScreenshotThumbnail","el","$","appendTo","$testsScratch","render","spyOn","and","callThrough","describe","it","$caption","inlineEditor","expect","trigger","toHaveBeenCalledWith","done","$el","find","val","triggerHandler","_","defer","get","toBe","save","toHaveBeenCalled","callFake","options","success","cb","ajax","destroy","calls","argsFor","fadeOut","click"],"sources":["../../../../../../static/rb/js/views/tests/screenshotThumbnailViewTests.es6.js"],"sourcesContent":["suite('rb/views/ScreenshotThumbnail', function() {\n    let model;\n    let view;\n\n    beforeEach(function() {\n        model = new RB.Screenshot();\n        model.url = '/screenshots/123/';\n        model.id = 123;\n        model.attributes.id = 123;\n        model.set('loaded', true);\n\n        const template =\n            '<div><a class=\"edit\"></a><a class=\"delete\">X</a></div>';\n\n        view = new RB.ScreenshotThumbnail({\n            el: $(template).appendTo($testsScratch),\n            model: model,\n        });\n        view.render();\n\n        spyOn(model, 'trigger').and.callThrough();\n        spyOn(view, 'trigger').and.callThrough();\n    });\n\n    describe('Actions', function() {\n        it('Begin caption editing', function() {\n            view.$caption.inlineEditor('startEdit');\n            expect(view.trigger).toHaveBeenCalledWith('beginEdit');\n        });\n\n        it('Cancel caption editing', function() {\n            view.$caption.inlineEditor('startEdit');\n            expect(view.trigger).toHaveBeenCalledWith('beginEdit');\n\n            view.$caption.inlineEditor('cancel');\n            expect(view.trigger).toHaveBeenCalledWith('endEdit');\n        });\n\n        it('Save caption', function(done) {\n            spyOn(model, 'save');\n\n            view.$caption.inlineEditor('startEdit');\n            expect(view.trigger).toHaveBeenCalledWith('beginEdit');\n\n            view.$el.find('input')\n                .val('Foo')\n                .triggerHandler('keyup');\n            view.$caption.inlineEditor('submit');\n\n            _.defer(() => {\n                expect(view.trigger).toHaveBeenCalledWith('endEdit');\n                expect(model.get('caption')).toBe('Foo');\n                expect(model.save).toHaveBeenCalled();\n                done();\n            });\n        });\n\n        it('Delete', function(done) {\n            spyOn(model, 'destroy').and.callThrough();\n            spyOn($, 'ajax').and.callFake(options => options.success());\n            spyOn(view.$el, 'fadeOut').and.callFake(cb => cb());\n\n            spyOn(view, 'remove').and.callFake(() => {\n                expect($.ajax).toHaveBeenCalled();\n                expect(model.destroy).toHaveBeenCalled();\n                expect(model.trigger.calls.argsFor(0)[0]).toBe('destroying');\n                expect(view.$el.fadeOut).toHaveBeenCalled();\n\n                done();\n            });\n\n            view.$el.find('a.delete').click();\n        });\n    });\n});\n"],"mappings":"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"}