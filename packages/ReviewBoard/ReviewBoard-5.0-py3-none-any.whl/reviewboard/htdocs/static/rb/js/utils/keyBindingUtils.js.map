{"version":3,"file":"keyBindingUtils.js","names":["RB","KeyBindingsMixin","delegateKeyBindings","$el","on","cid","_","bind","evt","altKey","ctrlKey","metaKey","target","tagName","isContentEditable","keyChar","String","fromCharCode","which","keys","Object","keyBindings","indexOf","stopPropagation","preventDefault","func","isFunction","call","undelegateKeyBindings","off","delegateEvents","events","result","Backbone","View","prototype","undelegateEvents"],"sources":["../../../../../static/rb/js/utils/keyBindingUtils.es6.js"],"sourcesContent":["/**\n * A mixin for views that provides key binding functionality.\n *\n * Views using this mixin can provide a keyBindings map that maps a set of\n * key characters to a function.\n */\nRB.KeyBindingsMixin = {\n    /**\n     * Enable key bindings for the view.\n     *\n     * Begins listening for any key bindings registered in the view's\n     * keyBindings map, and calls the appropriate function.\n     *\n     * By default, this is called automatically when setting up the view,\n     * by way of delegateEvents.\n     */\n    delegateKeyBindings() {\n        this.$el.on(`keypress.keybindings.${this.cid}`, _.bind(function(evt) {\n            if (evt.altKey || evt.ctrlKey || evt.metaKey ||\n                evt.target.tagName === 'INPUT' ||\n                evt.target.tagName === 'TEXTAREA' ||\n                evt.target.isContentEditable) {\n                /* These are all unsupported, and things we want to ignore. */\n                return;\n            }\n\n            const keyChar = String.fromCharCode(evt.which);\n\n            for (let keys of Object.keys(this.keyBindings)) {\n                if (keys.indexOf(keyChar) !== -1) {\n                    evt.stopPropagation();\n                    evt.preventDefault();\n\n                    let func = this.keyBindings[keys];\n\n                    if (!_.isFunction(func)) {\n                        func = this[func];\n                    }\n\n                    func.call(this, evt);\n                }\n            }\n        }, this));\n    },\n\n    /**\n     * Disable key bindings for the view.\n     *\n     * By default, this is called automatically when calling undelegateEvents.\n     */\n    undelegateKeyBindings() {\n        if (this.$el) {\n            this.$el.off(`keypress.keybindings.${this.cid}`);\n        }\n    },\n\n    /**\n     * Delegate both DOM events and key binding events.\n     *\n     * This overrides the default Backbone.View.delegateEvents to automatically\n     * call delegateKeyBindings.\n     */\n    delegateEvents(events) {\n        const result = Backbone.View.prototype.delegateEvents.call(this, events);\n\n        this.delegateKeyBindings();\n\n        return result;\n    },\n\n    /**\n     * Undelegate both DOM events and key binding events.\n     *\n     * This overrides the default Backbone.View.undelegateEvents to\n     * automatically call undelegateKeyBindings.\n     */\n    undelegateEvents() {\n        const result = Backbone.View.prototype.undelegateEvents.call(this);\n\n        this.undelegateKeyBindings();\n\n        return result;\n    }\n};\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACAA,EAAE,CAACC,gBAAH,GAAsB;EAClB;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIC,mBAAmB,GAAG;IAClB,KAAKC,GAAL,CAASC,EAAT,CAAa,wBAAuB,KAAKC,GAAI,EAA7C,EAAgDC,CAAC,CAACC,IAAF,CAAO,UAASC,GAAT,EAAc;MACjE,IAAIA,GAAG,CAACC,MAAJ,IAAcD,GAAG,CAACE,OAAlB,IAA6BF,GAAG,CAACG,OAAjC,IACAH,GAAG,CAACI,MAAJ,CAAWC,OAAX,KAAuB,OADvB,IAEAL,GAAG,CAACI,MAAJ,CAAWC,OAAX,KAAuB,UAFvB,IAGAL,GAAG,CAACI,MAAJ,CAAWE,iBAHf,EAGkC;QAC9B;QACA;MACH;;MAED,MAAMC,OAAO,GAAGC,MAAM,CAACC,YAAP,CAAoBT,GAAG,CAACU,KAAxB,CAAhB;;MAEA,KAAK,IAAIC,IAAT,IAAiBC,MAAM,CAACD,IAAP,CAAY,KAAKE,WAAjB,CAAjB,EAAgD;QAC5C,IAAIF,IAAI,CAACG,OAAL,CAAaP,OAAb,MAA0B,CAAC,CAA/B,EAAkC;UAC9BP,GAAG,CAACe,eAAJ;UACAf,GAAG,CAACgB,cAAJ;UAEA,IAAIC,IAAI,GAAG,KAAKJ,WAAL,CAAiBF,IAAjB,CAAX;;UAEA,IAAI,CAACb,CAAC,CAACoB,UAAF,CAAaD,IAAb,CAAL,EAAyB;YACrBA,IAAI,GAAG,KAAKA,IAAL,CAAP;UACH;;UAEDA,IAAI,CAACE,IAAL,CAAU,IAAV,EAAgBnB,GAAhB;QACH;MACJ;IACJ,CAzB+C,EAyB7C,IAzB6C,CAAhD;EA0BH,CArCiB;;EAuClB;AACJ;AACA;AACA;AACA;EACIoB,qBAAqB,GAAG;IACpB,IAAI,KAAKzB,GAAT,EAAc;MACV,KAAKA,GAAL,CAAS0B,GAAT,CAAc,wBAAuB,KAAKxB,GAAI,EAA9C;IACH;EACJ,CAhDiB;;EAkDlB;AACJ;AACA;AACA;AACA;AACA;EACIyB,cAAc,CAACC,MAAD,EAAS;IACnB,MAAMC,MAAM,GAAGC,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBL,cAAxB,CAAuCH,IAAvC,CAA4C,IAA5C,EAAkDI,MAAlD,CAAf;IAEA,KAAK7B,mBAAL;IAEA,OAAO8B,MAAP;EACH,CA9DiB;;EAgElB;AACJ;AACA;AACA;AACA;AACA;EACII,gBAAgB,GAAG;IACf,MAAMJ,MAAM,GAAGC,QAAQ,CAACC,IAAT,CAAcC,SAAd,CAAwBC,gBAAxB,CAAyCT,IAAzC,CAA8C,IAA9C,CAAf;IAEA,KAAKC,qBAAL;IAEA,OAAOI,MAAP;EACH;;AA5EiB,CAAtB"}