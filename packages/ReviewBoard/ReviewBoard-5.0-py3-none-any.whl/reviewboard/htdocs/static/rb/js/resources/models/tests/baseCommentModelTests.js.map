{"version":3,"file":"baseCommentModelTests.js","names":["suite","strings","RB","BaseComment","parentObject","model","beforeEach","BaseResource","expect","validate","attributes","toBe","undefined","describe","it","STATE_DROPPED","STATE_OPEN","STATE_RESOLVED","spyOn","set","destroyIfEmpty","destroy","toHaveBeenCalled","not","rspNamespace","data","parse","stat","my_comment","id","issue_opened","issue_status","text","issueOpened","issueStatus","toJSON","force_text_type","include_text_types","loaded","text_type","INVALID_ISSUE_STATUS","UNSET_PARENT_OBJECT"],"sources":["../../../../../../../static/rb/js/resources/models/tests/baseCommentModelTests.es6.js"],"sourcesContent":["suite('rb/resources/models/BaseComment', function() {\n    const strings = RB.BaseComment.strings;\n    let parentObject;\n    let model;\n\n    beforeEach(function() {\n        parentObject = new RB.BaseResource({\n            'public': true,\n        });\n\n        model = new RB.BaseComment({\n            parentObject: parentObject,\n        });\n\n        expect(model.validate(model.attributes)).toBe(undefined);\n    });\n\n    describe('State values', function() {\n        it('STATE_DROPPED', function() {\n            expect(RB.BaseComment.STATE_DROPPED).toBe('dropped');\n        });\n\n        it('STATE_OPEN', function() {\n            expect(RB.BaseComment.STATE_OPEN).toBe('open');\n        });\n\n        it('STATE_RESOLVED', function() {\n            expect(RB.BaseComment.STATE_RESOLVED).toBe('resolved');\n        });\n    });\n\n    describe('destroyIfEmpty', function() {\n        beforeEach(function() {\n            spyOn(model, 'destroy');\n        });\n\n        it('Destroying when text is empty', function() {\n            model.set('text', '');\n            model.destroyIfEmpty();\n            expect(model.destroy).toHaveBeenCalled();\n        });\n\n        it('Not destroying when text is not empty', function() {\n            model.set('text', 'foo');\n            model.destroyIfEmpty();\n            expect(model.destroy).not.toHaveBeenCalled();\n        });\n    });\n\n    describe('parse', function() {\n        beforeEach(function() {\n            model.rspNamespace = 'my_comment';\n        });\n\n        it('API payloads', function() {\n            const data = model.parse({\n                stat: 'ok',\n                my_comment: {\n                    id: 42,\n                    issue_opened: true,\n                    issue_status: 'resolved',\n                    text: 'foo',\n                },\n            });\n\n            expect(data).not.toBe(undefined);\n            expect(data.id).toBe(42);\n            expect(data.issueOpened).toBe(true);\n            expect(data.issueStatus).toBe(RB.BaseComment.STATE_RESOLVED);\n            expect(data.text).toBe('foo');\n        });\n    });\n\n    describe('toJSON', function() {\n        describe('force_text_type field', function() {\n            it('With value', function() {\n                model.set('forceTextType', 'html');\n                const data = model.toJSON();\n                expect(data.force_text_type).toBe('html');\n            });\n\n            it('Without value', function() {\n                const data = model.toJSON();\n                expect(data.force_text_type).toBe(undefined);\n            });\n        });\n\n        describe('include_text_types field', function() {\n            it('With value', function() {\n                model.set('includeTextTypes', 'html');\n                const data = model.toJSON();\n                expect(data.include_text_types).toBe('html');\n            });\n\n            it('Without value', function() {\n                const data = model.toJSON();\n\n                expect(data.include_text_types).toBe(undefined);\n            });\n        });\n\n        describe('issue_opened field', function() {\n            it('Default', function() {\n                const data = model.toJSON();\n                expect(data.issue_opened).toBe(null);\n            });\n\n            it('With value', function() {\n                model.set('issueOpened', false);\n                let data = model.toJSON();\n                expect(data.issue_opened).toBe(false);\n\n                model.set('issueOpened', true);\n                data = model.toJSON();\n                expect(data.issue_opened).toBe(true);\n            });\n        });\n\n        describe('issue_status field', function() {\n            it('When not loaded', function() {\n                model.set('issueStatus', RB.BaseComment.STATE_DROPPED);\n                const data = model.toJSON();\n                expect(data.issue_status).toBe(undefined);\n            });\n\n            it('When loaded and parent is not public', function() {\n                parentObject.set('public', false);\n\n                model.set({\n                    loaded: true,\n                    issueStatus: RB.BaseComment.STATE_DROPPED,\n                    parentObject: parentObject,\n                });\n\n                const data = model.toJSON();\n                expect(data.issue_status).toBe(undefined);\n            });\n\n            it('When loaded and parent is public', function() {\n                parentObject.set('public', true);\n\n                model.set({\n                    loaded: true,\n                    issueStatus: RB.BaseComment.STATE_DROPPED,\n                    parentObject: parentObject,\n                });\n\n                const data = model.toJSON();\n                expect(data.issue_status).toBe(RB.BaseComment.STATE_DROPPED);\n            });\n        });\n\n        describe('richText field', function() {\n            it('With true', function() {\n                model.set('richText', true);\n                const data = model.toJSON();\n                expect(data.text_type).toBe('markdown');\n            });\n\n            it('With false', function() {\n                model.set('richText', false);\n                const data = model.toJSON();\n                expect(data.text_type).toBe('plain');\n            });\n        });\n\n        describe('text field', function() {\n            it('With value', function() {\n                model.set('text', 'foo');\n                const data = model.toJSON();\n                expect(data.text).toBe('foo');\n            });\n        });\n    });\n\n    describe('validate', function() {\n        describe('issueState', function() {\n            it('STATE_DROPPED', function() {\n                expect(model.validate({\n                    issueStatus: RB.BaseComment.STATE_DROPPED,\n                })).toBe(undefined);\n            });\n\n            it('STATE_OPEN', function() {\n                expect(model.validate({\n                    issueStatus: RB.BaseComment.STATE_OPEN,\n                })).toBe(undefined);\n            });\n\n            it('STATE_RESOLVED', function() {\n                expect(model.validate({\n                    issueStatus: RB.BaseComment.STATE_RESOLVED,\n                })).toBe(undefined);\n            });\n\n            it('Unset', function() {\n                expect(model.validate({\n                    issueStatus: '',\n                })).toBe(undefined);\n\n                expect(model.validate({\n                    issueStatus: undefined,\n                })).toBe(undefined);\n\n                expect(model.validate({\n                    issueStatus: null,\n                })).toBe(undefined);\n            });\n\n            it('Invalid values', function() {\n                expect(model.validate({\n                    issueStatus: 'foobar',\n                })).toBe(strings.INVALID_ISSUE_STATUS);\n            });\n        });\n\n        describe('parentObject', function() {\n            it('With value', function() {\n                expect(model.validate({\n                    parentObject: parentObject,\n                })).toBe(undefined);\n            });\n\n            it('Unset', function() {\n                expect(model.validate({\n                    parentObject: null,\n                })).toBe(RB.BaseResource.strings.UNSET_PARENT_OBJECT);\n            });\n        });\n    });\n});\n"],"mappings":"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"}