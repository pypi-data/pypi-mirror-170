{"version":3,"file":"textBasedReviewableViewTests.js","names":["suite","template","$container","reviewRequest","model","view","beforeEach","$","appendTo","$testsScratch","RB","ReviewRequest","reviewURL","TextBasedReviewable","hasRenderedView","viewMode","fileAttachmentID","TextBasedReviewableView","el","spyOn","window","history","Backbone","and","returnValue","router","callThrough","callFake","url","options","trigger","loadUrl","render","afterEach","remove","stop","it","navigate","expect","toHaveBeenCalledWith","find","attr","toBe","get"],"sources":["../../../../../../static/rb/js/views/tests/textBasedReviewableViewTests.es6.js"],"sourcesContent":["suite('rb/views/TextBasedReviewableView', function() {\n    const template = dedent`\n      <div id=\"container\">\n       <div class=\"text-review-ui-views\">\n        <ul>\n         <li class=\"active\" data-view-mode=\"rendered\">\n          <a href=\"#rendered\">Rendered</a>\n         </li>\n         <li data-view-mode=\"source\"><a href=\"#source\">Source</a></li>\n        </ul>\n       </div>\n       <table class=\"text-review-ui-rendered-table\"></table>\n       <table class=\"text-review-ui-text-table\"></table>\n      </div>\n    `;\n\n    let $container;\n    let reviewRequest;\n    let model;\n    let view;\n\n    beforeEach(function() {\n        $container = $(template).appendTo($testsScratch);\n\n        reviewRequest = new RB.ReviewRequest({\n            reviewURL: '/r/123/',\n        });\n\n        model = new RB.TextBasedReviewable({\n            hasRenderedView: true,\n            viewMode: 'rendered',\n            fileAttachmentID: 456,\n            reviewRequest: reviewRequest,\n        });\n\n        view = new RB.TextBasedReviewableView({\n            model: model,\n            el: $container,\n        });\n\n        /*\n         * Disable the router so that the page doesn't change the URL on the\n         * page while tests run.\n         */\n        spyOn(window.history, 'pushState');\n        spyOn(window.history, 'replaceState');\n\n        /*\n         * Bypass all the actual history logic and get to the actual\n         * router handler.\n         */\n        spyOn(Backbone.history, 'matchRoot').and.returnValue(true);\n        spyOn(view.router, 'trigger').and.callThrough();\n        spyOn(view.router, 'navigate').and.callFake((url, options) => {\n            if (!options || options.trigger !== false) {\n                Backbone.history.loadUrl(url);\n            }\n        });\n\n        view.render();\n    });\n\n    afterEach(function() {\n        view.remove();\n        $container.remove();\n\n        Backbone.history.stop();\n    });\n\n    it('Router switches view modes', function() {\n        view.router.navigate('#rendered');\n        expect(view.router.trigger).toHaveBeenCalledWith('route:viewMode', 'rendered', null, null);\n        expect($container.find('.active').attr('data-view-mode')).toBe('rendered');\n        expect(model.get('viewMode')).toBe('rendered');\n\n        view.router.navigate('#source');\n        expect(view.router.trigger).toHaveBeenCalledWith('route:viewMode', 'source', null, null);\n        expect($container.find('.active').attr('data-view-mode')).toBe('source');\n        expect(model.get('viewMode')).toBe('source');\n\n        view.router.navigate('#rendered');\n        expect(view.router.trigger).toHaveBeenCalledWith('route:viewMode', 'rendered', null, null);\n        expect($container.find('.active').attr('data-view-mode')).toBe('rendered');\n        expect(model.get('viewMode')).toBe('rendered');\n    });\n});\n"],"mappings":"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"}