{"version":3,"file":"relatedGroupSelectorViewTests.js","names":["suite","describe","it","view","RB","RelatedGroupSelectorView","$input","$","initialOptions","multivalued","inviteOnly","expect","options","toBe","render","$el","find","length","id","display_name","name","invite_only","siblings","val","_selectedIDs","size","beforeEach","done","$testsScratch","append","spyOn","and","callFake","query","callback","selectize","focus","setTimeout","click","loadOptions","toHaveBeenCalled"],"sources":["../../../../../../static/rb/js/admin/tests/relatedGroupSelectorViewTests.es6.js"],"sourcesContent":["suite('rb/admin/views/relatedGroupSelectorView', function() {\n    describe('Rendering', function() {\n        it('when empty', function() {\n            let view = new RB.RelatedGroupSelectorView({\n                $input: $('<input id=\"id_groups\" type=\"hidden\">'),\n                initialOptions: [],\n                multivalued: true,\n                inviteOnly: false,\n            });\n            expect(view.options.multivalued).toBe(true);\n            expect(view.options.inviteOnly).toBe(false);\n            view.render();\n\n            expect(view.$el.find('.related-object-selected li').length)\n                .toBe(0);\n\n        });\n    });\n\n    describe('Rendering', function() {\n        it('with inital options', function() {\n            let view = new RB.RelatedGroupSelectorView({\n                $input: $('<input id=\"id_groups\" type=\"hidden\">'),\n                initialOptions: [{\n                    id: 1,\n                    display_name: \"Test Repository 1\",\n                    name: \"test_repo_1\",\n                    invite_only: false,\n                }, {\n                    id: 2,\n                    display_name: \"Test Repository 2\",\n                    name: \"test_repo_2\",\n                    invite_only: true,\n                }],\n                multivalued: true,\n                inviteOnly: true,\n            });\n            view.render();\n            expect(view.options.multivalued).toBe(true);\n            expect(view.options.inviteOnly).toBe(true);\n\n            expect(view.$el.find('.related-object-selected li').length)\n                .toBe(2);\n            expect(view.$el.siblings('#id_groups').val()).toBe('');\n            /* The input element value should be empty, since the widget will\n               not fill in the values from the objects if the objects are\n               passed through initialOptions. */\n            expect(view._selectedIDs.size).toBe(2);\n\n        });\n    });\n\n    describe('Select item', function() {\n        let view;\n\n        beforeEach(function(done) {\n            $testsScratch.append('<input id=\"id_groups\" type=\"hidden\">');\n            view = new RB.RelatedGroupSelectorView({\n                $input: $('#id_groups'),\n                initialOptions: [],\n                multivalued: true\n            });\n            view.render();\n\n            /* These are the fake users, that will be displayed in the\n               dropdown */\n            spyOn(view, 'loadOptions').and.callFake(function(query, callback) {\n                callback([{\n                    id: 1,\n                    display_name: \"Test Repository 1\",\n                    name: \"test_repo_1\",\n                    invite_only: false,\n                }, {\n                    id: 2,\n                    display_name: \"Test Repository 2\",\n                    name: \"test_repo_2\",\n                    invite_only: true,\n                }]);\n            });\n\n            $('select')[0].selectize.focus();\n            /* The focus() method is being called asynchronously, so it\n              doesn't actually call the loadOptions() method here\n              instantly. That's why I use setTimeout to wait for it to\n              finish. */\n            setTimeout(function() {\n                $testsScratch.find('div .selectize-input.items.not-full input').click();\n                done();\n            }, 4000);\n            /* I probably shouldn't be doing this, but I\n            don't know how else to get it to work. */\n        });\n\n        it('from dropdown', function(done) {\n            expect(view.loadOptions).toHaveBeenCalled();\n            $(\"div[data-value='test_repo_1']\").click();\n            $(\"div[data-value='test_repo_2']\").click();\n            expect(view.$el.siblings('#id_groups').val()).toBe('1,2');\n            done();\n        });\n    });\n\n\n});"],"mappings":"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"}