{"version":3,"file":"menuButtonViewTests.js","names":["suite","describe","it","view","RB","MenuButtonView","ariaMenuLabel","menuItems","text","onPrimaryButtonClick","render","expect","el","toHaveClass","$el","attr","toBe","$primaryButton","length","$","$toggleButton","id","menu","children","toBeNull","toBeUndefined","trim","sendDropDownButtonEvent","name","options","_$dropDownButton","trigger","Event","sendKeyDown","keyCode","which","beforeEach","spyOn","openMenuTests","_openDirection","isOpen","toBeTrue","focusLastItem","toHaveBeenCalled","focusFirstItem","ui","RETURN","SPACE","DOWN","UP","open","animate","ESCAPE","toBeFalse","relatedTarget","$testsScratch"],"sources":["../../../../../../../static/rb/js/ui/views/tests/menuButtonViewTests.es6.js"],"sourcesContent":["suite('rb/ui/views/MenuButtonView', function() {\n    describe('Rendering', function() {\n        it('With primary button', function() {\n            const view = new RB.MenuButtonView({\n                ariaMenuLabel: 'Test ARIA label',\n                menuItems: [\n                    {text: 'Item 1'},\n                    {text: 'Item 2'},\n                    {text: 'Item 3'},\n                ],\n                onPrimaryButtonClick: () => {},\n                text: 'Button label',\n            });\n            view.render();\n\n            expect(view.el).toHaveClass('rb-c-menu-button');\n            expect(view.$el.attr('role')).toBe('group');\n            expect(view.$primaryButton.length).toBe(1);\n\n            const $primaryButton = view.$('.rb-c-menu-button__primary');\n            expect($primaryButton.length).toBe(1);\n\n            const $toggleButton = view.$('.rb-c-menu-button__toggle');\n            expect($toggleButton.length).toBe(1);\n            expect($toggleButton[0].id)\n                .toBe(view.menu.$el.attr('aria-labelledby'));\n            expect($toggleButton.attr('aria-label')).toBe('Test ARIA label');\n            expect($toggleButton.children()[0])\n                .toHaveClass('rb-icon-dropdown-arrow');\n\n            expect(view.menu.el.children.length).toBe(3);\n        });\n\n        it('Without primary button', function() {\n            const view = new RB.MenuButtonView({\n                ariaMenuLabel: 'Test ARIA label',\n                menuItems: [\n                    {text: 'Item 1'},\n                    {text: 'Item 2'},\n                ],\n                text: 'Button label',\n            });\n            view.render();\n\n            expect(view.el).toHaveClass('rb-c-menu-button');\n            expect(view.$el.attr('role')).toBe('group');\n            expect(view.$primaryButton).toBeNull();\n\n            const $primaryButton = view.$('.rb-c-menu-button__primary');\n            expect($primaryButton.length).toBe(0);\n\n            const $toggleButton = view.$('.rb-c-menu-button__toggle');\n            expect($toggleButton.length).toBe(1);\n            expect($toggleButton[0].id)\n                .toBe(view.menu.$el.attr('aria-labelledby'));\n            expect($toggleButton.attr('aria-label')).toBeUndefined();\n            expect($toggleButton.text().trim()).toBe('Button label');\n            expect($toggleButton.children()[0])\n                .toHaveClass('rb-icon-dropdown-arrow');\n\n            expect(view.menu.el.children.length).toBe(2);\n        });\n    });\n\n    describe('Events', function() {\n        let view;\n\n        function sendDropDownButtonEvent(name, options) {\n            view._$dropDownButton.trigger($.Event(name, options));\n        }\n\n        function sendKeyDown(keyCode) {\n            sendDropDownButtonEvent('keydown', {\n                which: keyCode,\n            });\n        }\n\n        beforeEach(function() {\n            view = new RB.MenuButtonView();\n            view.render();\n\n            /* Don't let this override any state we set. */\n            spyOn(view, '_updateMenuPosition');\n        });\n\n        describe('keydown', function() {\n            function openMenuTests(keyCode) {\n                it('With openDirection=up', function() {\n                    view._openDirection = 'up';\n                    spyOn(view.menu, 'focusLastItem');\n\n                    sendKeyDown(keyCode);\n\n                    expect(view.menu.isOpen).toBeTrue();\n                    expect(view.menu.focusLastItem).toHaveBeenCalled();\n                });\n\n                it('With openDirection=down', function() {\n                    view._openDirection = 'down';\n                    spyOn(view.menu, 'focusFirstItem');\n\n                    sendKeyDown(keyCode);\n\n                    expect(view.menu.isOpen).toBeTrue();\n                    expect(view.menu.focusFirstItem).toHaveBeenCalled();\n                });\n            }\n\n            describe('Return key opens menu', function() {\n                openMenuTests($.ui.keyCode.RETURN);\n            });\n\n            describe('Space key opens menu', function() {\n                openMenuTests($.ui.keyCode.SPACE);\n            });\n\n            describe('Down key opens menu', function() {\n                openMenuTests($.ui.keyCode.DOWN);\n            });\n\n            describe('Up key opens menu', function() {\n                openMenuTests($.ui.keyCode.UP);\n            });\n\n            it('Escape key closes menu', function() {\n                view.menu.open({\n                    animate: false,\n                });\n                expect(view.menu.isOpen).toBeTrue();\n\n                sendKeyDown($.ui.keyCode.ESCAPE);\n\n                expect(view.menu.isOpen).toBeFalse();\n            });\n        });\n\n        it('focusout closes menu', function() {\n            view.menu.open({\n                animate: false,\n            });\n\n            expect(view.menu.isOpen).toBeTrue();\n\n            sendDropDownButtonEvent('focusout', {\n                relatedTarget: $testsScratch[0],\n            });\n\n            expect(view.menu.isOpen).toBeFalse();\n        });\n    });\n});\n"],"mappings":"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"}