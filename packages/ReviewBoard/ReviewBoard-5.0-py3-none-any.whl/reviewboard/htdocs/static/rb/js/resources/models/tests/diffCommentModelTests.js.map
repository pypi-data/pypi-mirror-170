{"version":3,"file":"diffCommentModelTests.js","names":["suite","model","beforeEach","RB","DiffComment","fileDiffID","parentObject","BaseResource","it","set","beginLineNum","endLineNum","expect","getNumLines","toBe","describe","data","parse","stat","diff_comment","id","issue_opened","issue_status","text_type","text","first_line","num_lines","filediff","source_file","interfilediff","not","undefined","issueOpened","issueStatus","BaseComment","STATE_RESOLVED","richText","fileDiff","get","interFileDiff","spyOn","prototype","and","callThrough","toJSON","toHaveBeenCalled","force_text_type","include_text_types","filediff_id","interfilediff_id","validate","strings","BEGINLINENUM_GTE_0","ENDLINENUM_GTE_0","BEGINLINENUM_LTE_ENDLINENUM","INVALID_FILEDIFF_ID"],"sources":["../../../../../../../static/rb/js/resources/models/tests/diffCommentModelTests.es6.js"],"sourcesContent":["suite('rb/resources/models/DiffComment', function() {\n    let model;\n\n    beforeEach(function() {\n        /* Set some sane defaults needed to pass validation. */\n        model = new RB.DiffComment({\n            fileDiffID: 16,\n            parentObject: new RB.BaseResource({\n                'public': true,\n            })\n        });\n    });\n\n    it('getNumLines', function() {\n        model.set({\n            beginLineNum: 5,\n            endLineNum: 10,\n        });\n\n        expect(model.getNumLines()).toBe(6);\n    });\n\n    describe('parse', function() {\n        it('API payloads', function() {\n            const data = model.parse({\n                stat: 'ok',\n                diff_comment: {\n                    id: 42,\n                    issue_opened: true,\n                    issue_status: 'resolved',\n                    text_type: 'markdown',\n                    text: 'foo',\n                    first_line: 10,\n                    num_lines: 5,\n                    filediff: {\n                        id: 1,\n                        source_file: 'my-file',\n                    },\n                    interfilediff: {\n                        id: 2,\n                        source_file: 'my-file',\n                    },\n                },\n            });\n\n            expect(data).not.toBe(undefined);\n            expect(data.id).toBe(42);\n            expect(data.issueOpened).toBe(true);\n            expect(data.issueStatus).toBe(RB.BaseComment.STATE_RESOLVED);\n            expect(data.richText).toBe(true);\n            expect(data.text).toBe('foo');\n            expect(data.beginLineNum).toBe(10);\n            expect(data.endLineNum).toBe(14);\n            expect(data.fileDiff).not.toBe(undefined);\n            expect(data.fileDiff.id).toBe(1);\n            expect(data.fileDiff.get('sourceFilename')).toBe('my-file');\n            expect(data.interFileDiff).not.toBe(undefined);\n            expect(data.interFileDiff.id).toBe(2);\n            expect(data.interFileDiff.get('sourceFilename')).toBe('my-file');\n        });\n    });\n\n    describe('toJSON', function() {\n        it('BaseComment.toJSON called', function() {\n            spyOn(RB.BaseComment.prototype, 'toJSON').and.callThrough();\n            model.toJSON();\n            expect(RB.BaseComment.prototype.toJSON).toHaveBeenCalled();\n        });\n\n        it('first_line field', function() {\n            model.set({\n                beginLineNum: 100,\n                endLineNum: 100\n            });\n\n            const data = model.toJSON();\n            expect(data.first_line).toBe(100);\n        });\n\n        it('num_lines field', function() {\n            model.set({\n                beginLineNum: 100,\n                endLineNum: 105\n            });\n\n            const data = model.toJSON();\n            expect(data.num_lines).toBe(6);\n        });\n\n        describe('force_text_type field', function() {\n            it('With value', function() {\n                model.set('forceTextType', 'html');\n                const data = model.toJSON();\n                expect(data.force_text_type).toBe('html');\n            });\n\n            it('Without value', function() {\n                const data = model.toJSON();\n                expect(data.force_text_type).toBe(undefined);\n            });\n        });\n\n        describe('include_text_types field', function() {\n            it('With value', function() {\n                model.set('includeTextTypes', 'html');\n                const data = model.toJSON();\n                expect(data.include_text_types).toBe('html');\n            });\n\n            it('Without value', function() {\n                const data = model.toJSON();\n\n                expect(data.include_text_types).toBe(undefined);\n            });\n        });\n\n        describe('filediff_id field', function() {\n            it('When loaded', function() {\n                model.set('loaded', true);\n                const data = model.toJSON();\n                expect(data.filediff_id).toBe(undefined);\n            });\n\n            it('When not loaded', function() {\n                const data = model.toJSON();\n                expect(data.filediff_id).toBe(16);\n            });\n        });\n\n        describe('interfilediff_id field', function() {\n            it('When loaded', function() {\n                model.set('loaded', true);\n                const data = model.toJSON();\n                expect(data.interfilediff_id).toBe(undefined);\n            });\n\n            it('When not loaded', function() {\n                model.set('interFileDiffID', 50);\n                const data = model.toJSON();\n                expect(data.interfilediff_id).toBe(50);\n            });\n\n            it('When not loaded and unset', function() {\n                const data = model.toJSON();\n                expect(data.interfilediff_id).toBe(undefined);\n            });\n        });\n    });\n\n    describe('validate', function() {\n        it('Inherited behavior', function() {\n            spyOn(RB.BaseComment.prototype, 'validate');\n            model.validate({});\n            expect(RB.BaseComment.prototype.validate).toHaveBeenCalled();\n        });\n\n        describe('beginLineNum/endLineNum', function() {\n            describe('Valid values', function() {\n                it('beginLineNum == 0, endLineNum == 0', function() {\n                    expect(model.validate({\n                        beginLineNum: 0,\n                        endLineNum: 0,\n                    })).toBe(undefined);\n                });\n\n                it('beginLineNum > 0, endLineNum == beginLineNum', function() {\n                    expect(model.validate({\n                        beginLineNum: 10,\n                        endLineNum: 10,\n                    })).toBe(undefined);\n                });\n\n                it('beginLineNum > 0, endLineNum > 0', function() {\n                    expect(model.validate({\n                        beginLineNum: 10,\n                        endLineNum: 11,\n                    })).toBe(undefined);\n                });\n            });\n\n            describe('Invalid values', function() {\n                it('beginLineNum < 0', function() {\n                    expect(model.validate({\n                        beginLineNum: -1,\n                    })).toBe(RB.DiffComment.strings.BEGINLINENUM_GTE_0);\n                });\n\n                it('endLineNum < 0', function() {\n                    expect(model.validate({\n                        endLineNum: -1,\n                    })).toBe(RB.DiffComment.strings.ENDLINENUM_GTE_0);\n                });\n\n                it('endLineNum < beginLineNum', function() {\n                    expect(model.validate({\n                        beginLineNum: 20,\n                        endLineNum: 10,\n                    })).toBe(\n                        RB.DiffComment.strings.BEGINLINENUM_LTE_ENDLINENUM);\n                });\n            });\n        });\n\n        describe('fileDiffID', function() {\n            it('With value', function() {\n                expect(model.validate({\n                    fileDiffID: 42,\n                })).toBe(undefined);\n            });\n\n            it('Unset', function() {\n                expect(model.validate({\n                    fileDiffID: null,\n                })).toBe(RB.DiffComment.strings.INVALID_FILEDIFF_ID);\n            });\n        });\n    });\n});\n"],"mappings":"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"}