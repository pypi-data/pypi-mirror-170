<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Thermal Power Plant Efficiency Optimization" href="pygmo_optimization.html" /><link rel="prev" title="How to Generate Stable Starting Values" href="starting_values.html" />

    <meta name="generator" content="sphinx-5.1.1, furo 2022.06.21"/>
        <title>Exergy Analysis of a Ground-Coupled Heat Pump - TESPy 0.6.1 - Leidenfrost&#39;s Library documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #ffffff;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">TESPy 0.6.1 - Leidenfrost's Library documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/./images/logo_tespy_mid.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/./images/logo_tespy_mid_darkmode.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">TESPy 0.6.1 - Leidenfrost's Library documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Thermal Engineering Systems in Python</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation and setup</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../basics.html">Modeling Basic Systems</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../basics/intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/heat_pump.html">Heat Pump</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/rankine_cycle.html">Rankine Cycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/gas_turbine.html">Gas Turbine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics/district_heating.html">District Heating Network</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../tutorials.html">Advanced Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="heat_pump_steps.html">Build a Heat Pump Stepwise</a></li>
<li class="toctree-l2"><a class="reference internal" href="starting_values.html">How to Generate Stable Starting Values</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Exergy Analysis of a Ground-Coupled Heat Pump</a></li>
<li class="toctree-l2"><a class="reference internal" href="pygmo_optimization.html">Thermal Power Plant Efficiency Optimization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Example Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../regular_meeting.html">TESPy community</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules.html">TESPy modules</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/networks.html">Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/networks.html#network-reader">Network reader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/components.html">Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/components.html#component-groups-subystems">Component Groups: Subystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/connections.html">Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/characteristics.html">Characteristics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/fluid_properties.html">Fluid properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/ude.html">User defined equations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api.html">API Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/components.html">tespy.components module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/connections.html">tespy.connections module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/data.html">tespy.data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/networks.html">tespy.networks module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/tools.html">tespy.tools module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../whats_new.html">What’s New</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zliterature.html">Literature</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced/exergy.html">Exergy analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contribute to TESPy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/what.html">What can I contribute?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/how.html">How can I contribute?</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="exergy-analysis-of-a-ground-coupled-heat-pump">
<span id="tespy-tutorial-heat-pump-exergy-label"></span><h1>Exergy Analysis of a Ground-Coupled Heat Pump<a class="headerlink" href="#exergy-analysis-of-a-ground-coupled-heat-pump" title="Permalink to this heading">#</a></h1>
<div class="section" id="task">
<h2>Task<a class="headerlink" href="#task" title="Permalink to this heading">#</a></h2>
<p>This tutorial shows how to set up and carry out an exergy analysis for a
ground-coupled heat pump (GCHP). In addition, various post-processing options
are presented. To investigate the impact of refrigerant choice on COP and
exergetic efficiency, two Python scripts of the same network with different
refrigerants (NH3 and R410A) are created. Finally, the influence of varying
different parameters on COP and exergetic efficiency is investigated and
plotted.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please note, currently this tutorial is intended to show the user, how to
carry out an exergy analysis for a simple system and how to use this
toolbox in several investigations of a specific system. While there is a
very short description of the setup, methodology and results, an in-depth
discussion of the method and the results is not yet provided. If you would
like to add this to the documentation you are welcome to contact us via our
GitHub.</p>
</div>
<p>Since there is an existing tutorial for
<a class="reference internal" href="heat_pump_steps.html#tespy-tutorial-heat-pump-label"><span class="std std-ref">creating a heat pump</span></a>, this tutorial
starts with the explanations for setting up the exergy analysis. However note,
that the heat pump model differs slightly in structure from the model in the
previous tutorial. All related Python scripts of the fully working GCHP-model
are listed in the following:</p>
<ul class="simple">
<li><p>GCHP with NH3 (the model only):
<a class="reference download internal" download="" href="../_downloads/fad839eda6800074d0730f4875601fef/NH3.py"><code class="xref download docutils literal notranslate"><span class="pre">NH3.py</span></code></a></p></li>
<li><p>GCHP with R410A (the model only):
<a class="reference download internal" download="" href="../_downloads/8f794e535e158b5d76450ff4798e70c0/R410A.py"><code class="xref download docutils literal notranslate"><span class="pre">R410A.py</span></code></a></p></li>
<li><p>GCHP with NH3 (model and post-processing):
<a class="reference download internal" download="" href="../_downloads/db21a5faf1e560bd813f001ecee6b166/NH3_calculations.py"><code class="xref download docutils literal notranslate"><span class="pre">NH3_calculations.py</span></code></a></p></li>
<li><p>GCHP with R410A (model and post-processing):
<a class="reference download internal" download="" href="../_downloads/679f6844f13eafe9fd822ed580220eb0/R410A_calculations.py"><code class="xref download docutils literal notranslate"><span class="pre">R410A_calculations.py</span></code></a></p></li>
<li><p>Plots of the results of the parameter variations:
<a class="reference download internal" download="" href="../_downloads/7451d0293b6af458b13365fc14bd3992/plots.py"><code class="xref download docutils literal notranslate"><span class="pre">plots.py</span></code></a></p></li>
</ul>
<p>The figure below shows the topology of the GCHP. In this model, a
ground-coupled heat pump is modeled, which is for instance connected to a
single-family house with underfloor heating. The heating system represents the
heat demand of the house. The geothermal heat collector is represented by a
ground heat feed flow (Source) and return flow (Sink). The heat pump circuit
consists of the basic components: condenser, expansion valve, evaporator and
compressor.</p>
<div class="only-light figure align-center" id="id4">
<img alt="Topology of the Ground-Couped Heat Pump (GCHP)" src="../_images/flowsheet2.svg" /><p class="caption"><span class="caption-text">Figure: Topology of the Ground-Couped Heat Pump (GCHP).</span><a class="headerlink" href="#id4" title="Permalink to this image">#</a></p>
</div>
<div class="only-dark figure align-center" id="id5">
<img alt="Topology of the Ground-Couped Heat Pump (GCHP)" src="../_images/flowsheet_darkmode2.svg" /><p class="caption"><span class="caption-text">Figure: Topology of the Ground-Couped Heat Pump (GCHP).</span><a class="headerlink" href="#id5" title="Permalink to this image">#</a></p>
</div>
<p>The input data of the model are based on different literature. In general, the
model of the GCHP is based on a data sheet of a real heat pump
(<a class="reference external" href="https://www.viessmann.de/de/wohngebaeude/waermepumpe/sole-wasser-waermepumpen/vitocal-300-g.html">Viessmann Vitocal 300-G</a> ).
However, the data are used as approximate values to create a model that works
with both NH3 and R410A, although the mentioned heat pump is designed to use
R410A. The range of the underfloor heating system temperature and the range of
the geothermal temperature are assumptions based on measured data from the
research project
<a class="reference external" href="https://wp-monitoring.ise.fraunhofer.de/wp-smart-im-bestand/german/index/index.html">WPsmart</a>
and <span id="id1">[<a class="reference internal" href="../zliterature.html#id25" title="Xiao Chen and Xiaoli Hao. Exergy analysis of a ground-coupled heat pump heating system with different terminals. Entropy, 17(4):2328–2340, 2015. doi:10.3390/e17042328.">2</a>]</span>. The average outdoor temperature is taken from
<span id="id2">[<a class="reference internal" href="../zliterature.html#id25" title="Xiao Chen and Xiaoli Hao. Exergy analysis of a ground-coupled heat pump heating system with different terminals. Entropy, 17(4):2328–2340, 2015. doi:10.3390/e17042328.">2</a>]</span>.</p>
</div>
<div class="section" id="tespy-model">
<h2>TESPy model<a class="headerlink" href="#tespy-model" title="Permalink to this heading">#</a></h2>
<p>In principle, the GCHP-model corresponds to the flowsheet shown above.
The heating system and the geothermal heat collector can be modeled as sources
and sinks, which represent the feed and the return flow in both cases.
The condenser is modeled as <code class="code docutils literal notranslate"><span class="pre">Condenser</span></code> instance, while the evaporator
is modeled using <code class="code docutils literal notranslate"><span class="pre">HeatExchanger</span></code> instance. In total, the TESPy model
consists of 11 components.</p>
<p>In real systems, the circulating brine in the geothermal collector usually
consists of a mixture of water and antifreeze. Since the calculation with
mixtures of incompressible fluids is not yet fully implemented in TESPy, pure
water is used as the circulating fluid in this network. In fact, some
geothermal collectors are filled with water, provided that the ground
temperature is high enough throughout the year, such as in <span id="id3">[<a class="reference internal" href="../zliterature.html#id25" title="Xiao Chen and Xiaoli Hao. Exergy analysis of a ground-coupled heat pump heating system with different terminals. Entropy, 17(4):2328–2340, 2015. doi:10.3390/e17042328.">2</a>]</span>.</p>
<p>The following parameter specifications were made for the design case
calculation:</p>
<ul class="simple">
<li><p>isentropic efficiency values</p></li>
<li><p>electrical conversion efficiencies of compressor and pumps</p></li>
<li><p>terminal temperature difference values at condenser and evaporator</p></li>
<li><p>pressure losses in condenser and evaporator</p></li>
<li><p>hot and cold side heat transfer coefficients of evaporator</p></li>
<li><p>temperature difference to boiling point of refrigerant at compressor inlet</p></li>
<li><p>temperatures and pressure of heating system feed and return flow</p></li>
<li><p>temperatures and pressure of geothermal heat collector feed and return flow</p></li>
<li><p>condenser heat output</p></li>
</ul>
<p>The model using NH3 as refrigerant and the model using R410A as refrigerant
differ in the fluid definition, the naming of the stored files and the
specification of the starting values only. The definition of the starting
values is necessary to obtain a numerical solution for the first calculation.
In this tutorial, the given code examples are shown exemplary for the model
with NH3 as refrigerant only.</p>
<p>The units used and the ambient state are defined as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nw</span> <span class="o">=</span> <span class="n">Network</span><span class="p">(</span>
    <span class="n">fluids</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;water&#39;</span><span class="p">,</span> <span class="s1">&#39;NH3&#39;</span><span class="p">],</span> <span class="n">T_unit</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">p_unit</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span>
    <span class="n">h_unit</span><span class="o">=</span><span class="s1">&#39;kJ / kg&#39;</span><span class="p">,</span> <span class="n">m_unit</span><span class="o">=</span><span class="s1">&#39;kg / s&#39;</span>
<span class="p">)</span>

<span class="n">pamb</span> <span class="o">=</span> <span class="mf">1.013</span>
<span class="n">Tamb</span> <span class="o">=</span> <span class="mf">2.8</span>
</pre></div>
</div>
<p>For the model using R410A as refrigerant, the fluid definition is accordingly
<code class="code docutils literal notranslate"><span class="pre">'R410A'</span></code> instead of <code class="code docutils literal notranslate"><span class="pre">'NH3'</span></code>.</p>
<p>The temperature of the heating system feed flow is set to 40°C in design
calculation. The difference between feed and return flow temperature is kept
constant at 5°C. Therefore the return flow is set to 35°C.</p>
<p>The geothermal heat collector temperature is defined as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Tgeo</span> <span class="o">=</span> <span class="mf">9.5</span>
</pre></div>
</div>
<p><code class="code docutils literal notranslate"><span class="pre">Tgeo</span></code> is the mean geothermal temperature. The difference between
feed and return flow temperature is kept constant at 3°C. Therefore, the feed
flow temperature in the design calculation is set to <code class="code docutils literal notranslate"><span class="pre">Tgeo</span> <span class="pre">+</span> <span class="pre">1.5°C</span></code> and
the return flow temperature is set to <code class="code docutils literal notranslate"><span class="pre">Tgeo</span> <span class="pre">-</span> <span class="pre">1.5°C</span></code>.</p>
<p>The complete Python code of the TESPy models is available in the scripts
<a class="reference download internal" download="" href="../_downloads/fad839eda6800074d0730f4875601fef/NH3.py"><code class="xref download docutils literal notranslate"><span class="pre">NH3.py</span></code></a> with NH3 as
refrigerant and <a class="reference download internal" download="" href="../_downloads/8f794e535e158b5d76450ff4798e70c0/R410A.py"><code class="xref download docutils literal notranslate"><span class="pre">R410A.py</span></code></a>
with R410A as refrigerant. All other specified values of the component and
connection parameters can be found in these Python scripts.</p>
<p>In the scripts
<a class="reference download internal" download="" href="../_downloads/db21a5faf1e560bd813f001ecee6b166/NH3_calculations.py"><code class="xref download docutils literal notranslate"><span class="pre">NH3_calculations.py</span></code></a> and
<a class="reference download internal" download="" href="../_downloads/679f6844f13eafe9fd822ed580220eb0/R410A_calculations.py"><code class="xref download docutils literal notranslate"><span class="pre">R410A_calculations.py</span></code></a>,
the Python code of the TESPy models of the GCHP is extended to handle the
different tasks mentioned in the introduction. In these two scripts you can
find the corresponding Python code for all calculations that will be presented
in the next sections of the tutorial. As previously mentioned, the given code
examples in the following are only shown exemplary for the GCHP with NH3 as
refrigerant. If the scripts differ beyond the mentioned points, it will be
pointed out at the respective place of the tutorial.</p>
</div>
<div class="section" id="h-log-p-diagram">
<h2>h-log(p)-diagram<a class="headerlink" href="#h-log-p-diagram" title="Permalink to this heading">#</a></h2>
<p>At first, we will have a short look at the h-log(p)-diagram of the process,
exemplary for NH3 as working fluid. Such diagrams are useful to better
understand a process, therefore we will quickly present how to generate it
using TESPy with fluprodia. For more information and installation
instructions for fluprodia please have a look at the
<a class="reference external" href="https://fluprodia.readthedocs.io/en/latest/">online documentation</a>.</p>
<p>The data for the diagram are first saved in a dictionary <code class="code docutils literal notranslate"><span class="pre">result_dict</span></code>
using the <code class="code docutils literal notranslate"><span class="pre">get_plotting_data</span></code> method of each component that is to be
visualized.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fluprodia</span> <span class="kn">import</span> <span class="n">FluidPropertyDiagram</span>

<span class="n">result_dict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">result_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">ev</span><span class="o">.</span><span class="n">label</span> <span class="p">:</span> <span class="n">ev</span><span class="o">.</span><span class="n">get_plotting_data</span><span class="p">()[</span><span class="mi">2</span><span class="p">]})</span>
<span class="n">result_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">cp</span><span class="o">.</span><span class="n">label</span> <span class="p">:</span> <span class="n">cp</span><span class="o">.</span><span class="n">get_plotting_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">]})</span>
<span class="n">result_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">cd</span><span class="o">.</span><span class="n">label</span> <span class="p">:</span> <span class="n">cd</span><span class="o">.</span><span class="n">get_plotting_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">]})</span>
<span class="n">result_dict</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">va</span><span class="o">.</span><span class="n">label</span> <span class="p">:</span> <span class="n">va</span><span class="o">.</span><span class="n">get_plotting_data</span><span class="p">()[</span><span class="mi">1</span><span class="p">]})</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The first level key of the nested dictionary returned from the
<code class="code docutils literal notranslate"><span class="pre">get_plotting_data</span></code> method contains the connection id of the state
change. Make sure you specify the correct id for the components to be
displayed. A table of the state change and the respective id can be found
<a class="reference internal" href="../modules/fluid_properties.html#fluprodia-label"><span class="std std-ref">here</span></a>.</p>
</div>
<p>Next, a <code class="code docutils literal notranslate"><span class="pre">FluidPropertyDiagram</span></code> instance is created and the units of the
diagram are specified.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">diagram</span> <span class="o">=</span> <span class="n">FluidPropertyDiagram</span><span class="p">(</span><span class="s1">&#39;NH3&#39;</span><span class="p">)</span>
<span class="n">diagram</span><span class="o">.</span><span class="n">set_unit_system</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="s1">&#39;°C&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="s1">&#39;kJ/kg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Afterwards, the dictionary can be passed to the <code class="code docutils literal notranslate"><span class="pre">calc_individual_isoline</span></code>
method of the <code class="code docutils literal notranslate"><span class="pre">FluidPropertyDiagram</span></code> object. In addition, the axis
limits are set. The <code class="code docutils literal notranslate"><span class="pre">calc_isolines</span></code> method calculates all isolines of the
diagram and the <code class="code docutils literal notranslate"><span class="pre">draw_isolines</span></code> method draws the isolines of the
specified type. Finally, the results can be plotted and the diagram can be
saved with the code shown below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">result_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">result_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;datapoints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">diagram</span><span class="o">.</span><span class="n">calc_individual_isoline</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>

<span class="n">diagram</span><span class="o">.</span><span class="n">set_limits</span><span class="p">(</span><span class="n">x_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_max</span><span class="o">=</span><span class="mi">2100</span><span class="p">,</span> <span class="n">y_min</span><span class="o">=</span><span class="mf">1e0</span><span class="p">,</span> <span class="n">y_max</span><span class="o">=</span><span class="mf">2e2</span><span class="p">)</span>
<span class="n">diagram</span><span class="o">.</span><span class="n">calc_isolines</span><span class="p">()</span>
<span class="n">diagram</span><span class="o">.</span><span class="n">draw_isolines</span><span class="p">(</span><span class="s1">&#39;logph&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">result_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">datapoints</span> <span class="o">=</span> <span class="n">result_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;datapoints&#39;</span><span class="p">]</span>
    <span class="n">diagram</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">datapoints</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">],</span><span class="n">datapoints</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#ff0000&#39;</span><span class="p">)</span>
    <span class="n">diagram</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">datapoints</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">datapoints</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#ff0000&#39;</span><span class="p">)</span>

<span class="n">diagram</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;NH3_logph.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="id6">
<img alt="Fluid Property Diagram h-log(p) of the GCHP" src="../_images/NH3_logph.svg" /><p class="caption"><span class="caption-text">Figure: h-log(p) diagram of the NH3 GCHP.</span><a class="headerlink" href="#id6" title="Permalink to this image">#</a></p>
</div>
<p>The resulting fluid property diagram is shown in the figure above. It can
easily be seen, that the evaporator slightly overheats the working fluid, while
the it leaves the condenser in saturated liquid state. The working fluid
temperature after leaving the compressor is quite high with far more than
100 °C given the heat sink only requires a temperature of only 40 °C. In
comparison, the R410A leaves the compressor at about 75 °C.</p>
<p>More examples of creating fluid property diagrams can be found in the fluprodia
documentation referenced above.</p>
</div>
<div class="section" id="exergy-analysis">
<h2>Exergy analysis<a class="headerlink" href="#exergy-analysis" title="Permalink to this heading">#</a></h2>
<p>Following, the main tasks of this tutorial are presented. First, the exergy
analysis is set up for the respective network and carried out for the base
case. Subsequently, the influence of different parameters such as temperature
of the heat source and sink as well as ambient temperature and part load
operation of the heat pump regarding exergetic efficiency are investigated.</p>
<div class="section" id="analysis-setup">
<h3>Analysis setup<a class="headerlink" href="#analysis-setup" title="Permalink to this heading">#</a></h3>
<p>After the network has been built, the exergy analysis can be set up. For this
purpose, all exergy flows entering and leaving the network must be defined.
The exergy flows are defined as a list of busses as follows:</p>
<ul class="simple">
<li><p>fuel exergy <code class="code docutils literal notranslate"><span class="pre">E_F</span></code></p></li>
<li><p>product exergy <code class="code docutils literal notranslate"><span class="pre">E_P</span></code></p></li>
<li><p>exergy loss streams <code class="code docutils literal notranslate"><span class="pre">E_L</span></code></p></li>
<li><p>internal exergy streams not bound to connections <code class="code docutils literal notranslate"><span class="pre">internal_busses</span></code></p></li>
</ul>
<p>First, the busses for the exergy analysis must be defined. The first bus is
for the electrical energy supply of the compressor and the pumps. The motor
efficiency is calculated by a characteristic line. This power input bus
represents fuel exergy.</p>
<p>The product exergy is the heat supply of the condenser to the heating system,
which is represented by the heating system bus. The bus consists of the
streams <code class="code docutils literal notranslate"><span class="pre">hs_ret</span></code> and <code class="code docutils literal notranslate"><span class="pre">hs_feed</span></code>. Note that the <code class="code docutils literal notranslate"><span class="pre">base</span></code>
keyword of the stream entering the network <code class="code docutils literal notranslate"><span class="pre">hs_ret</span></code> must be set to
<code class="code docutils literal notranslate"><span class="pre">bus</span></code>.</p>
<p>Lastly, the geothermal heat bus represents the heat that is transferred from
the geothermal heat collector to the evaporator. The bus consists of the
streams <code class="code docutils literal notranslate"><span class="pre">gh_in</span></code> and <code class="code docutils literal notranslate"><span class="pre">gh_out</span></code>. Here, the <code class="code docutils literal notranslate"><span class="pre">base</span></code> of the stream
<code class="code docutils literal notranslate"><span class="pre">gh_in</span></code> is set to <code class="code docutils literal notranslate"><span class="pre">bus</span></code>, because this stream represents an energy
input from outside of the network. In this example, the geothermal heat bus is
defined as fuel exergy, because the ambient temperature <code class="code docutils literal notranslate"><span class="pre">Tamb</span></code> is set at
a lower temperature than the temperature of the geothermal heat collector.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.86</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.93</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.96</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>

<span class="n">char</span> <span class="o">=</span> <span class="n">CharLine</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="n">power</span> <span class="o">=</span> <span class="n">Bus</span><span class="p">(</span><span class="s1">&#39;power input&#39;</span><span class="p">)</span>
<span class="n">power</span><span class="o">.</span><span class="n">add_comps</span><span class="p">({</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">cp</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="n">char</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">ghp</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="n">char</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span>
                <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">hsp</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="n">char</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">})</span>

<span class="n">heat_cons</span> <span class="o">=</span> <span class="n">Bus</span><span class="p">(</span><span class="s1">&#39;heating system&#39;</span><span class="p">)</span>
<span class="n">heat_cons</span><span class="o">.</span><span class="n">add_comps</span><span class="p">({</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">hs_ret</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">hs_feed</span><span class="p">})</span>

<span class="n">heat_geo</span> <span class="o">=</span> <span class="n">Bus</span><span class="p">(</span><span class="s1">&#39;geothermal heat&#39;</span><span class="p">)</span>
<span class="n">heat_geo</span><span class="o">.</span><span class="n">add_comps</span><span class="p">({</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">gh_in</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">:</span> <span class="s1">&#39;bus&#39;</span><span class="p">},</span>
                   <span class="p">{</span><span class="s1">&#39;comp&#39;</span><span class="p">:</span> <span class="n">gh_out</span><span class="p">})</span>

<span class="n">nw</span><span class="o">.</span><span class="n">add_busses</span><span class="p">(</span><span class="n">power</span><span class="p">,</span> <span class="n">heat_cons</span><span class="p">,</span> <span class="n">heat_geo</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to carry out the exergy analysis an <code class="code docutils literal notranslate"><span class="pre">ExergyAnalysis</span></code> instance
passing the network to analyse as well as the respective busses is created.
The product exergy is represented by the bus <code class="code docutils literal notranslate"><span class="pre">power</span></code>. The busses
<code class="code docutils literal notranslate"><span class="pre">heat_cons</span></code> and <code class="code docutils literal notranslate"><span class="pre">heat_geo</span></code> are passed as fuel exergy.
In the example of the GCHP, only <code class="code docutils literal notranslate"><span class="pre">E_F</span></code> and <code class="code docutils literal notranslate"><span class="pre">E_P</span></code> are defined.
Other examples of exergy analysis setup can be found in the
<a class="reference internal" href="../advanced/exergy.html#tespy-advanced-exergy-label"><span class="std std-ref">TESPy analysis</span></a> page and in the API
documentation of class <a class="reference internal" href="../api/tools.html#tespy.tools.analyses.ExergyAnalysis" title="tespy.tools.analyses.ExergyAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">tespy.tools.analyses.ExergyAnalysis</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ean</span> <span class="o">=</span> <span class="n">ExergyAnalysis</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">nw</span><span class="p">,</span>
                     <span class="n">E_F</span><span class="o">=</span><span class="p">[</span><span class="n">power</span><span class="p">,</span> <span class="n">heat_geo</span><span class="p">],</span>
                     <span class="n">E_P</span><span class="o">=</span><span class="p">[</span><span class="n">heat_cons</span><span class="p">])</span>

<span class="n">ean</span><span class="o">.</span><span class="n">analyse</span><span class="p">(</span><span class="n">pamb</span><span class="p">,</span> <span class="n">Tamb</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../api/tools.html#tespy.tools.analyses.ExergyAnalysis.analyse" title="tespy.tools.analyses.ExergyAnalysis.analyse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tespy.tools.analyses.ExergyAnalysis.analyse()</span></code></a> method will run the
exergy analysis automatically. This method expects information about the
ambient pressure and ambient temperature. Additionally, an automatic check of
consistency is performed by the analysis as further described in
<a class="reference internal" href="../advanced/exergy.html#tespy-advanced-exergy-label"><span class="std std-ref">TESPy analysis</span></a>.</p>
</div>
<div class="section" id="results">
<h3>Results<a class="headerlink" href="#results" title="Permalink to this heading">#</a></h3>
<p>The results can be printed by using the
<a class="reference internal" href="../api/tools.html#tespy.tools.analyses.ExergyAnalysis.print_results" title="tespy.tools.analyses.ExergyAnalysis.print_results"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tespy.tools.analyses.ExergyAnalysis.print_results()</span></code></a> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ean</span><span class="o">.</span><span class="n">print_results</span><span class="p">()</span>
</pre></div>
</div>
<p>Further descriptions of which tables are printed and how to select what is
printed can be found in the <a class="reference internal" href="../advanced/exergy.html#tespy-advanced-exergy-label"><span class="std std-ref">TESPy analysis section</span></a>.
There you can also find more detailed descriptions of how to access the
underlying data for the tabular printouts, which are stored in
<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/dsintro.html">pandas DataFrames</a>.</p>
<p>With the <a class="reference external" href="https://plotly.com/">plotly</a> library installed, the results can
also be displayed in a <a class="reference external" href="https://plotly.com/python/sankey-diagram/">sankey diagram</a>.
The <a class="reference internal" href="../api/tools.html#tespy.tools.analyses.ExergyAnalysis.generate_plotly_sankey_input" title="tespy.tools.analyses.ExergyAnalysis.generate_plotly_sankey_input"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tespy.tools.analyses.ExergyAnalysis.generate_plotly_sankey_input()</span></code></a>
method returns a dictionary containing links and nodes for the sankey diagram.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">links</span><span class="p">,</span> <span class="n">nodes</span> <span class="o">=</span> <span class="n">ean</span><span class="o">.</span><span class="n">generate_plotly_sankey_input</span><span class="p">()</span>
 <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Sankey</span><span class="p">(</span>
     <span class="n">arrangement</span><span class="o">=</span><span class="s2">&quot;snap&quot;</span><span class="p">,</span>
     <span class="n">node</span><span class="o">=</span><span class="p">{</span>
         <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">nodes</span><span class="p">,</span>
         <span class="s1">&#39;pad&#39;</span><span class="p">:</span> <span class="mi">11</span><span class="p">,</span>
         <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;orange&#39;</span><span class="p">},</span>
     <span class="n">link</span><span class="o">=</span><span class="n">links</span><span class="p">))</span>
 <span class="n">plot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s1">&#39;NH3_sankey&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="id7">
<img alt="Sankey diagram of the Ground-Coupled Heat Pump (GCHP)" src="../_images/NH3_sankey.svg" /><p class="caption"><span class="caption-text">Figure: Sankey diagram of the GCHP (open in
new tab to enlarge).</span><a class="headerlink" href="#id7" title="Permalink to this image">#</a></p>
</div>
<p>In the figure above you can see the sankey diagram which is created by running
the script of the GCHP with NH3 as refrigerant. Information about, for example,
the colors used or the node order can be found in the
<a class="reference internal" href="../advanced/exergy.html#tespy-advanced-exergy-label"><span class="std std-ref">TESPy analysis section</span></a>.</p>
</div>
</div>
<div class="section" id="post-processing">
<h2>Post-Processing<a class="headerlink" href="#post-processing" title="Permalink to this heading">#</a></h2>
<p>Below, different possibilities of post-processing and visualization of the
exergy analysis results will be presented. The following issues will be
considered:</p>
<ul class="simple">
<li><p>plot exergy destruction</p></li>
<li><p>varying ambient and geothermal temperature</p></li>
<li><p>varying geothermal and heating system temperature</p></li>
<li><p>varying heating load and geothermal temperature</p></li>
</ul>
<p>In order to be able to compare the results of the two refrigerants NH3 and
R410A, plots of the results of the mentioned issues are created in a separate
plot script <a class="reference download internal" download="" href="../_downloads/7451d0293b6af458b13365fc14bd3992/plots.py"><code class="xref download docutils literal notranslate"><span class="pre">plots.py</span></code></a>. The plots in this
tutorial are created with <a class="reference external" href="https://matplotlib.org/">Matplotlib</a>. For
installation instructions or further documentation please see the Matplotlib
documentation.</p>
<p>For the post-processing, the following additional packages
are required:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="section" id="plot-exergy-destruction">
<h3>Plot exergy destruction<a class="headerlink" href="#plot-exergy-destruction" title="Permalink to this heading">#</a></h3>
<p>In order to visualize how much exergy of the fuel exergy <code class="code docutils literal notranslate"><span class="pre">E_F</span></code> the
individual components of the GCHP destroy, the exergy destruction <code class="code docutils literal notranslate"><span class="pre">E_D</span></code>
can be displayed in a bar chart as shown at the end of this section.</p>
<p>To create this diagram, the required data for the diagram must first be
handled. As shown below, the three lists <code class="code docutils literal notranslate"><span class="pre">comps</span></code>, <code class="code docutils literal notranslate"><span class="pre">E_D</span></code> and
<code class="code docutils literal notranslate"><span class="pre">E_P</span></code> are created and first filled with the values for the top bar. A
loop is then used to add all component labels to the list <code class="code docutils literal notranslate"><span class="pre">comps</span></code> that
destroy a noticeable amount of exergy (&gt; 1W).  The list <code class="code docutils literal notranslate"><span class="pre">E_D</span></code> contains
the corresponding values of the destroyed exergy. List <code class="code docutils literal notranslate"><span class="pre">E_P</span></code>, in turn,
contains the value of the exergy that remains after subtracting the destroyed
exergy from the fuel exergy.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">comps</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;E_F&#39;</span><span class="p">]</span>
<span class="n">E_F</span> <span class="o">=</span> <span class="n">ean</span><span class="o">.</span><span class="n">network_data</span><span class="o">.</span><span class="n">E_F</span>
<span class="n">E_D</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">E_P</span> <span class="o">=</span> <span class="p">[</span><span class="n">E_F</span><span class="p">]</span>
<span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">ean</span><span class="o">.</span><span class="n">component_data</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="c1"># only plot components with exergy destruction &gt; 1 W</span>
    <span class="k">if</span> <span class="n">ean</span><span class="o">.</span><span class="n">component_data</span><span class="o">.</span><span class="n">E_D</span><span class="p">[</span><span class="n">comp</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">:</span>
        <span class="n">comps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp</span><span class="p">)</span>
        <span class="n">E_D</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ean</span><span class="o">.</span><span class="n">component_data</span><span class="o">.</span><span class="n">E_D</span><span class="p">[</span><span class="n">comp</span><span class="p">])</span>
        <span class="n">E_F</span> <span class="o">=</span> <span class="n">E_F</span><span class="o">-</span><span class="n">ean</span><span class="o">.</span><span class="n">component_data</span><span class="o">.</span><span class="n">E_D</span><span class="p">[</span><span class="n">comp</span><span class="p">]</span>
        <span class="n">E_P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_F</span><span class="p">)</span>
<span class="n">comps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;E_P&quot;</span><span class="p">)</span>
<span class="n">E_D</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">E_P</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E_F</span><span class="p">)</span>
</pre></div>
</div>
<p>With regard to the bar chart to be created, the filled lists are then saved in
a panda DataFrame and exported to a <code class="code docutils literal notranslate"><span class="pre">.csv</span></code> file. Exporting the data is
necessary in order to be able to use the results of the two scripts of the
different refrigerants NH3 and R410A in a separate script.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_comps</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="n">comps</span><span class="p">)</span>
<span class="n">df_comps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;E_D&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E_D</span>
<span class="n">df_comps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;E_P&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">E_P</span>
<span class="n">df_comps</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;NH3_E_D.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to be able to use the data from the data frames in a separate
script for plot creation, all data frames must be saved as a file with
their own individual name.</p>
</div>
<p>In the separate plot script
(<a class="reference download internal" download="" href="../_downloads/7451d0293b6af458b13365fc14bd3992/plots.py"><code class="xref download docutils literal notranslate"><span class="pre">plots.py</span></code></a>) the
<code class="code docutils literal notranslate"><span class="pre">.csv</span></code> files can now be re-imported to create plots with Matplotlib. The
Python code for creating the bar chart is included in the previously
referenced plot script and can be found there. For more information on
creating plots with Matplotlib, please check the
<a class="reference external" href="https://matplotlib.org/">Matplotlib documentation</a>. The resulting bar chart
is shown below.</p>
<div class="only-light figure align-center" id="id8">
<img alt="Comparison of exergy destruction and exergy efficiency" src="../_images/diagram_E_D.svg" /><p class="caption"><span class="caption-text">Figure: Comparison of exergy destruction and exergy efficiency of both
working fluids in design case.</span><a class="headerlink" href="#id8" title="Permalink to this image">#</a></p>
</div>
<div class="only-dark figure align-center" id="id9">
<img alt="Comparison of exergy destruction and exergy efficiency" src="../_images/diagram_E_D_darkmode.svg" /><p class="caption"><span class="caption-text">Figure: Comparison of exergy destruction and exergy efficiency of both
working fluids in design case.</span><a class="headerlink" href="#id9" title="Permalink to this image">#</a></p>
</div>
<p>The bar chart shows how much exergy the individual components of the GCHP
destroy in absolute terms and as a percentage of the fuel exergy <code class="code docutils literal notranslate"><span class="pre">E_F</span></code>.
After deducting the destroyed exergy <code class="code docutils literal notranslate"><span class="pre">E_D</span></code>, the product exergy
<code class="code docutils literal notranslate"><span class="pre">E_P</span></code> remains. Overall, it is noticeable that the GCHP with NH3 requires
less fuel exergy than the GCHP with R410A, with the same amount of product
exergy. Furthermore, with NH3 the condenser has the highest exergy destruction,
whereas with R410A the valve destroys the largest amount of exergy.</p>
</div>
<div class="section" id="varying-ambient-and-geothermal-temperature">
<h3>Varying ambient and geothermal temperature<a class="headerlink" href="#varying-ambient-and-geothermal-temperature" title="Permalink to this heading">#</a></h3>
<p>In order to consider the influence of a change in ambient temperature or
geothermal temperature on the exergetic efficiency, offdesign calculations are
performed with different values of these parameters. The first step is to
create dataframes as shown below. The ambient temperature <code class="code docutils literal notranslate"><span class="pre">Tamb</span></code>
is varied between 1°C and 20°C. The mean geothermal temperature <code class="code docutils literal notranslate"><span class="pre">Tgeo</span></code>
is varied between 11.5°C and 6.5°C. Note that the geothermal temperature
<code class="code docutils literal notranslate"><span class="pre">Tgeo</span></code> is given as a mean value of the feed an return flow temperatures,
as described in the beginning of this tutorial.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Tamb_design</span> <span class="o">=</span> <span class="n">Tamb</span>
<span class="n">Tgeo_design</span> <span class="o">=</span> <span class="n">Tgeo</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># create data ranges and frames</span>
<span class="n">Tamb_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span>
<span class="n">Tgeo_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">11.5</span><span class="p">,</span> <span class="mf">10.5</span><span class="p">,</span> <span class="mf">9.5</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">])</span>
<span class="n">df_eps_Tamb</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="n">Tamb_range</span><span class="p">)</span>
<span class="n">df_eps_Tgeo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="n">Tgeo_range</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, the exergetic efficiency epsilon can be calculated for the different
values of <code class="code docutils literal notranslate"><span class="pre">Tamb</span></code> in <code class="code docutils literal notranslate"><span class="pre">Tamb_range</span></code> by calling the
<a class="reference internal" href="../api/tools.html#tespy.tools.analyses.ExergyAnalysis.analyse" title="tespy.tools.analyses.ExergyAnalysis.analyse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tespy.tools.analyses.ExergyAnalysis.analyse()</span></code></a> method in a loop. The
results are saved in the created dataframe and exported to a .csv file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate epsilon depending on Tamb</span>
<span class="n">eps_Tamb</span> <span class="o">=</span> <span class="p">[]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Varying ambient temperature:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">Tamb</span> <span class="ow">in</span> <span class="n">Tamb_range</span><span class="p">:</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">ean</span><span class="o">.</span><span class="n">analyse</span><span class="p">(</span><span class="n">pamb</span><span class="p">,</span> <span class="n">Tamb</span><span class="p">)</span>
    <span class="n">eps_Tamb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ean</span><span class="o">.</span><span class="n">network_data</span><span class="o">.</span><span class="n">epsilon</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Case </span><span class="si">%d</span><span class="s2">: Tamb = </span><span class="si">%.1f</span><span class="s2"> °C&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">Tamb</span><span class="p">))</span>

<span class="c1"># save to data frame</span>
<span class="n">df_eps_Tamb</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Tgeo_design</span><span class="p">]</span> <span class="o">=</span> <span class="n">eps_Tamb</span>
<span class="n">df_eps_Tamb</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;NH3_eps_Tamb.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If only the ambient state (temperature or pressure) changes, there is no
need to create a new <code class="code docutils literal notranslate"><span class="pre">ExergyAnalysis</span></code> instance. Instead, you can
simply call the <a class="reference internal" href="../api/tools.html#tespy.tools.analyses.ExergyAnalysis.analyse" title="tespy.tools.analyses.ExergyAnalysis.analyse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tespy.tools.analyses.ExergyAnalysis.analyse()</span></code></a>
method with the new ambient state. A new instance only needs to be created
when there are changes in the topology of the network.</p>
</div>
<p>The following calculation of the network with different geothermal mean
temperatures is carried out as an offdesign calculation. Again, no new
<code class="code docutils literal notranslate"><span class="pre">ExergyAnalysis</span></code> instance needs to be created. The ambient temperature
<code class="code docutils literal notranslate"><span class="pre">Tamb</span></code> is reset to the design value.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate epsilon depending on Tgeo</span>
<span class="n">eps_Tgeo</span> <span class="o">=</span> <span class="p">[]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Varying mean geothermal temperature:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">Tgeo</span> <span class="ow">in</span> <span class="n">Tgeo_range</span><span class="p">:</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c1"># set feed and return flow temperatures around mean value Tgeo</span>
    <span class="n">gh_in_ghp</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">Tgeo</span><span class="o">+</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ev_gh_out</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">Tgeo</span><span class="o">-</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">nw</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s1">&#39;offdesign&#39;</span><span class="p">,</span> <span class="n">init_path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">design_path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
    <span class="n">ean</span><span class="o">.</span><span class="n">analyse</span><span class="p">(</span><span class="n">pamb</span><span class="p">,</span> <span class="n">Tamb_design</span><span class="p">)</span>
    <span class="n">eps_Tgeo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ean</span><span class="o">.</span><span class="n">network_data</span><span class="o">.</span><span class="n">epsilon</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Case </span><span class="si">%d</span><span class="s2">: Tgeo = </span><span class="si">%.1f</span><span class="s2"> °C&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">Tgeo</span><span class="p">))</span>

<span class="c1"># save to data frame</span>
<span class="n">df_eps_Tgeo</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Tamb_design</span><span class="p">]</span> <span class="o">=</span> <span class="n">eps_Tgeo</span>
<span class="n">df_eps_Tgeo</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;NH3_eps_Tgeo.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The results of the calculation can be plotted as shown in the following
figure. The related Python code to create this plot can be found in the plot
script (<a class="reference download internal" download="" href="../_downloads/7451d0293b6af458b13365fc14bd3992/plots.py"><code class="xref download docutils literal notranslate"><span class="pre">plots.py</span></code></a>). For
further documentation please see the <a class="reference external" href="https://matplotlib.org/">Matplotlib</a>
documentation.</p>
<div class="only-light figure align-center" id="id10">
<img alt="Varying Tamb and Tgeo of the GCHP" src="../_images/diagram_eps_Tamb_Tgeo.svg" /><p class="caption"><span class="caption-text">Figure: Varying ambient and geothermal temperature.</span><a class="headerlink" href="#id10" title="Permalink to this image">#</a></p>
</div>
<div class="only-dark figure align-center" id="id11">
<img alt="Varying Tamb and Tgeo of the GCHP" src="../_images/diagram_eps_Tamb_Tgeo_darkmode.svg" /><p class="caption"><span class="caption-text">Figure: Varying ambient and geothermal temperature.</span><a class="headerlink" href="#id11" title="Permalink to this image">#</a></p>
</div>
<p>It can be recognized that the specified ambient temperature <code class="code docutils literal notranslate"><span class="pre">Tamb</span></code> used
in the <code class="code docutils literal notranslate"><span class="pre">analyse</span></code> method of the <code class="code docutils literal notranslate"><span class="pre">ExergyAnalysis</span></code> instance has a
considerable influence on the exergetic efficiency epsilon. The closer the
ambient temperature is to the temperature of the heating system, the lower the
exergetic efficiency. This can be argued from the fact that while <code class="code docutils literal notranslate"><span class="pre">E_F</span></code>
and <code class="code docutils literal notranslate"><span class="pre">E_P</span></code> both decrease with increasing <code class="code docutils literal notranslate"><span class="pre">Tamb</span></code>, <code class="code docutils literal notranslate"><span class="pre">E_P</span></code>
decreases proportionally more than <code class="code docutils literal notranslate"><span class="pre">E_F</span></code>. In comparison, it can be seen
on the right that with increasing <code class="code docutils literal notranslate"><span class="pre">Tgeo</span></code>, and thus decreasing
temperature difference between geothermal heat collector and heating system,
epsilon increases. This can be explained by the resulting decrease in
<code class="code docutils literal notranslate"><span class="pre">E_F</span></code> with <code class="code docutils literal notranslate"><span class="pre">E_P</span></code> remaining constant.</p>
</div>
<div class="section" id="varying-geothermal-and-heating-system-temperature">
<h3>Varying geothermal and heating system temperature<a class="headerlink" href="#varying-geothermal-and-heating-system-temperature" title="Permalink to this heading">#</a></h3>
<p>Another relation that can be investigated is the influence of a change in the
geothermal and the heating system temperatures on the exergetic efficiency and
the COP of the GCHP. Again, the first step is to create data frames. In this
calculation <code class="code docutils literal notranslate"><span class="pre">Tgeo</span></code> is varied between 10.5°C and 6.5°C. The heating
system temperature <code class="code docutils literal notranslate"><span class="pre">Ths</span></code> is varied between 42.5°C and 32.5°C. As before,
all temperature values are mean values of the feed and return flow
temperatures.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create data ranges and frames</span>
<span class="n">Tgeo_range</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.5</span><span class="p">,</span> <span class="mf">8.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">]</span>
<span class="n">Ths_range</span> <span class="o">=</span> <span class="p">[</span><span class="mf">42.5</span><span class="p">,</span> <span class="mf">37.5</span><span class="p">,</span> <span class="mf">32.5</span><span class="p">]</span>
<span class="n">df_eps_Tgeo_Ths</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="n">Ths_range</span><span class="p">)</span>
<span class="n">df_cop_Tgeo_Ths</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="n">Ths_range</span><span class="p">)</span>
</pre></div>
</div>
<p>The values of <code class="code docutils literal notranslate"><span class="pre">Tgeo</span></code> and <code class="code docutils literal notranslate"><span class="pre">Ths</span></code> are varied simultaneously within
the specified range and again the exergetic efficiency is calculated. In
addition, the COP is calculated for each parameter combination. The data is
stored in two dataframes with the range of <code class="code docutils literal notranslate"><span class="pre">Tgeo</span></code> as rows and the range
of <code class="code docutils literal notranslate"><span class="pre">Ths</span></code> as columns.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate epsilon and COP</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Varying mean geothermal temperature and &quot;</span><span class="o">+</span>
      <span class="s2">&quot;heating system temperature:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">Tgeo</span> <span class="ow">in</span> <span class="n">Tgeo_range</span><span class="p">:</span>
    <span class="c1"># set feed and return flow temperatures around mean value Tgeo</span>
    <span class="n">gh_in_ghp</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">Tgeo</span><span class="o">+</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">ev_gh_out</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">Tgeo</span><span class="o">-</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cop</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">Ths</span> <span class="ow">in</span> <span class="n">Ths_range</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">cd_hs_feed</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">Ths</span><span class="o">+</span><span class="mf">2.5</span><span class="p">)</span>
        <span class="n">hs_ret_hsp</span><span class="o">.</span><span class="n">set_attr</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">Ths</span><span class="o">-</span><span class="mf">2.5</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Ths</span> <span class="o">==</span> <span class="n">Ths_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">nw</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s1">&#39;offdesign&#39;</span><span class="p">,</span> <span class="n">init_path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">design_path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nw</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s1">&#39;offdesign&#39;</span><span class="p">,</span> <span class="n">design_path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="n">ean</span><span class="o">.</span><span class="n">analyse</span><span class="p">(</span><span class="n">pamb</span><span class="p">,</span> <span class="n">Tamb_design</span><span class="p">)</span>
        <span class="n">epsilon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ean</span><span class="o">.</span><span class="n">network_data</span><span class="o">.</span><span class="n">epsilon</span><span class="p">)</span>
        <span class="n">cop</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">cd</span><span class="o">.</span><span class="n">Q</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">val</span> <span class="o">+</span> <span class="n">ghp</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">val</span> <span class="o">+</span> <span class="n">hsp</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">val</span><span class="p">)]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Case </span><span class="si">%d</span><span class="s2">: Tgeo = </span><span class="si">%.1f</span><span class="s2"> °C, Ths = </span><span class="si">%.1f</span><span class="s2"> °C&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">Tgeo</span><span class="p">,</span><span class="n">Ths</span><span class="p">))</span>

    <span class="c1"># save to data frame</span>
    <span class="n">df_eps_Tgeo_Ths</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Tgeo</span><span class="p">]</span> <span class="o">=</span> <span class="n">epsilon</span>
    <span class="n">df_cop_Tgeo_Ths</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Tgeo</span><span class="p">]</span> <span class="o">=</span> <span class="n">cop</span>

<span class="n">df_eps_Tgeo_Ths</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;NH3_eps_Tgeo_Ths.csv&#39;</span><span class="p">)</span>
<span class="n">df_cop_Tgeo_Ths</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;NH3_cop_Tgeo_Ths.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The results of this calculation are shown in the following figure. The
corresponding Python code can likewise be found in the plot script
(<a class="reference download internal" download="" href="../_downloads/7451d0293b6af458b13365fc14bd3992/plots.py"><code class="xref download docutils literal notranslate"><span class="pre">plots.py</span></code></a>).</p>
<div class="only-light figure align-center" id="id12">
<img alt="Varying Tgeo and Ths of the GCHP" src="../_images/diagram_cop_eps_Tgeo_Ths.svg" /><p class="caption"><span class="caption-text">Figure: Varying geothermal and heating system temperature.</span><a class="headerlink" href="#id12" title="Permalink to this image">#</a></p>
</div>
<div class="only-dark figure align-center" id="id13">
<img alt="Varying Tgeo and Ths of the GCHP" src="../_images/diagram_cop_eps_Tgeo_Ths_darkmode.svg" /><p class="caption"><span class="caption-text">Figure: Varying geothermal and heating system temperature.</span><a class="headerlink" href="#id13" title="Permalink to this image">#</a></p>
</div>
<p>It can be seen that the GCHP with NH3 has a better exergetic efficiency than
with R410A. As in the prior investigation, an increasing geothermal heat
collector temperature also has a favorable effect on epsilon. The opposite
behavior of epsilon and COP for both refrigerants is remarkable. The COP drops
while the exergetic efficiency rises. This can be explained by the fact that at
constant heating load <code class="code docutils literal notranslate"><span class="pre">Q</span></code>, the required electrical power input increases
as the heating system temperature rises. However regarding exergetic
efficiency, <code class="code docutils literal notranslate"><span class="pre">E_F</span></code> and <code class="code docutils literal notranslate"><span class="pre">E_P</span></code> both increase with increasing heating
system temperature. The ratio between these two parameters is such that
the exergetic efficiency improves as the heating system temperature rises.</p>
</div>
<div class="section" id="varying-geothermal-temperature-and-heating-load">
<h3>Varying geothermal temperature and heating load<a class="headerlink" href="#varying-geothermal-temperature-and-heating-load" title="Permalink to this heading">#</a></h3>
<p>Finally, the influence of the simultaneous variation of the geothermal
temperature <code class="code docutils literal notranslate"><span class="pre">Tgeo</span></code> and the heating load <code class="code docutils literal notranslate"><span class="pre">Q</span></code> on the exergetic
efficiency and the COP of the GCHP is examined. The investigation is carried
out in the same way as the variation of <code class="code docutils literal notranslate"><span class="pre">Tgeo</span></code> and <code class="code docutils literal notranslate"><span class="pre">Ths</span></code> described
above. In contrast to the previous investigation, <code class="code docutils literal notranslate"><span class="pre">Q</span></code> is varied here
instead of <code class="code docutils literal notranslate"><span class="pre">Ths</span></code>. The range of <code class="code docutils literal notranslate"><span class="pre">Q</span></code> varies between 4.3 and 2.8 kW.
The rated load was previously set at 4 kW in the design calculation. Due to the
similarity to the previous parameter variation, the corresponding Python code
is not presented, but can be found in the scripts linked at the beginning
instead.</p>
<div class="only-light figure align-center" id="id14">
<img alt="Varying Tgeo and Q of the GCHP" src="../_images/diagram_cop_eps_Tgeo_Q.svg" /><p class="caption"><span class="caption-text">Figure: Varying geothermal temperature and heat load.</span><a class="headerlink" href="#id14" title="Permalink to this image">#</a></p>
</div>
<div class="only-dark figure align-center" id="id15">
<img alt="Varying Tgeo and Q of the GCHP" src="../_images/diagram_cop_eps_Tgeo_Q_darkmode.svg" /><p class="caption"><span class="caption-text">Figure: Varying geothermal temperature and heat load.</span><a class="headerlink" href="#id15" title="Permalink to this image">#</a></p>
</div>
<p>The results are shown in the figure above. As before, the Python code for
creating the plot can be found in the plot script
(<a class="reference download internal" download="" href="../_downloads/7451d0293b6af458b13365fc14bd3992/plots.py"><code class="xref download docutils literal notranslate"><span class="pre">plots.py</span></code></a>).
The partial load behavior of the GCHP, which results from the characteristic
lines of the efficiencies of the individual components, can be recognized
in the curves shown.</p>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this heading">#</a></h2>
<p>This tutorial provides an exemplary insight into post-processing with the
TESPy exergy analysis tool. Of course, other parameters can also be examined
and varied. Feel free to try out different parameter variations. But make sure
that the data ranges are not only adjusted in the Python script of the model,
but also in the Python script of the plots, if a plot is created with the
stand-alone plot script.</p>
<p>More examples of exergy analysis can be found in the
<a class="reference internal" href="../advanced/exergy.html#tespy-advanced-exergy-label"><span class="std std-ref">TESPy analysis section</span></a> and in the API
documentation of the <a class="reference internal" href="../api/tools.html#tespy.tools.analyses.ExergyAnalysis" title="tespy.tools.analyses.ExergyAnalysis"><code class="xref py py-class docutils literal notranslate"><span class="pre">tespy.tools.analyses.ExergyAnalysis</span></code></a> class. If
you are interested in contributing or have questions and remarks on this
tutorial, you are welcome to file an issue at our GitHub page.</p>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="pygmo_optimization.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Thermal Power Plant Efficiency Optimization</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="starting_values.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">How to Generate Stable Starting Values</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Francesco Witte
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Oct 02, 2022</div>
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Exergy Analysis of a Ground-Coupled Heat Pump</a><ul>
<li><a class="reference internal" href="#task">Task</a></li>
<li><a class="reference internal" href="#tespy-model">TESPy model</a></li>
<li><a class="reference internal" href="#h-log-p-diagram">h-log(p)-diagram</a></li>
<li><a class="reference internal" href="#exergy-analysis">Exergy analysis</a><ul>
<li><a class="reference internal" href="#analysis-setup">Analysis setup</a></li>
<li><a class="reference internal" href="#results">Results</a></li>
</ul>
</li>
<li><a class="reference internal" href="#post-processing">Post-Processing</a><ul>
<li><a class="reference internal" href="#plot-exergy-destruction">Plot exergy destruction</a></li>
<li><a class="reference internal" href="#varying-ambient-and-geothermal-temperature">Varying ambient and geothermal temperature</a></li>
<li><a class="reference internal" href="#varying-geothermal-and-heating-system-temperature">Varying geothermal and heating system temperature</a></li>
<li><a class="reference internal" href="#varying-geothermal-temperature-and-heating-load">Varying geothermal temperature and heating load</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/design-tabs.js"></script>
    </body>
</html>