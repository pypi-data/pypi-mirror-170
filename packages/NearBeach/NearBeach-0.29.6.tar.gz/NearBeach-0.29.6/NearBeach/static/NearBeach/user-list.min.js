"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[1804],{7682:(e,s,t)=>{t.r(s),t.d(s,{default:()=>re});var o=t(6252),i=t(3577);const a={class:"card"},n={class:"card-body"},r=(0,o._)("h2",null,"User List",-1),l=(0,o._)("hr",null,null,-1),d={class:"row"},u={class:"col-md-4"},c=(0,o._)("strong",null,"List of Users",-1),m={text:"text-instructions"},p={class:"col-md-8"},h={class:"table"},_={key:0},g={key:1},f={key:2},v=(0,o._)("td",null,"Team Leader",-1),y={key:0},b={key:1},k={key:2},w={style:{"text-align":"center"}},U=["checked","onChange"],S=(0,o._)("hr",null,null,-1),M={class:"row"},L={class:"col-md-12"};var D=t(9909),q=t(3058);const E={class:"modal fade",id:"addUserModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"addUserModalLabel","aria-hidden":"true"},R={class:"modal-dialog modal-lg"},A={class:"modal-content"},I=(0,o._)("div",{class:"modal-header"},[(0,o._)("h5",{class:"modal-title",id:"addUserModalLabel"},"Add User"),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),C={class:"modal-body"},x={key:0,class:"row"},T={class:"col-md-4"},O=(0,o._)("strong",null,"Search Users",-1),P={class:"text-instructions"},$={class:"col-md-8"},B=(0,o._)("label",null,"Search User",-1),G={key:1},H={key:2,class:"row"},W=(0,o._)("div",{class:"col-md-4"},[(0,o._)("strong",null,"Search Groups"),(0,o._)("p",{class:"text-instructions"}," Please use the select to find the group you would like to add to this user to. ")],-1),Z={class:"col-md-8"},F=(0,o._)("label",null,"Search Groups",-1),N={key:3},j={key:4,class:"row"},K=(0,o._)("div",{class:"col-md-4"},[(0,o._)("strong",null,"Search Permission Sets"),(0,o._)("p",{class:"text-instructions"}," Please use the select to find the permission set you would like to add to this user. ")],-1),Y={class:"col-md-8"},V=(0,o._)("label",null,"Search Permission Sets",-1),z={class:"modal-footer"},J=(0,o._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);var Q=t(9669),X=t.n(Q),ee=t(9860),se=t(4250);const te={name:"AdminAddUser",components:{NSelect:ee.Z},props:{destination:{type:String,default:""},locationId:{type:Number,default:0}},data:()=>({groupModel:[],groupResults:[],permissionSetModel:[],permissionSetResults:[],userModel:[],userResults:[]}),computed:{...(0,se.Se)({rootUrl:"getRootUrl",userLevel:"getUserLevel"})},mixins:[q.Z],methods:{addUser:function(){const e=new FormData;e.set("username",this.userModel),this.groupModel.forEach((s=>{e.append("group",s)})),this.permissionSetModel.forEach((s=>{e.append("permission_set",s)})),X().post(`${this.rootUrl}admin_add_user/`,e).then((e=>{window.location.reload(!0)})).catch((e=>{this.showErrorModal(e,"Admin Add user","")}))},getData:function(){X().post(`${this.rootUrl}object_data/admin_add_user/`).then((e=>{switch(this.groupResults=e.data.group_results.map((e=>({label:e.group_name,value:e.group_id}))),this.permissionSetResults=e.data.permission_set_results.map((e=>({label:e.permission_set_name,value:e.permission_set_id}))),this.userResults=e.data.user_results.map((e=>({label:`${e.id}: ${e.first_name} ${e.last_name}`,value:e.id}))),this.destination){case"group":this.groupModel=[this.locationId];break;case"permission_set":this.permissionSetModel=[this.locationId];break;case"user":this.userModel=this.locationId}})).catch((e=>{this.showErrorModal(e,"Admin Add User","")}))}},mounted(){this.getData()}};var oe=t(3744);const ie=(0,oe.Z)(te,[["render",function(e,s,t,a,n,r){const l=(0,o.up)("n-select");return(0,o.wg)(),(0,o.iD)("div",E,[(0,o._)("div",R,[(0,o._)("div",A,[I,(0,o._)("div",C,[(0,o.kq)(" Search Users "),"user"!==t.destination?((0,o.wg)(),(0,o.iD)("div",x,[(0,o._)("div",T,[O,(0,o._)("p",P," Please use the select to find the user you would like to add to this "+(0,i.toDisplayString)(t.destination),1)]),(0,o._)("div",$,[B,(0,o.Wm)(l,{options:n.userResults,value:n.userModel,"onUpdate:value":s[0]||(s[0]=e=>n.userModel=e),class:"form-control"},null,8,["options","value"])])])):(0,o.kq)("v-if",!0),"user"!==t.destination?((0,o.wg)(),(0,o.iD)("hr",G)):(0,o.kq)("v-if",!0),(0,o.kq)(" Search Groups "),"group"!==t.destination?((0,o.wg)(),(0,o.iD)("div",H,[W,(0,o._)("div",Z,[F,(0,o.Wm)(l,{options:n.groupResults,value:n.groupModel,"onUpdate:value":s[1]||(s[1]=e=>n.groupModel=e),class:"form-control",multiple:""},null,8,["options","value"])])])):(0,o.kq)("v-if",!0),"group"!==t.destination?((0,o.wg)(),(0,o.iD)("hr",N)):(0,o.kq)("v-if",!0),(0,o.kq)(" Search Permission Sets "),"permission_set"!==t.destination?((0,o.wg)(),(0,o.iD)("div",j,[K,(0,o._)("div",Y,[V,(0,o.Wm)(l,{options:n.permissionSetResults,value:n.permissionSetModel,"onUpdate:value":s[2]||(s[2]=e=>n.permissionSetModel=e),class:"form-control",multiple:""},null,8,["options","value"])])])):(0,o.kq)("v-if",!0)]),(0,o._)("div",z,[J,(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:s[3]||(s[3]=(...e)=>r.addUser&&r.addUser(...e))},"Add User")])])])])}]]),ae=t(9669),ne={name:"UserList",components:{AdminAddUser:ie},props:{destination:{type:String,default:""},locationId:{type:Number,default:0},userListResults:{type:Array,default:function(){return[]}}},data:()=>({uniqueListOfUsers:[]}),methods:{addUser:function(){new D.u_(document.getElementById("addUserModal")).show()},getList:function(e,s){const t=this.userListResults.filter((s=>s.username==e));return[...new Set(t.map((e=>e[s])))]},getUniqueListOfUsers:function(){const e=this.userListResults.map((e=>({username:e.username,first_name:e.username__first_name,last_name:e.username__last_name,email:e.email})));var s=[];e.forEach((e=>{0===s.filter((s=>s.username===e.username)).length&&s.push(e)})),this.uniqueListOfUsers=s},isTeamLeader:function(e){return this.userListResults.filter((s=>s.username===e&&s.group_leader)).length>0},updateGroupLeader:function(e,s){const t=s.target.checked,o=new FormData;if(o.set("group_leader",t),o.set("username",e),"group"===this.destination){let s=this.getList(e,"group");o.set("group",s[0])}else if("permission_set"===this.destination){let s=this.getList(e,"permission_set");o.set("permission_set",s[0])}ae.post(`/update_group_leader_status/${this.destination}/`,o)}},mounted(){this.getUniqueListOfUsers()}},re=(0,oe.Z)(ne,[["render",function(e,s,t,D,q,E){const R=(0,o.up)("admin-add-user");return(0,o.wg)(),(0,o.iD)("div",a,[(0,o._)("div",n,[r,l,(0,o._)("div",d,[(0,o._)("div",u,[c,(0,o._)("p",m," The following are a list of users associated to "+(0,i.toDisplayString)(t.destination)+'. To add a new user please click on the "Add User" at the bottom of the page. ',1)]),(0,o._)("div",p,[(0,o._)("table",h,[(0,o._)("thead",null,[(0,o._)("tr",null,["user"!==t.destination?((0,o.wg)(),(0,o.iD)("td",_,"User")):(0,o.kq)("v-if",!0),"group"!==t.destination?((0,o.wg)(),(0,o.iD)("td",g,"Group List")):(0,o.kq)("v-if",!0),"permission_set"!==t.destination?((0,o.wg)(),(0,o.iD)("td",f,"Permission List")):(0,o.kq)("v-if",!0),v])]),(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(q.uniqueListOfUsers,(e=>((0,o.wg)(),(0,o.iD)("tr",{key:e.username},["user"!==t.destination?((0,o.wg)(),(0,o.iD)("td",y,(0,i.toDisplayString)(e.first_name)+" "+(0,i.toDisplayString)(e.last_name),1)):(0,o.kq)("v-if",!0),"group"!==t.destination?((0,o.wg)(),(0,o.iD)("td",b,(0,i.toDisplayString)(E.getList(e.username,"group__group_name")),1)):(0,o.kq)("v-if",!0),"permission_set"!==t.destination?((0,o.wg)(),(0,o.iD)("td",k,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(E.getList(e.username,"permission_set__permission_set_name"),((e,s)=>((0,o.wg)(),(0,o.iD)("span",{key:e},(0,i.toDisplayString)(0===s?"":", ")+(0,i.toDisplayString)(e),1)))),128))])):(0,o.kq)("v-if",!0),(0,o._)("td",w,[(0,o._)("input",{class:"form-check-input",type:"checkbox",checked:E.isTeamLeader(e.username),onChange:s=>E.updateGroupLeader(e.username,s),id:"flexCheckDefault"},null,40,U)])])))),128))])])])]),S,(0,o._)("div",M,[(0,o._)("div",L,[(0,o._)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:s[0]||(s[0]=(...e)=>E.addUser&&E.addUser(...e))},"Add User")])])]),(0,o.kq)(" MODALS "),(0,o.Wm)(R,{destination:t.destination,"location-id":t.locationId},null,8,["destination","location-id"])])}]])},3058:(e,s,t)=>{t.d(s,{Z:()=>i});var o=t(9909);const i={methods:{showErrorModal:function(e,s,t){new o.u_(document.getElementById("loadingModal")).hide(),document.getElementById("errorModalContent").innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new requirement<hr>${e}`,new o.u_(document.getElementById("errorModal")).show()},showValidationErrorModal:function(){document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",new o.u_(document.getElementById("errorModal")).show()}}}}}]);